{"title":"TienChin 渠道管理-添加渠道","date":"2023-09-02T03:41:21.000Z","date_formatted":{"ll":"Sep 2, 2023","L":"09/02/2023","MM-DD":"09-02"},"link":"2023/09/02/项目/TienChin 健身系统/2023-6-11/18-TienChin 渠道管理-添加渠道","tags":["项目"],"updated":"2023-09-17T05:28:20.231Z","content":"<p>在我们平时新建一个全新的 Java 类，这个类需要存放的包不存在，可以使用如下的方式进行创建：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202309/2105804-20230902115356187-407073986.png\" alt=\"img\" loading=\"lazy\" class=\"φbp\"></p>\n<p>含义就是说，将 ChannelVO 这个类放在 vo 这个包当中，如果存在则不创建，存在就将新建的类放入其中。</p>\n<h1 id=\"channelvo\">ChannelVO<a title=\"#channelvo\" href=\"#channelvo\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span> 渠道管理，前端展示对象</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023-11-02</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ChannelVO</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">BaseEntity</span> &#123;<br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 渠道名称</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@NotBlank(message = &quot;&#123;channel.name.notnull&#125;&quot;)</span><br>    <span class=\"hljs-keyword\">private</span> String channelName;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 渠道状态</span><br><span class=\"hljs-comment\">     * 0 正常 1 停用</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@Max(value = 1, message = &quot;&#123;channel.status.invalid&#125;&quot;)</span><br>    <span class=\"hljs-meta\">@Min(value = 0, message = &quot;&#123;channel.status.invalid&#125;&quot;)</span><br>    <span class=\"hljs-meta\">@NotNull(message = &quot;&#123;channel.status.notnull&#125;&quot;)</span><br>    <span class=\"hljs-keyword\">private</span> Byte status;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 备注信息</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">private</span> String remark;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 渠道类型：1 线上渠道 2 线下渠道</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@Max(value = 2, message = &quot;&#123;channel.type.invalid&#125;&quot;)</span><br>    <span class=\"hljs-meta\">@Min(value = 1, message = &quot;&#123;channel.type.invalid&#125;&quot;)</span><br>    <span class=\"hljs-meta\">@NotNull(message = &quot;&#123;channel.type.notnull&#125;&quot;)</span><br>    <span class=\"hljs-keyword\">private</span> Integer type;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 删除标志（0代表存在 2代表删除）</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">private</span> String delFlag;<br><br>    <span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getChannelName</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> channelName;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setChannelName</span><span class=\"hljs-params\">(String channelName)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.channelName = channelName;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> Byte <span class=\"hljs-title function_\">getStatus</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> status;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setStatus</span><span class=\"hljs-params\">(Byte status)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.status = status;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getRemark</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> remark;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setRemark</span><span class=\"hljs-params\">(String remark)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.remark = remark;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> Integer <span class=\"hljs-title function_\">getType</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> type;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setType</span><span class=\"hljs-params\">(Integer type)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.type = type;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getDelFlag</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> delFlag;<br>    &#125;<br><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setDelFlag</span><span class=\"hljs-params\">(String delFlag)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.delFlag = delFlag;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<h1 id=\"channelcontroller\">ChannelController<a title=\"#channelcontroller\" href=\"#channelcontroller\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 新增渠道</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@PreAuthorize(&quot;hasPermission(&#x27;tienchin:channel:create&#x27;)&quot;)</span><br><span class=\"hljs-meta\">@Log(title = &quot;渠道管理&quot;, businessType = BusinessType.INSERT)</span><br><span class=\"hljs-meta\">@PostMapping</span><br><span class=\"hljs-keyword\">public</span> AjaxResult <span class=\"hljs-title function_\">add</span><span class=\"hljs-params\">(<span class=\"hljs-meta\">@Validated</span> <span class=\"hljs-meta\">@RequestBody</span> ChannelVO channelVO)</span> &#123;<br>    <span class=\"hljs-keyword\">return</span> AjaxResult.success(iChannelService.addChannel(channelVO) &gt; <span class=\"hljs-number\">0</span> ? <span class=\"hljs-string\">&quot;添加成功&quot;</span> : <span class=\"hljs-string\">&quot;添加失败&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>\n<h1 id=\"ichannelservice\">IChannelService<a title=\"#ichannelservice\" href=\"#ichannelservice\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 添加渠道</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> channelVO 渠道信息</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@return</span> int &#123;<span class=\"hljs-doctag\">@code</span> 0&#125; 失败 &#123;<span class=\"hljs-doctag\">@code</span> 1&#125; 成功</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023/09/02 12:11:42</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">addChannel</span><span class=\"hljs-params\">(ChannelVO channelVO)</span>;<br></code></pre></td></tr></table></figure>\n<h1 id=\"channelserviceimpl\">ChannelServiceImpl<a title=\"#channelserviceimpl\" href=\"#channelserviceimpl\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Override</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">addChannel</span><span class=\"hljs-params\">(ChannelVO channelVO)</span> &#123;<br>    <span class=\"hljs-comment\">// 渠道名称不能重复</span><br>    QueryWrapper&lt;Channel&gt; channelQueryWrapper = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">QueryWrapper</span>&lt;&gt;();<br>    channelQueryWrapper.lambda()<br>            .eq(Channel::getChannelName, channelVO.getChannelName())<br>            .eq(Channel::getDelFlag, <span class=\"hljs-string\">&quot;0&quot;</span>);<br>    <span class=\"hljs-type\">Channel</span> <span class=\"hljs-variable\">channelByDb</span> <span class=\"hljs-operator\">=</span> getOne(channelQueryWrapper);<br>    <span class=\"hljs-keyword\">if</span> (channelByDb != <span class=\"hljs-literal\">null</span>) &#123;<br>        <span class=\"hljs-comment\">// 说明渠道名称已经存在</span><br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;<br>    &#125;<br><br>    <span class=\"hljs-comment\">// 保存渠道信息</span><br>    <span class=\"hljs-type\">Channel</span> <span class=\"hljs-variable\">channel</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Channel</span>();<br>    BeanUtils.copyProperties(channelVO, channel);<br><br>    <span class=\"hljs-comment\">// 设置其它默认值</span><br>    channel.setCreateBy(SecurityUtils.getUsername());<br>    channel.setCreateTime(LocalDateTime.now());<br>    <span class=\"hljs-keyword\">return</span> save(channel) ? <span class=\"hljs-number\">1</span> : <span class=\"hljs-number\">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>","prev":{"title":"TienChin 渠道管理-配置校验失败信息","link":"2023/09/03/项目/TienChin 健身系统/2023-6-11/19-TienChin 渠道管理-配置校验失败信息"},"next":{"title":"TienChin 渠道管理-权限分配","link":"2023/09/02/项目/TienChin 健身系统/2023-6-11/17-TienChin 渠道管理-权限分配"},"plink":"http://example.com/2023/09/02/项目/TienChin 健身系统/2023-6-11/18-TienChin 渠道管理-添加渠道/","toc":[{"id":"channelvo","title":"ChannelVO","index":"1"},{"id":"channelcontroller","title":"ChannelController","index":"2"},{"id":"ichannelservice","title":"IChannelService","index":"3"},{"id":"channelserviceimpl","title":"ChannelServiceImpl","index":"4"}],"reading_time":"568 words in 4 min"}