{"title":"微信小程序-页面访问组件数据和方法","date":"2023-05-14T09:12:18.000Z","date_formatted":{"ll":"May 14, 2023","L":"05/14/2023","MM-DD":"05-14"},"link":"2023/05/14/Web/微信小程序/component/自定义组件/组件通讯/44-微信小程序-页面访问组件数据和方法","tags":["微信小程序"],"updated":"2023-05-14T13:53:23.340Z","content":"<p>首先，创建演示案例的组件，c-demo，在给我们的组件添加一个按钮，并且给这个按钮绑定一个点击事件：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;!-- <br>  c-demo2.wxml<br> --&gt;<br>&lt;button<br>bindtap=&quot;onCDemoTap&quot;<br>type=&quot;primary&quot;<br>&gt;<br>我是c-demo按钮<br>&lt;/button&gt;<br></code></pre></td></tr></table></figure>\n<p>JS:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-comment\">// components/c-demo2/c-demo2.js</span><br><span class=\"hljs-title class_\">Component</span>(&#123;<br>  <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">   * 组件的初始数据</span><br><span class=\"hljs-comment\">   */</span><br>  <span class=\"hljs-attr\">data</span>: &#123;<br>    <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">&#x27;BNTang&#x27;</span><br>  &#125;,<br>  <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">   * 组件的方法列表</span><br><span class=\"hljs-comment\">   */</span><br>  <span class=\"hljs-attr\">methods</span>: &#123;<br>    <span class=\"hljs-title function_\">onCDemoTap</span>(<span class=\"hljs-params\">e</span>) &#123;<br>      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(e);<br>    &#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>\n<p>改造首页：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;!-- <br>  index.wxml<br> --&gt;<br>&lt;myDemo2/&gt;<br>&lt;button bindtap=&quot;onIndexTap&quot;&gt;我是首页的按钮&lt;/button&gt;<br></code></pre></td></tr></table></figure>\n<p>首页 JS 文件：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onIndexTap</span>(<span class=\"hljs-params\">e</span>) &#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(e);<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>\n<h1 id=\"获取组件实例\">获取组件实例<a title=\"#获取组件实例\" href=\"#获取组件实例\"></a></h1>\n<p>好了，结构搭建的差不多了，接下来就是来看关键的内容了，首先我们来看一下如何拿到一个自定义组件的实例，有两种方式，这两种方式的前提条件是，给这个组件设置一个标识，设置标识的方式可以是通过类名或者ID进行设置，然后通过这个标识得到组件实例。</p>\n<p>?&gt; 通过类名：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;!-- <br>  index.wxml<br> --&gt;<br>&lt;myDemo2 class=&quot;my-demo&quot;/&gt;<br>&lt;button bindtap=&quot;onIndexTap&quot;&gt;我是首页的按钮&lt;/button&gt;<br></code></pre></td></tr></table></figure>\n<p>首页 JS 文件：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onIndexTap</span>(<span class=\"hljs-params\">e</span>) &#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">selectComponent</span>(<span class=\"hljs-string\">&quot;.my-demo&quot;</span>));<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>\n<p>?&gt; 通过ID</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;!-- <br>  index.wxml<br> --&gt;<br>&lt;myDemo2 id=&quot;my-demo&quot;/&gt;<br>&lt;button bindtap=&quot;onIndexTap&quot;&gt;我是首页的按钮&lt;/button&gt;<br></code></pre></td></tr></table></figure>\n<p>首页 JS 文件：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onIndexTap</span>(<span class=\"hljs-params\">e</span>) &#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">selectComponent</span>(<span class=\"hljs-string\">&quot;#my-demo&quot;</span>));<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>\n<h1 id=\"访问自定义组件的方法与数据\">访问自定义组件的方法与数据<a title=\"#访问自定义组件的方法与数据\" href=\"#访问自定义组件的方法与数据\"></a></h1>\n<p>上面已经介绍过了如何获取组件的实例，这样子就可以通过该实例对象调用实例当中所对应的内容和获取对应的内容。</p>\n<h2 id=\"调用方法\">调用方法<a title=\"#调用方法\" href=\"#调用方法\"></a></h2>\n<p>c-demo 的 JS 文件，新增一个函数方法供外界调用测试使用：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-comment\">// components/c-demo2/c-demo2.js</span><br><span class=\"hljs-title class_\">Component</span>(&#123;<br>  <span class=\"hljs-attr\">methods</span>: &#123;<br>    <span class=\"hljs-title function_\">myDemoTwoFn</span>(<span class=\"hljs-params\"></span>) &#123;<br>      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;call myDemoTwoFn&quot;</span>);<br>    &#125;<br>  &#125;<br>&#125;)<br><br></code></pre></td></tr></table></figure>\n<p>首页的 JS 文件：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onIndexTap</span>(<span class=\"hljs-params\">e</span>) &#123;<br>    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">selectComponent</span>(<span class=\"hljs-string\">&quot;#my-demo&quot;</span>).<span class=\"hljs-title function_\">myDemoTwoFn</span>();<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>\n<h2 id=\"获取数据\">获取数据<a title=\"#获取数据\" href=\"#获取数据\"></a></h2>\n<p>首页的 JS 文件：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onIndexTap</span>(<span class=\"hljs-params\">e</span>) &#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">selectComponent</span>(<span class=\"hljs-string\">&quot;#my-demo&quot;</span>).<span class=\"hljs-property\">data</span>);<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>\n<h1 id=\"总结\">总结<a title=\"#总结\" href=\"#总结\"></a></h1>\n<ul>\n<li>想在页面中调用组件中的方法，我们可以给组件添加一个类名或者ID</li>\n<li>然后通过 this.selectComponent(“选择器”) 拿到组件实例对象</li>\n<li>然后再通过组件的实例对象调用组件的方法或者访问组件的数据即可</li>\n</ul>\n","prev":{"title":"微信小程序-组件通讯练习","link":"2023/05/14/Web/微信小程序/component/自定义组件/组件通讯/45-微信小程序-组件通讯练习"},"next":{"title":"微信小程序-传递数据子传父","link":"2023/05/14/Web/微信小程序/component/自定义组件/组件通讯/43-微信小程序-传递数据子传父"},"plink":"http://example.com/2023/05/14/Web/微信小程序/component/自定义组件/组件通讯/44-微信小程序-页面访问组件数据和方法/","toc":[{"id":"获取组件实例","title":"获取组件实例","index":"1"},{"id":"访问自定义组件的方法与数据","title":"访问自定义组件的方法与数据","index":"2","children":[{"id":"调用方法","title":"调用方法","index":"2.1"},{"id":"获取数据","title":"获取数据","index":"2.2"}]},{"id":"总结","title":"总结","index":"3"}],"reading_time":"589 words in 4 min"}