{"title":"微信小程序-scrollview","date":"2023-05-07T09:14:38.000Z","date_formatted":{"ll":"May 7, 2023","L":"05/07/2023","MM-DD":"05-07"},"link":"2023/05/07/Web/微信小程序/component/常用组件/38-微信小程序-scrollview","tags":["微信小程序"],"updated":"2023-05-13T03:13:46.457Z","content":"<p>官方文档地址：<a href=\"https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html\" target=\"_blank\">https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html</a></p>\n<h1 id=\"scroll-view\">scroll-view<a title=\"#scroll-view\" href=\"#scroll-view\"></a></h1>\n<p>可滚动视图区域。使用竖向滚动时，需要给scroll-view一个固定高度，通过 WXSS 设置 height。组件属性的长度单位默认为px，2.4.0起支持传入单位(rpx/px)。</p>\n<p>我们首先来简单搭建一个布局利用 scroll-view，index.wxml 代码如下:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;scroll-view class=&quot;container&quot;&gt;<br>    &lt;block wx:for=&quot;&#123;&#123;colors&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt;<br>        &lt;view class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/view&gt;<br>    &lt;/block&gt;<br>&lt;/scroll-view&gt;<br></code></pre></td></tr></table></figure>\n<p>对应的样式代码如下 index.wxss:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxss\">.item&#123;<br>    height: 100px;<br>    text-align: center;<br>&#125;<br>.container&#123;<br>    background: black;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>!&gt; 默认情况下 scroll-view 是无法滚动的，如果想让 scroll-view 进行滚动，那么必须告诉 scroll-view 在哪个方向上进行滚动，并且还需要设置这个方向的尺寸才可以进行滚动。</p>\n<p>例如我这里想让 scroll-view 进行 y 轴滚动，给 scroll-view 设置一个属性叫做 <code>scroll-y</code>: 告诉 scroll-view 可以在垂直方向滚动。</p>\n<p>听了我这么一番话之后去index.wxml设置一下scroll-y：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;scroll-view class=&quot;container&quot; scroll-y&gt;<br>       &lt;block wx:for=&quot;&#123;&#123;colors&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt;<br>              &lt;view class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/view&gt;<br>       &lt;/block&gt;<br>&lt;/scroll-view&gt;<br></code></pre></td></tr></table></figure>\n<p>设置了之后发现还是不能进行滚动，上面的注意点我已经说了，还需要设置一个对应方向的尺寸才可以，又去wxss设置了下scroll-view的高度，我再次调试可以进行滚动了。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxss\">.container&#123;<br>  background: black;<br>  height: 300px;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>上面介绍的是 y 轴方向，在来看看 x，x 当中有一些注意点，所以我这里就才特意拿出来进行说明。</p>\n<p>想进行 x 滚动，也是一样的，告诉scroll-view一个属性, 为 <code>scroll-x</code> 让scroll-view可以在水平方向上滚动。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;scroll-view class=&quot;container&quot; scroll-x&gt;<br>       &lt;block wx:for=&quot;&#123;&#123;colors&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt;<br>              &lt;view class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/view&gt;<br>       &lt;/block&gt;<br>&lt;/scroll-view&gt;<br></code></pre></td></tr></table></figure>\n<p>然后我发现，我的元素排版有问题，我这里想用 display: flex 进行布局，发现微信开发者工具的控制台给出了警告，警告是内容是 <code>[pages/index/index] 设置 enable-flex 属性以使 flexbox 布局生效。</code> 说明一个问题，我们想使用 flex 布局就需要告诉 scroll-view 开启这个 flex 布局，我们就再加一下吧~。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;scroll-view class=&quot;container&quot; enable-flex scroll-x&gt;<br>       &lt;block wx:for=&quot;&#123;&#123;colors&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt;<br>              &lt;view class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;item&lt;/view&gt;<br>       &lt;/block&gt;<br>&lt;/scroll-view&gt;<br></code></pre></td></tr></table></figure>\n<p>样式文件代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxss\">.item&#123;<br>  height: 100px;<br>  width: 100px;<br>  flex-shrink: 0;<br>&#125;<br>.container&#123;<br>  height: 200px;<br>  background: #333;<br>  display: flex;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>这样子就可以进行 x 滚动了，我这里补充一条注意点，防止有的人粗心大意。</p>\n<p>!&gt; 默认情况下，是无法将scroll-view变成flex布局的，如果想将scroll-view变成flex布局，那么必须通过enable-flex属性</p>\n<p>如上的内容其实在官方文档当中都有写出来，我这里就是带大家上手看看，在来看几个属性这篇文章就可以结束了，后续的一些内容，等我做项目我在出。</p>\n<h2 id=\"scroll-into-view\">scroll-into-view<a title=\"#scroll-into-view\" href=\"#scroll-into-view\"></a></h2>\n<p>值应为某子元素id（<strong>id不能以数字开头</strong>）。设置哪个方向可滚动，则在哪个方向滚动到该元素，就是说，在初始化的时候我们可以直接让scroll-view默认选中某一个指定id的元素，相当于自动为我们滚动到指定的元素进行展示。</p>\n<p>首先需要给每一个元素绑定一个id：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxss\">&lt;view id=&quot;to&#123;&#123;index&#125;&#125;&quot; class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;item&lt;/view&gt;<br></code></pre></td></tr></table></figure>\n<p>我这里为了更好的显示这个效果我将 .item 的样式进行了调整，宽度设置为了 375 这样子就每一个元素的展示就是一整个屏幕。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxss\">.item&#123;<br>  height: 100px;<br>  width: 375px;<br>  flex-shrink: 0;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>给scroll-view设置scroll-into-view=“to2”。</p>\n<h2 id=\"bindscroll\">bindscroll<a title=\"#bindscroll\" href=\"#bindscroll\"></a></h2>\n<p>滚动时触发，event.detail = {scrollLeft, scrollTop, scrollHeight, scrollWidth, deltaX, deltaY}</p>\n<p>简单的绑定和打印一下事件对象：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;scroll-view <br>class=&quot;container&quot;<br>enable-flex <br>scroll-x<br>bindscroll=&quot;onScroll&quot;<br>&gt;<br>       &lt;block wx:for=&quot;&#123;&#123;colors&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt;<br>              &lt;view class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;item&lt;/view&gt;<br>       &lt;/block&gt;<br>&lt;/scroll-view&gt;<br></code></pre></td></tr></table></figure>\n<p>index.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onScroll</span>(<span class=\"hljs-params\">e</span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(e);<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202305/2105804-20230513105937811-1875776117.png\" alt=\"image-20230513105937094\" loading=\"lazy\" class=\"φbp\"></p>\n<p>在监听方法的事件对象中：</p>\n<ul>\n<li>deltaX 表示滚动的方向：如果是负值，表示往左边滚动，如果是正值，表示往右边滚动</li>\n<li>deltaY 表示滚动方向，具体正值和负值是上还是下，自己下去实验</li>\n<li>scrollHeight/scrollWidth：表示整个scroll-view的高度和宽度</li>\n<li>scrollLeft：左边滚出去了多少</li>\n<li>scrollTop：同理可证</li>\n</ul>\n<h2 id=\"bindscrolltoupper\">bindscrolltoupper<a title=\"#bindscrolltoupper\" href=\"#bindscrolltoupper\"></a></h2>\n<p>滚动到顶部/左边时触发</p>\n<h2 id=\"bindscrolltolower\">bindscrolltolower<a title=\"#bindscrolltolower\" href=\"#bindscrolltolower\"></a></h2>\n<p>滚动到底部/右边时触发</p>\n<p>index.wxml:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;scroll-view <br>class=&quot;container&quot;<br>enable-flex <br>scroll-x<br>bindscrolltoupper=&quot;onScrollToupper&quot;<br>bindscrolltolower=&quot;onScrollLower&quot;<br>&gt;<br>       &lt;block wx:for=&quot;&#123;&#123;colors&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt;<br>              &lt;view class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;item&lt;/view&gt;<br>       &lt;/block&gt;<br>&lt;/scroll-view&gt;<br></code></pre></td></tr></table></figure>\n<p>index.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onScrollToupper</span>(<span class=\"hljs-params\"></span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;滚动到最上面或者最左边了&quot;</span>);<br>  &#125;,<br>  <span class=\"hljs-title function_\">onScrollLower</span>(<span class=\"hljs-params\">e</span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;滚动到最下面或者最右边了&quot;</span>);<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>\n<p>其实这两个属性也并不是滚动到最左边或者最右边才被触发事件的，是与左右两边有一段距离的，这个距离是可以进行设置的。通过 <code>upper-threshold</code>/<code>lower-threshold</code> 进行设置，这两个属性有函数节流，我这里其实觉得吧，可以直接使用官方设置好的距离即可。</p>\n<h2 id=\"upper-threshold\">upper-threshold<a title=\"#upper-threshold\" href=\"#upper-threshold\"></a></h2>\n<p>距顶部/左边多远时，触发 scrolltoupper 事件</p>\n<h2 id=\"lower-threshold\">lower-threshold<a title=\"#lower-threshold\" href=\"#lower-threshold\"></a></h2>\n<p>距底部/右边多远时，触发 scrolltolower 事件</p>\n<p>index.wxml:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;scroll-view <br>class=&quot;container&quot;<br>enable-flex <br>scroll-x<br>upper-threshold=&quot;&#123;&#123;0&#125;&#125;&quot;<br>lower-threshold=&quot;&#123;&#123;0&#125;&#125;&quot;<br>bindscrolltoupper=&quot;onScrollToupper&quot;<br>bindscrolltolower=&quot;onScrollLower&quot;<br>&gt;<br>       &lt;block wx:for=&quot;&#123;&#123;colors&#125;&#125;&quot; wx:key=&quot;*this&quot;&gt;<br>              &lt;view class=&quot;item&quot; style=&quot;background: &#123;&#123;item&#125;&#125;&quot;&gt;item&lt;/view&gt;<br>       &lt;/block&gt;<br>&lt;/scroll-view&gt;<br></code></pre></td></tr></table></figure>\n<p>这么一设置就代表就与左右两边的距离不存在偏移了。但是有节流问题，效果也并不是很好，所以说还是得要按照以后企业开发当中的需求而定。</p>\n","prev":{"title":"微信小程序-自定义组件","link":"2023/05/13/Web/微信小程序/component/自定义组件/39-微信小程序-自定义组件"},"next":{"title":"微信小程序-image组件-选择相册资源案例","link":"2023/04/24/Web/微信小程序/component/常用组件/案例/37-微信小程序-image组件-选择相册资源案例"},"plink":"http://example.com/2023/05/07/Web/微信小程序/component/常用组件/38-微信小程序-scrollview/","toc":[{"id":"scroll-view","title":"scroll-view","index":"1","children":[{"id":"scroll-into-view","title":"scroll-into-view","index":"1.1"},{"id":"bindscroll","title":"bindscroll","index":"1.2"},{"id":"bindscrolltoupper","title":"bindscrolltoupper","index":"1.3"},{"id":"bindscrolltolower","title":"bindscrolltolower","index":"1.4"},{"id":"upper-threshold","title":"upper-threshold","index":"1.5"},{"id":"lower-threshold","title":"lower-threshold","index":"1.6"}]}],"reading_time":"1503 words in 10 min"}