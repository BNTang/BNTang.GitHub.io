{"title":"uni-app-CompositionAPI应用生命周期和页面生命周期","date":"2023-12-09T18:27:31.000Z","date_formatted":{"ll":"Dec 10, 2023","L":"12/10/2023","MM-DD":"12-10"},"link":"2023/12/10/Uniapp/11-uni-app-CompositionAPI应用生命周期和页面生命周期","tags":["Uniapp"],"updated":"2023-12-09T19:26:22.908Z","content":"<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231203181448561-790643952.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h1>\n<ul>\n<li>好，经过上个章节的介绍完毕之后，了解了一下 uni-app-OptionAPI应用生命周期和页面生命周期</li>\n<li>那么了解完了uni-app-OptionAPI应用生命周期和页面生命周期之后，这篇文章来给大家介绍一下 uni-app-CompositionAPI应用生命周期和页面生命周期</li>\n<li>CompositionAPI 是 Vue3.0 中的一个新特性，uni-app 也支持 CompositionAPI，所以我们就来看一下 uni-app-CompositionAPI应用生命周期和页面生命周期的写法</li>\n<li>首先不管三七二十一，先来新建一个项目</li>\n</ul>\n<h1 id=\"搭建演示环境\">搭建演示环境<a title=\"#搭建演示环境\" href=\"#搭建演示环境\"></a></h1>\n<p>创建一个全新的项目：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231210023145059-459799400.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n<p>然后在配置一下，微信小程序的 AppId，直接去之前的项目中拷贝一下即可，找到之前项目的 <code>manifest.json</code> 文件，然后选择微信小程序配置，复制一下即可。</p>\n<ul>\n<li>经过如上的这么一顿操作之后，就可以搭建完毕运行环境，与编码环境</li>\n<li>接下来就可以开始进行介绍 uni-app-CompositionAPI应用生命周期和页面生命周期内容了</li>\n</ul>\n<h1 id=\"步入正题\">步入正题<a title=\"#步入正题\" href=\"#步入正题\"></a></h1>\n<h2 id=\"应用生命周期\">应用生命周期<a title=\"#应用生命周期\" href=\"#应用生命周期\"></a></h2>\n<p>如果想使用 CompositionAPI 的话，需要在 script 标签中添加 <code>setup</code>, 添加了 setup 之后就不是导出一个默认对象了，而是导出一个函数，将原来 App.vue 中的内容全部转换为函数定义，代码如下所示：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;script setup&gt;<br>\tonLaunch(() =&gt; &#123;<br>\t\tconsole.log(&#x27;App Launch&#x27;)<br>\t&#125;)<br>\tonShow(() =&gt; &#123;<br>\t\tconsole.log(&#x27;App onShow&#x27;)<br>\t&#125;)<br>\tonHide(() =&gt; &#123;<br>\t\tconsole.log(&#x27;App onHide&#x27;)<br>\t&#125;)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>\n<p>改造完毕之后，我们就可以运行一下，看一下效果了，运行之后，可以看到控制台中报错了（我这里声明一下后面的启动都以微信小程序启动），如下图所示：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231210025424155-2014923430.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n<p>报错信息是 <code>ReferenceError: onLaunch is not defined</code>, 也就是说 onLaunch 这个函数没有定义，因为我们使用的是 CompositionAPI，那么我们就需要在 <code>setup</code> 函数中导入 onLaunch 函数，onLaunch 从哪里导入呢？从 <code>@dcloudio/uni-app</code> 中导入，当然如果说 onLaunch 需要导入那么其他的生命周期函数也需要导入，所以我们直接将所有的生命周期函数都导入进来，代码如下所示：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;script setup&gt;<br>\timport &#123;onLaunch, onShow, onHide&#125; from &#x27;@dcloudio/uni-app&#x27;<br>\t<br>\tonLaunch(() =&gt; &#123;<br>\t\tconsole.log(&#x27;App Launch&#x27;)<br>\t&#125;)<br>\tonShow(() =&gt; &#123;<br>\t\tconsole.log(&#x27;App onShow&#x27;)<br>\t&#125;)<br>\tonHide(() =&gt; &#123;<br>\t\tconsole.log(&#x27;App onHide&#x27;)<br>\t&#125;)<br>&lt;/script&gt;<br><br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>\n<p>然后运行一下，可以看到控制台中打印出来了我们的生命周期函数，如下图所示：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231210030025149-949837052.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n<p>这个就是在 UniApp 中 CompositionAPI 的写法。</p>\n<h2 id=\"页面生命周期\">页面生命周期<a title=\"#页面生命周期\" href=\"#页面生命周期\"></a></h2>\n<p>页面生命周期的写法和应用生命周期的写法是一样的，只不过是在页面中使用，我们快速搭建一下环境吧，配置一下 tabBar：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs json\"><span class=\"hljs-attr\">&quot;tabBar&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">&#123;</span><br>    <span class=\"hljs-attr\">&quot;color&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;#7A7E83&quot;</span><span class=\"hljs-punctuation\">,</span><br>    <span class=\"hljs-attr\">&quot;selectedColor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;#3cc51f&quot;</span><span class=\"hljs-punctuation\">,</span><br>    <span class=\"hljs-attr\">&quot;borderStyle&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;black&quot;</span><span class=\"hljs-punctuation\">,</span><br>    <span class=\"hljs-attr\">&quot;backgroundColor&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;#ffffff&quot;</span><span class=\"hljs-punctuation\">,</span><br>    <span class=\"hljs-attr\">&quot;list&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><span class=\"hljs-punctuation\">&#123;</span><br>        <span class=\"hljs-attr\">&quot;pagePath&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;pages/index/index&quot;</span><span class=\"hljs-punctuation\">,</span><br>        <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;首页&quot;</span><br>    <span class=\"hljs-punctuation\">&#125;</span><span class=\"hljs-punctuation\">,</span> <span class=\"hljs-punctuation\">&#123;</span><br>        <span class=\"hljs-attr\">&quot;pagePath&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;pages/account/account&quot;</span><span class=\"hljs-punctuation\">,</span><br>        <span class=\"hljs-attr\">&quot;text&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;账号&quot;</span><br>    <span class=\"hljs-punctuation\">&#125;</span><span class=\"hljs-punctuation\">]</span><br><span class=\"hljs-punctuation\">&#125;</span><br></code></pre></td></tr></table></figure>\n<p>然后在 pages 目录下新建一个 account 目录，然后在 account 目录下新建一个 account.vue 文件，然后在 account.vue 文件中添加如下代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;template&gt;<br>  &lt;view&gt;<br>    &lt;text&gt;账号&lt;/text&gt;<br>  &lt;/view&gt;<br>&lt;/template&gt;<br><br>&lt;script setup&gt;<br>  import &#123;onLoad, onShow, onReady, onHide, onPullDownRefresh, onReachBottom&#125; from &#x27;@dcloudio/uni-app&#x27;<br><br>  onLoad(() =&gt; &#123;<br>    console.log(&quot;账号 onLoad&quot;);<br>  &#125;)<br>  onShow(() =&gt; &#123;<br>    console.log(&quot;账号 onShow&quot;);<br>  &#125;)<br>  onReady(() =&gt; &#123;<br>    console.log(&quot;账号 onReady&quot;);<br>  &#125;)<br>  onHide(() =&gt; &#123;<br>    console.log(&quot;账号 onHide&quot;);<br>  &#125;)<br>  onPullDownRefresh(() =&gt; &#123;<br>    console.log(&quot;账号 onPullDownRefresh&quot;);<br>  &#125;)<br>  onReachBottom(() =&gt; &#123;<br>    console.log(&quot;账号 onReachBottom&quot;);<br>  &#125;)<br>&lt;/script&gt;<br><br>&lt;style&gt;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>\n<p>index.vue 文件中添加如下代码：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;template&gt;<br>\t&lt;view&gt;<br>\t\t&lt;text&gt;首页&lt;/text&gt;<br>\t\t&lt;view class=&quot;content&quot;&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 1&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 88&lt;/view&gt;<br>\t\t\t&lt;view class=&quot;item&quot;&gt;item 99&lt;/view&gt;<br>\t\t&lt;/view&gt;<br>\t&lt;/view&gt;<br>&lt;/template&gt;<br><br>&lt;script setup&gt;<br>\timport &#123;onLoad, onShow, onReady, onHide, onPullDownRefresh, onReachBottom&#125; from &#x27;@dcloudio/uni-app&#x27;<br>\t<br>\tonLoad(() =&gt; &#123;<br>\t\tconsole.log(&quot;首页 onLoad&quot;);<br>\t&#125;)<br>\tonShow(() =&gt; &#123;<br>\t\tconsole.log(&quot;首页 onShow&quot;);<br>\t&#125;)<br>\tonReady(() =&gt; &#123;<br>\t\tconsole.log(&quot;首页 onReady&quot;);<br>\t&#125;)<br>\tonHide(() =&gt; &#123;<br>\t\tconsole.log(&quot;首页 onHide&quot;);<br>\t&#125;)<br>\tonPullDownRefresh(() =&gt; &#123;<br>\t\tconsole.log(&quot;首页 onPullDownRefresh&quot;);<br>\t&#125;)<br>\tonReachBottom(() =&gt; &#123;<br>\t\tconsole.log(&quot;首页 onReachBottom&quot;);<br>\t&#125;)<br>&lt;/script&gt;<br><br>&lt;style lang=&quot;scss&quot; scoped&gt;<br>\t.item &#123;<br>\t\twidth: 100%;<br>\t\theight: 200rpx;<br>\t&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>\n<p>配置 pages.json 文件中 pages 相关内容：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs json\"><span class=\"hljs-attr\">&quot;pages&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">[</span><br>    <span class=\"hljs-punctuation\">&#123;</span><br>        <span class=\"hljs-attr\">&quot;path&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;pages/index/index&quot;</span><span class=\"hljs-punctuation\">,</span><br>        <span class=\"hljs-attr\">&quot;style&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">&#123;</span><br>            <span class=\"hljs-attr\">&quot;navigationBarTitleText&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;首页&quot;</span><span class=\"hljs-punctuation\">,</span><br>            <span class=\"hljs-attr\">&quot;enablePullDownRefresh&quot;</span> <span class=\"hljs-punctuation\">:</span> <span class=\"hljs-keyword\">true</span><br>        <span class=\"hljs-punctuation\">&#125;</span><br>    <span class=\"hljs-punctuation\">&#125;</span><span class=\"hljs-punctuation\">,</span><br>    <span class=\"hljs-punctuation\">&#123;</span><br>        <span class=\"hljs-attr\">&quot;path&quot;</span> <span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;pages/account/account&quot;</span><span class=\"hljs-punctuation\">,</span><br>        <span class=\"hljs-attr\">&quot;style&quot;</span> <span class=\"hljs-punctuation\">:</span> <br>        <span class=\"hljs-punctuation\">&#123;</span><br>            <span class=\"hljs-attr\">&quot;navigationBarTitleText&quot;</span> <span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;账号&quot;</span><br>        <span class=\"hljs-punctuation\">&#125;</span><br>    <span class=\"hljs-punctuation\">&#125;</span><br><span class=\"hljs-punctuation\">]</span><span class=\"hljs-punctuation\">,</span><br></code></pre></td></tr></table></figure>\n<p>然后运行一下，我这里以一个视频的形式展示给大家，如下图所示：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231210032522710-353308557.gif\" alt loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"总结\">总结<a title=\"#总结\" href=\"#总结\"></a></h1>\n<p>好，经过上面的介绍，我们就了解了 uni-app-CompositionAPI应用生命周期和页面生命周期的写法</p>\n<p>最主要是就是要知道在使用 CompositionAPI 的时候，需要在 script 标签中添加 <code>setup</code>，然后在 <code>setup</code> 函数中导入生命周期函数，然后在生命周期函数中添加我们的代码即可。</p>\n<p>要知道导入生命周期函数的时候，需要从 <code>@dcloudio/uni-app</code> 中导入，然后在 <code>setup</code> 函数中使用即可。</p>\n<h1 id=\"最后\">最后<a title=\"#最后\" href=\"#最后\"></a></h1>\n<p>大家好我是 BNTang, 一个热爱分享的技术的开发者，如果大家觉得我的文章对你有帮助的话，可以关注我的公众号 <code>JavaBoyL</code>，我会在公众号中分享一些IT技术和一些个人的见解，谢谢大家的支持。</p>\n<blockquote>\n<p><a href=\"https://cloud.tencent.com/developer/article/2366050?from_column=20421&amp;from=20421\" target=\"_blank\">我正在参与2023腾讯技术创作特训营第四期有奖征文，快来和我瓜分大奖！</a></p>\n</blockquote>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202311/2105804-20231129232539490-1458223711.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n","prev":{"title":"uni-app-路由","link":"2023/12/10/Uniapp/12-uni-app-路由"},"next":{"title":"uni-app-OptionAPI应用生命周期和页面生命周期","link":"2023/12/10/Uniapp/10-uni-app-OptionAPI应用生命周期和页面生命周期"},"plink":"http://example.com/2023/12/10/Uniapp/11-uni-app-CompositionAPI应用生命周期和页面生命周期/","toc":[{"id":"前言","title":"前言","index":"1"},{"id":"搭建演示环境","title":"搭建演示环境","index":"2"},{"id":"步入正题","title":"步入正题","index":"3","children":[{"id":"应用生命周期","title":"应用生命周期","index":"3.1"},{"id":"页面生命周期","title":"页面生命周期","index":"3.2"}]},{"id":"总结","title":"总结","index":"4"},{"id":"最后","title":"最后","index":"5"}],"reading_time":"1518 words in 10 min"}