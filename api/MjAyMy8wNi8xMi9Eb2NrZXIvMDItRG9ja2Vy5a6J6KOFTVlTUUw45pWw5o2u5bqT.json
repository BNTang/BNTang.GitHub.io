{"title":"Docker 安装 MySQL8 数据库","date":"2023-06-12T11:21:52.000Z","date_formatted":{"ll":"Jun 12, 2023","L":"06/12/2023","MM-DD":"06-12"},"link":"2023/06/12/Docker/02-Docker安装MYSQL8数据库","tags":["Docker"],"updated":"2023-06-16T14:34:37.249Z","content":"<h1 id=\"创建数据卷\">创建数据卷<a title=\"#创建数据卷\" href=\"#创建数据卷\"></a></h1>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">mkdir</span> -p /usr/mysql/conf /usr/mysql/data<br></code></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-built_in\">chmod</span> -R 755 /usr/mysql/<br></code></pre></td></tr></table></figure>\n<h1 id=\"创建配置文件\">创建配置文件<a title=\"#创建配置文件\" href=\"#创建配置文件\"></a></h1>\n<p><code>vim /usr/mysql/conf/my.cnf</code>:</p>\n<figure class=\"highlight text\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs text\">[client]<br><br>#socket = /usr/mysql/mysqld.sock<br><br>default-character-set = utf8mb4<br><br>[mysqld]<br><br>#pid-file        = /var/run/mysqld/mysqld.pid<br><br>#socket          = /var/run/mysqld/mysqld.sock<br><br>#datadir         = /var/lib/mysql<br><br>#socket = /usr/mysql/mysqld.sock<br><br>#pid-file = /usr/mysql/mysqld.pid<br><br>datadir = /usr/mysql/data<br><br>character_set_server = utf8mb4<br><br>collation_server = utf8mb4_bin<br><br>secure-file-priv= NULL<br><br># Disabling symbolic-links is recommended to prevent assorted security risks<br><br>symbolic-links=0<br><br># Custom config should go here<br><br>!includedir /etc/mysql/conf.d/<br></code></pre></td></tr></table></figure>\n<h1 id=\"创建容器\">创建容器<a title=\"#创建容器\" href=\"#创建容器\"></a></h1>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">docker run --name mysql8 --restart=always -v /usr/mysql/conf/my.cnf:/etc/mysql/my.cnf -v /usr/mysql/data:/var/lib/mysql -v /etc/localtime:/etc/localtime:ro -p 3310:3306 -e MYSQL_ROOT_PASSWORD=bntang -d mysql:8<br></code></pre></td></tr></table></figure>\n<h1 id=\"添加用户\">添加用户<a title=\"#添加用户\" href=\"#添加用户\"></a></h1>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">docker <span class=\"hljs-built_in\">exec</span> -it mysql8 /bin/bash<br></code></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># 创建 bntang 用户，密码为 bntang，允许在任意机器上登录</span><br>CREATE USER <span class=\"hljs-string\">&#x27;bntang&#x27;</span>@<span class=\"hljs-string\">&#x27;%&#x27;</span> IDENTIFIED BY <span class=\"hljs-string\">&#x27;bntang&#x27;</span>;<br></code></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\"><span class=\"hljs-comment\"># 赋予 bntang 用户在 所有机器上 对 所有数据库和数据表 拥有 所有操作权限</span><br>GRANT ALL ON *.* TO <span class=\"hljs-string\">&#x27;bntang&#x27;</span>@<span class=\"hljs-string\">&#x27;%&#x27;</span>;<br></code></pre></td></tr></table></figure>\n<h1 id=\"mysql-5.7\">MySQL 5.7<a title=\"#mysql-5.7\" href=\"#mysql-5.7\"></a></h1>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">docker run -itd --name=<span class=\"hljs-string\">&quot;mysql&quot;</span> -p3307:3306 -v /root/mydata/mysql/conf/:/etc/mysql/conf.d -v /root/mydata/mysql/data:/var/lib/mysql -v /root/mydata/mysql/logs:/var/log -e MYSQL_ROOT_PASSWORD=<span class=\"hljs-string\">&quot;1234&quot;</span> mysql:5.7<br></code></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">grant all privileges on *.* to <span class=\"hljs-string\">&#x27;root&#x27;</span>@<span class=\"hljs-string\">&#x27;%&#x27;</span> identified by <span class=\"hljs-string\">&#x27;1234&#x27;</span><br></code></pre></td></tr></table></figure>","prev":{"title":"Docker 安装 Redis","link":"2023/06/13/Docker/03-Docker 安装 Redis"},"next":{"title":"Docker 安装与升级","link":"2023/06/12/Docker/01-Docker安装与升级"},"plink":"http://example.com/2023/06/12/Docker/02-Docker安装MYSQL8数据库/","toc":[{"id":"创建数据卷","title":"创建数据卷","index":"1"},{"id":"创建配置文件","title":"创建配置文件","index":"2"},{"id":"创建容器","title":"创建容器","index":"3"},{"id":"添加用户","title":"添加用户","index":"4"},{"id":"mysql-5.7","title":"MySQL 5.7","index":"5"}],"reading_time":"307 words in 2 min"}