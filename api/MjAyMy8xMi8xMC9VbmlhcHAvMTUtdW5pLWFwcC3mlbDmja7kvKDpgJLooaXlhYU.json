{"title":"uni-app-数据传递补充","date":"2023-12-10T10:30:24.000Z","date_formatted":{"ll":"Dec 10, 2023","L":"12/10/2023","MM-DD":"12-10"},"link":"2023/12/10/Uniapp/15-uni-app-数据传递补充","tags":["Uniapp"],"updated":"2023-12-17T06:56:16.583Z","content":"<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231203181831839-392616363.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"前言\">前言<a title=\"#前言\" href=\"#前言\"></a></h1>\n<ul>\n<li>好，经过上个章节的介绍完毕之后，了解了一下 uni-app-CompositionAPI传递数据</li>\n<li>那么了解完了uni-app-CompositionAPI传递数据之后，这篇文章来给大家介绍一下 uni-app-数据传递补充（也就是在补充一点内容给到大家）</li>\n<li>先主要介绍逆向传递数据，逆向传递数据除了使用事件通道之外，还可以通过 <code>uni.$emit</code> 的方式来进行传递数据，这种方式也是非常的简单</li>\n<li>先来简单的搭建一个演示环境，然后来进行介绍</li>\n<li>分别从 Vue2 与 Vue3 进行介绍</li>\n</ul>\n<h1 id=\"搭建演示环境\">搭建演示环境<a title=\"#搭建演示环境\" href=\"#搭建演示环境\"></a></h1>\n<p>创建一个全新的项目(先来看 Vue2 版本的，所以在创建项目的时候选择 Vue2)：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231216223037623-1366554518.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n<p>然后在配置一下，微信小程序的 AppId，直接去之前的项目中拷贝一下即可，找到之前项目的 <code>manifest.json</code> 文件，然后选择微信小程序配置，复制一下即可。</p>\n<ul>\n<li>经过如上的这么一顿操作之后，就可以搭建完毕运行环境，与编码环境</li>\n<li>接下来就可以开始进行介绍 uni-app-数据传递补充内容了</li>\n</ul>\n<h1 id=\"步入正题\">步入正题<a title=\"#步入正题\" href=\"#步入正题\"></a></h1>\n<h2 id=\"emit(vue2)\">emit(Vue2)<a title=\"#emit(vue2)\" href=\"#emit(vue2)\"></a></h2>\n<ul>\n<li>项目创建好了，我们现在需要分别创建对应的页面，分别是 one 与 index 页面</li>\n<li>在 one 页面中创建一个按钮，点击按钮之后跳转到 index 页面，然后在 index 页面中创建一个按钮，点击按钮之后跳转到 one 页面</li>\n<li>在 one 返回按钮的函数中，通过 <code>uni.$emit</code> 的方式来传递数据，然后在 index 页面中通过 <code>uni.$on</code> 来接收数据</li>\n<li>在 index 页面中除了通过 <code>uni.$on</code> 来接收数据之外，还需要在 <code>onUnload</code> 生命周期函数中通过 <code>uni.$off</code> 来取消监听</li>\n<li>反正你要记住监听了方法那么就一定要取消监听，不然会造成内存泄漏的问题</li>\n</ul>\n<p>one 页面：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;template&gt;<br>\t&lt;view&gt;<br>\t\t&lt;text&gt;one页面&lt;/text&gt;<br>\t\t&lt;button type=&quot;primary&quot; @click=&quot;onGoBackClick&quot;&gt;返回到上一页&lt;/button&gt;<br>\t&lt;/view&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>\texport default &#123;<br>\t\tdata() &#123;<br>\t\t\treturn &#123;&#125;<br>\t\t&#125;,<br>\t\tmethods: &#123;<br>\t\t\tonGoBackClick() &#123;<br>\t\t\t\tuni.navigateBack(&#123;<br>\t\t\t\t\tdelta: 1<br>\t\t\t\t&#125;);<br><br>\t\t\t\t// 通过 $emit 传递数据<br>\t\t\t\tuni.$emit(&quot;test&quot;, &#123;<br>\t\t\t\t\tdata: &quot;通过$emit直接传递数据&quot;<br>\t\t\t\t&#125;)<br>\t\t\t&#125;<br>\t\t&#125;<br>\t&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>\n<p>index 页面：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;template&gt;<br>\t&lt;view&gt;<br>\t\t&lt;button @click=&quot;onJumpOne&quot;&gt;navigateTo&lt;/button&gt;<br>\t&lt;/view&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>\texport default &#123;<br>\t\tmethods: &#123;<br>\t\t\tonJumpOne() &#123;<br>\t\t\t\tuni.navigateTo(&#123;<br>\t\t\t\t\turl: &#x27;/pages/one/one&#x27;<br>\t\t\t\t&#125;)<br>\t\t\t&#125;<br>\t\t&#125;,<br>\t\tonLoad() &#123;<br>\t\t\tuni.$on(&quot;test&quot;, (data) =&gt; &#123;<br>\t\t\t\tconsole.log(data)<br>\t\t\t&#125;)<br>\t\t&#125;,<br>\t\tonUnload() &#123;<br>\t\t\tuni.$off(&quot;test&quot;)<br>\t\t&#125;<br>\t&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>\n<ul>\n<li>经过如上的这么一番操作之后，我们就可以在控制台中看到我们传递的数据了</li>\n</ul>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231217010021986-461968481.gif\" alt loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"emit(vue3)\">emit(Vue3)<a title=\"#emit(vue3)\" href=\"#emit(vue3)\"></a></h2>\n<ul>\n<li>在 Vue3 中，其实写法大差不差的，只不过在 <code>setup</code> 函数中进行编写</li>\n<li>废话不多说，直接上代码</li>\n</ul>\n<p>one 页面：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;template&gt;<br>\t&lt;view&gt;<br>\t\t&lt;text&gt;one&lt;/text&gt;<br>\t\t&lt;text&gt;=======================&lt;/text&gt;<br>\t\t&lt;button type=&quot;default&quot; @click=&quot;onGoBackClick&quot;&gt;返回上一个界面&lt;/button&gt;<br>\t&lt;/view&gt;<br>&lt;/template&gt;<br><br>&lt;script setup&gt;<br>\tfunction onGoBackClick() &#123;<br>\t\tuni.navigateBack(&#123;<br>\t\t\tdelta: 1<br>\t\t&#125;);<br><br>\t\t// 通过 $emit 传递数据<br>\t\tuni.$emit(&quot;test&quot;, &#123;<br>\t\t\tdata: &quot;通过$emit直接传递数据&quot;<br>\t\t&#125;)<br>\t&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>\n<p>index 页面：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;template&gt;<br>\t&lt;view&gt;<br>\t\t&lt;button type=&quot;primary&quot; @click=&quot;onJumpOne&quot;&gt;跳转到One界面&lt;/button&gt;<br>\t&lt;/view&gt;<br>&lt;/template&gt;<br><br>&lt;script setup&gt;<br>\timport &#123;<br>\t\tonLoad,<br>\t\tonUnload<br>\t&#125; from &#x27;@dcloudio/uni-app&#x27;<br><br>\tfunction onJumpOne() &#123;<br>\t\tuni.navigateTo(&#123;<br>\t\t\turl: &#x27;/pages/one/one&#x27;<br>\t\t&#125;)<br>\t&#125;<br><br>\tonLoad(() =&gt; &#123;<br>\t\tuni.$on(&quot;test&quot;, (data) =&gt; &#123;<br>\t\t\tconsole.log(data)<br>\t\t&#125;)<br>\t&#125;)<br><br>\tonUnload(() =&gt; &#123;<br>\t\tuni.$off(&quot;test&quot;)<br>\t&#125;)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>\n<h1 id=\"总结\">总结<a title=\"#总结\" href=\"#总结\"></a></h1>\n<h2 id=\"顺着传递数据\">顺着传递数据<a title=\"#顺着传递数据\" href=\"#顺着传递数据\"></a></h2>\n<ul>\n<li>通过URL传递数据，然后通过 onLoad 生命周期函数中的 options 参数来接收数据</li>\n<li>通过 eventChannel.emit 事件通道传递数据，然后通过 eventChannel.on 来接收数据</li>\n</ul>\n<h2 id=\"逆向传递数据\">逆向传递数据<a title=\"#逆向传递数据\" href=\"#逆向传递数据\"></a></h2>\n<ul>\n<li>通过 <code>uni.$emit</code> 传递数据，然后通过 <code>uni.$on</code> 来接收数据（有一个注意点，就是 <code>uni.$on</code> 注册的事件一定要在页面卸载的时候通过 <code>uni.$off</code> 注销掉）</li>\n<li>通过 eventChannel.emit 事件通道传递数据，然后通过 events 参数来接收数据</li>\n</ul>\n<h1 id=\"end\">End<a title=\"#end\" href=\"#end\"></a></h1>\n<ul>\n<li>如果你有任何问题或建议，欢迎在下方留言，我会尽快回复</li>\n<li>如果你觉得本文对你有帮助，欢迎点赞、收藏，你的支持是我写作的最大动力</li>\n</ul>\n<blockquote>\n<p><a href=\"https://cloud.tencent.com/developer/article/2366050?from_column=20421&amp;from=20421\" target=\"_blank\">我正在参与2023腾讯技术创作特训营第四期有奖征文，快来和我瓜分大奖！</a></p>\n</blockquote>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202311/2105804-20231129232539490-1458223711.png\" alt loading=\"lazy\" class=\"φbp\"></p>\n","prev":{"title":"uni-app-数据缓存","link":"2023/12/16/Uniapp/16-uni-app-数据缓存"},"next":{"title":"uni-app-CompositionAPI传递数据","link":"2023/12/10/Uniapp/14-uni-app-CompositionAPI传递数据"},"plink":"http://example.com/2023/12/10/Uniapp/15-uni-app-数据传递补充/","toc":[{"id":"前言","title":"前言","index":"1"},{"id":"搭建演示环境","title":"搭建演示环境","index":"2"},{"id":"步入正题","title":"步入正题","index":"3","children":[{"id":"emit(vue2)","title":"emit(Vue2)","index":"3.1"},{"id":"emit(vue3)","title":"emit(Vue3)","index":"3.2"}]},{"id":"总结","title":"总结","index":"4","children":[{"id":"顺着传递数据","title":"顺着传递数据","index":"4.1"},{"id":"逆向传递数据","title":"逆向传递数据","index":"4.2"}]},{"id":"end","title":"End","index":"5"}],"reading_time":"1133 words in 8 min"}