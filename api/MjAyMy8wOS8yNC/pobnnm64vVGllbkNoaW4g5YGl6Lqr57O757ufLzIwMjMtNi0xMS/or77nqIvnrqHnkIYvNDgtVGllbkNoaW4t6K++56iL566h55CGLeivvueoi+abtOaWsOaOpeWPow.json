{"title":"TienChin-课程管理-课程更新接口","date":"2023-09-24T07:12:55.000Z","date_formatted":{"ll":"Sep 24, 2023","L":"09/24/2023","MM-DD":"09-24"},"link":"2023/09/24/项目/TienChin 健身系统/2023-6-11/课程管理/48-TienChin-课程管理-课程更新接口","tags":["项目"],"updated":"2023-09-24T09:02:07.179Z","content":"<h1 id=\"更改包名\">更改包名<a title=\"#更改包名\" href=\"#更改包名\"></a></h1>\n<p>将之前的 entity 更改为 domain：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202309/2105804-20230924151334944-1499790098.png\" alt=\"image-20230924151334302\" loading=\"lazy\" class=\"φbp\"></p>\n<p>将之前的 validator 包当中的校验分组接口移动到 common 模块当中，因为其它模块也需要使用就放到公共当中进行存储。</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202309/2105804-20230924151441082-948386325.png\" alt=\"image-20230924151440576\" loading=\"lazy\" class=\"φbp\"></p>\n<p>更改完毕之后在修改下 Course.java 的校验注解的作用范围：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 课程ID</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@TableId(value = &quot;course_id&quot;, type = IdType.AUTO)</span><br><span class=\"hljs-meta\">@NotNull(message = &quot;&#123;course.id.notnull&#125;&quot;)</span><br><span class=\"hljs-keyword\">private</span> Integer courseId;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 课程类型 1.舞蹈类 2.游泳类 3.拳击类</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@NotNull(message = &quot;&#123;course.type.notnull&#125;&quot;, groups = &#123;EditGroup.class, CreateGroup.class&#125;)</span><br><span class=\"hljs-keyword\">private</span> Integer type;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 课程名称</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@NotBlank(message = &quot;&#123;course.name.notnull&#125;&quot;, groups = &#123;EditGroup.class, CreateGroup.class&#125;)</span><br><span class=\"hljs-keyword\">private</span> String name;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 课程价格</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@NotNull(message = &quot;&#123;course.price.notnull&#125;&quot;, groups = &#123;EditGroup.class, CreateGroup.class&#125;)</span><br><span class=\"hljs-meta\">@Min(value = 0, message = &quot;&#123;course.price.invalid&#125;&quot;, groups = &#123;EditGroup.class, CreateGroup.class&#125;)</span><br><span class=\"hljs-keyword\">private</span> Double price;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 课程适用人群</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@NotNull(message = &quot;&#123;course.applyTo.notnull&#125;&quot;, groups = &#123;EditGroup.class, CreateGroup.class&#125;)</span><br><span class=\"hljs-keyword\">private</span> Integer applyTo;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 课程简介</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@NotBlank(message = &quot;&#123;course.info.notnull&#125;&quot;, groups = &#123;EditGroup.class, CreateGroup.class&#125;)</span><br><span class=\"hljs-keyword\">private</span> String info;<br></code></pre></td></tr></table></figure>\n<h1 id=\"validationmessages.properties\">ValidationMessages.properties<a title=\"#validationmessages.properties\" href=\"#validationmessages.properties\"></a></h1>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs properties\"><span class=\"hljs-attr\">course.id.notnull</span>=<span class=\"hljs-string\">课程ID不能为空</span><br></code></pre></td></tr></table></figure>\n<h1 id=\"coursecontroller.java\">CourseController.java<a title=\"#coursecontroller.java\" href=\"#coursecontroller.java\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@PreAuthorize(&quot;hasPermission(&#x27;tienchin:course:edit&#x27;)&quot;)</span><br><span class=\"hljs-meta\">@Log(title = &quot;课程管理&quot;, businessType = BusinessType.UPDATE)</span><br><span class=\"hljs-meta\">@PutMapping</span><br>AjaxResult <span class=\"hljs-title function_\">edit</span><span class=\"hljs-params\">(<span class=\"hljs-meta\">@Validated(EditGroup.class)</span> <span class=\"hljs-meta\">@RequestBody</span> Course course)</span> &#123;<br>    <span class=\"hljs-keyword\">return</span> AjaxResult.success(iCourseService.updateCourse(course) &gt; <span class=\"hljs-number\">0</span> ? <span class=\"hljs-string\">&quot;更新成功&quot;</span> : <span class=\"hljs-string\">&quot;更新失败&quot;</span>);<br>&#125;<br><br><span class=\"hljs-meta\">@PreAuthorize(&quot;hasPermission(&#x27;tienchin:course:edit&#x27;)&quot;)</span><br><span class=\"hljs-meta\">@GetMapping(&quot;/&#123;courseId&#125;&quot;)</span><br>AjaxResult <span class=\"hljs-title function_\">getInfo</span><span class=\"hljs-params\">(<span class=\"hljs-meta\">@PathVariable</span> Long courseId)</span> &#123;<br>    <span class=\"hljs-keyword\">return</span> AjaxResult.success(iCourseService.getById(courseId));<br>&#125;<br></code></pre></td></tr></table></figure>\n<h1 id=\"icourseservice.java\">ICourseService.java<a title=\"#icourseservice.java\" href=\"#icourseservice.java\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 更新课程</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@param</span> course 课程</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@return</span> 影响行数</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">updateCourse</span><span class=\"hljs-params\">(Course course)</span>;<br></code></pre></td></tr></table></figure>\n<h1 id=\"courseserviceimpl.java\">CourseServiceImpl.java<a title=\"#courseserviceimpl.java\" href=\"#courseserviceimpl.java\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Override</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">updateCourse</span><span class=\"hljs-params\">(Course course)</span> &#123;<br>    <span class=\"hljs-comment\">// 设置不需要更新的字段</span><br>    course.setCreateBy(<span class=\"hljs-literal\">null</span>);<br>    course.setCreateTime(<span class=\"hljs-literal\">null</span>);<br>    course.setDelFlag(<span class=\"hljs-literal\">null</span>);<br><br>    <span class=\"hljs-comment\">// 设置需要更新的字段</span><br>    course.setUpdateBy(SecurityUtils.getUsername());<br>    course.setUpdateTime(LocalDateTime.now());<br><br>    <span class=\"hljs-keyword\">return</span> updateById(course) ? <span class=\"hljs-number\">1</span> : <span class=\"hljs-number\">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>","prev":{"title":"TienChin-课程管理-课程更新页面","link":"2023/09/24/项目/TienChin 健身系统/2023-6-11/课程管理/49-TienChin-课程管理-课程更新页面"},"next":{"title":"TienChin-课程管理-添加课程页面","link":"2023/09/24/项目/TienChin 健身系统/2023-6-11/课程管理/47-TienChin-课程管理-添加课程页面"},"plink":"http://example.com/2023/09/24/项目/TienChin 健身系统/2023-6-11/课程管理/48-TienChin-课程管理-课程更新接口/","toc":[{"id":"更改包名","title":"更改包名","index":"1"},{"id":"validationmessages.properties","title":"ValidationMessages.properties","index":"2"},{"id":"coursecontroller.java","title":"CourseController.java","index":"3"},{"id":"icourseservice.java","title":"ICourseService.java","index":"4"},{"id":"courseserviceimpl.java","title":"CourseServiceImpl.java","index":"5"}],"reading_time":"442 words in 3 min"}