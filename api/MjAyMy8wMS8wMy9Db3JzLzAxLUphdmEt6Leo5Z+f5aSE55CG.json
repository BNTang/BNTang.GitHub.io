{"title":"Java-跨域处理","date":"2023-01-03T05:39:45.000Z","date_formatted":{"ll":"Jan 3, 2023","L":"01/03/2023","MM-DD":"01-03"},"link":"2023/01/03/Cors/01-Java-跨域处理","tags":["Cors"],"updated":"2023-01-06T02:02:05.875Z","content":"<p>前后分离架构下肯定会遇到跨域的问题，因为我们的请求都是通过微服务网关来转发的，所以我们可以在网关处, 统一处理跨域。</p>\n<p>下新建 BNTangCorsConfigure 配置类:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BNTangCorsConfigure</span> &#123;<br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-keyword\">public</span> CorsFilter <span class=\"hljs-title function_\">corsFilter</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">UrlBasedCorsConfigurationSource</span> <span class=\"hljs-variable\">source</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UrlBasedCorsConfigurationSource</span>();<br>        <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">CorsConfiguration</span> <span class=\"hljs-variable\">corsConfiguration</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">CorsConfiguration</span>();<br><br>        <span class=\"hljs-comment\">// 表示允许cookie跨域</span><br>        corsConfiguration.setAllowCredentials(<span class=\"hljs-literal\">true</span>);<br><br>        <span class=\"hljs-comment\">// 表示请求头部允许携带任何内容</span><br>        corsConfiguration.addAllowedHeader(CorsConfiguration.ALL);<br>        <span class=\"hljs-comment\">// 表示允许任何来源</span><br>        corsConfiguration.addAllowedOrigin(CorsConfiguration.ALL);<br>        <span class=\"hljs-comment\">// 表示允许任何HTTP方法</span><br>        corsConfiguration.addAllowedMethod(CorsConfiguration.ALL);<br><br>        source.registerCorsConfiguration(<span class=\"hljs-string\">&quot;/**&quot;</span>, corsConfiguration);<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">CorsFilter</span>(source);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>该配置类里注册了 CorsFilter:</p>\n<ul>\n<li>setAllowCredentials(true) 表示允许cookie跨域；</li>\n<li>addAllowedHeader(CorsConfiguration.ALL) 表示请求头部允许携带任何内容；</li>\n<li>addAllowedOrigin(CorsConfiguration.ALL) 表示允许任何来源；</li>\n<li>addAllowedMethod(CorsConfiguration.ALL) 表示允许任何HTTP方法。</li>\n</ul>\n","prev":{"title":"RBAC表结构设计","link":"2023/01/03/RBAC/01-表结构设计"},"next":{"title":"取消数据源的自动装配","link":"2023/01/01/Java/框架/MyBatisPlus/01-取消数据源的自动装配"},"plink":"http://example.com/2023/01/03/Cors/01-Java-跨域处理/","reading_time":"222 words in 1 min"}