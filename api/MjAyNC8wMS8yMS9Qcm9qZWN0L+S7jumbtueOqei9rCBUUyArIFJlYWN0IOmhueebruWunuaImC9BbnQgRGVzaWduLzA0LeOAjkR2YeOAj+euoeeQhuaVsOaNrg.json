{"title":"ã€Dvaã€ç®¡ç†æ•°æ®","date":"2024-01-21T04:04:07.000Z","date_formatted":{"ll":"Jan 21, 2024","L":"01/21/2024","MM-DD":"01-21"},"link":"2024/01/21/Project/ä»é›¶ç©è½¬ TS + React é¡¹ç›®å®æˆ˜/Ant Design/04-ã€Dvaã€ç®¡ç†æ•°æ®","tags":["Dva"],"updated":"2024-01-22T01:13:56.974Z","content":"<p>[toc]</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202401/2105804-20240121120419154-814575546.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n<h1 id=\"ä¸€ã€å‰è¨€\">ä¸€ã€å‰è¨€<a title=\"#ä¸€ã€å‰è¨€\" href=\"#ä¸€ã€å‰è¨€\"></a></h1>\n<blockquote>\n<ul>\n<li>ğŸ¤æœ¬ç¯‡æ–‡ç« æ˜¯ã€ä»é›¶ç©è½¬ TypeScript + React é¡¹ç›®å®æˆ˜ã€ç³»åˆ—æ–‡ç« çš„ç¬¬ 4 ç¯‡ï¼Œä¸»è¦ä»‹ç»ã€Dvaã€ç®¡ç†æ•°æ®</li>\n</ul>\n</blockquote>\n<p>é€šè¿‡ä¸Šä¸€ç¯‡æ–‡ç« çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†ã€Dvaã€æ˜¯ä»€ä¹ˆï¼Œä»¥åŠã€Dvaã€çš„ä½¿ç”¨æ–¹å¼ï¼Œå¦‚ä½•ä½¿ç”¨ã€Dvaã€æ¥æ¸²æŸ“æˆ‘ä»¬çš„ç»„ä»¶ï¼Œå…¶å® dva çš„ä¸»ç”¨ä½œç”¨å¹¶ä¸æ˜¯ç”¨æ¥æ¸²æŸ“ç»„ä»¶çš„ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯å¯¹ reduxã€redux-saga è¿›è¡Œå°è£…ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ç”¨æ¥ç®¡ç†æ•°æ®çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ¥çœ‹ä¸€ä¸‹ã€Dvaã€æ˜¯å¦‚ä½•ç®¡ç†æ•°æ®çš„ã€‚</p>\n<h1 id=\"äºŒã€ç®¡ç†æ•°æ®\">äºŒã€ç®¡ç†æ•°æ®<a title=\"#äºŒã€ç®¡ç†æ•°æ®\" href=\"#äºŒã€ç®¡ç†æ•°æ®\"></a></h1>\n<p>é‚£ä¹ˆå¦‚ä½•ä½¿ç”¨ã€Dvaã€æ¥ç®¡ç†æ•°æ®å‘¢ï¼Ÿè¦æƒ³ä½¿ç”¨ã€Dvaã€æ¥ç®¡ç†æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ã€Dvaã€çš„æ ¸å¿ƒï¼Œã€Dvaã€çš„æ ¸å¿ƒæœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š</p>\n<ul>\n<li>\n<ol>\n<li><code>model</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸€ä¸ªç»„ä»¶å®šä¹‰ä¸€ä¸ª modelï¼Œç„¶ååœ¨è¿™ä¸ª model ä¸­å°±å¯ä»¥ä¿å­˜å¯¹åº”ç»„ä»¶çš„æ•°æ®ï¼Œå°±å¯ä»¥ä¿å­˜å¯¹åº”ç»„ä»¶çš„ reducerã€å°±å¯ä»¥ä¿å­˜å¯¹åº”ç»„ä»¶çš„è´Ÿä½œç”¨ï¼Œå°±å¯ä»¥ä¿å­˜å¯¹åº”ç»„ä»¶è®¢é˜…çš„å†…å®¹ï¼š</li>\n</ol>\n</li>\n</ul>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202401/2105804-20240121131131649-194443262.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>æ‰€ä»¥è¯´çŸ¥é“äº†è¿™ä¸ª model ä¹‹åè¦æƒ³ä½¿ç”¨ dva æ¥ç®¡ç†æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å…ˆå®šä¹‰ä¸€ä¸ª modelã€‚</p>\n<h2 id=\"1.å®šä¹‰-model\">1.å®šä¹‰ Model<a title=\"#1.å®šä¹‰-model\" href=\"#1.å®šä¹‰-model\"></a></h2>\n<p>é‚£ä¹ˆå¦‚ä½•å®šä¹‰ä¸€ä¸ª model å‘¢ï¼Ÿæˆ‘å…ˆä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œæˆ‘å…ˆå®šä¹‰ä¸€ä¸ª Home ç»„ä»¶ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ function Home() &#123;</span><br><span class=\"hljs-addition\">+     return (</span><br><span class=\"hljs-addition\">+         &lt;div&gt;</span><br><span class=\"hljs-addition\">+             Home</span><br><span class=\"hljs-addition\">+         &lt;/div&gt;</span><br><span class=\"hljs-addition\">+     )</span><br><span class=\"hljs-addition\">+ &#125;</span><br></code></pre></td></tr></table></figure>\n<p>æ¥ä¸‹æ¥æˆ‘çš„è¦æ±‚æ˜¯å®šä¹‰ä¸€ä¸ª modelï¼Œç”¨è¿™ä¸ª model æ¥ä¿å­˜ Home ç»„ä»¶çš„æ•°æ®ï¼Œæ¥ä¿å­˜ Home ç»„ä»¶çš„ reducerã€æ¥ä¿å­˜ Home ç»„ä»¶çš„è´Ÿä½œç”¨ã€æ¥ä¿å­˜ Home ç»„ä»¶è®¢é˜…çš„å†…å®¹ï¼Œé‚£ä¹ˆå¦‚ä½•å®šä¹‰å‘¢ï¼Ÿ</p>\n<blockquote>\n<p>æŒ‡å®šå‘½åç©ºé—´</p>\n</blockquote>\n<p>model å…¶å®å°±æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œé‚£ç‰¹æ®Šåœ¨å“ªé‡Œå‘¢ï¼Ÿç‰¹æ®Šåœ¨ä»–æœ‰ä¸€äº›ç‰¹æ®Šçš„ keyï¼Œæ¯”å¦‚è¯´å®ƒé‡Œé¢ï¼Œæœ‰ä¸€ä¸ªå«åš namespace çš„è¿™ä¹ˆä¸€ä¸ª keyï¼Œé€šè¿‡è¿™ä¸ª keyï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šå¯¹åº” model çš„å‘½åç©ºé—´ï¼Œè¿™é‡Œæˆ‘å®šä¹‰ä¸€ä¸ªå« homeModel çš„ modelï¼Œç„¶åæˆ‘åœ¨è¿™ä¸ª model ä¸­é€šè¿‡ namespace æ¥æŒ‡å®šè¿™ä¸ª model çš„å‘½åç©ºé—´æ˜¯ <code>home</code>ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ let homeModel = &#123;</span><br><span class=\"hljs-addition\">+     namespace: &#x27;home&#x27;</span><br><span class=\"hljs-addition\">+ &#125;</span><br></code></pre></td></tr></table></figure>\n<p>ä¸ºä»€ä¹ˆè¦æŒ‡å®šå‘½åç©ºé—´å‘¢ï¼Ÿå› ä¸ºå°†æ¥æˆ‘ä»¬æ˜¯å¯ä»¥å®šä¹‰å¤šä¸ª model çš„ï¼Œä¾‹å¦‚è¿™é‡Œæˆ‘åœ¨æ–°å¢ä¸€ä¸ª model å«åš aboutModelï¼Œç„¶åæˆ‘åœ¨è¿™ä¸ª model ä¸­é€šè¿‡ namespace æ¥æŒ‡å®šè¿™ä¸ª model çš„å‘½åç©ºé—´æ˜¯ <code>about</code>ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ let aboutModel = &#123;</span><br><span class=\"hljs-addition\">+     namespace: &#x27;about&#x27;</span><br><span class=\"hljs-addition\">+ &#125;</span><br></code></pre></td></tr></table></figure>\n<p>å°†æ¥å‘¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å‘½åç©ºé—´æ¥åŒºåˆ†å½“å‰ä½¿ç”¨çš„åˆ°åº•æ˜¯å“ªä¸€ä¸ª modelï¼Œåæ­£ä½ åªéœ€è¦çŸ¥é“ model å°±æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡é‡Œé¢æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ keyï¼Œå«åš namespaceï¼Œé€šè¿‡è¿™ä¸ª keyï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šå¯¹åº” model çš„å‘½åç©ºé—´ï¼Œå‘½åç©ºé—´çš„ä½œç”¨å°±æ˜¯ç”¨æ¥åŒºåˆ†ä¸åŒçš„ modelã€‚</p>\n<blockquote>\n<p>ä¿å­˜æ•°æ®</p>\n</blockquote>\n<p>é‚£ä¹ˆæ¥ä¸‹æ¥å‘¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™ä¸ª model ä¸­ä¿å­˜æ•°æ®äº†ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿å­˜æ•°æ®å‘¢ï¼Ÿåœ¨è¿™ä¸ªç‰¹æ®Šçš„å¯¹è±¡ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ keyï¼Œå«åš stateï¼Œé€šè¿‡è¿™ä¸ª keyï¼Œæˆ‘ä»¬å¯ä»¥ä¿å­˜å¯¹åº” model çš„æ•°æ®ï¼Œä¾‹å¦‚æˆ‘åœ¨ homeModel ä¸­å®šä¹‰ä¸€ä¸ª stateï¼Œç„¶åæˆ‘åœ¨è¿™ä¸ª state ä¸­å®šä¹‰ä¸€ä¸ª countï¼Œè¿™ä¸ª count çš„å€¼æ˜¯ 0ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br> let homeModel = &#123;<br>     namespace: &#x27;home&#x27;,<br><span class=\"hljs-addition\">+    state: &#123;</span><br><span class=\"hljs-addition\">+        count: 0</span><br><span class=\"hljs-addition\">+    &#125;,</span><br> &#125;<br></code></pre></td></tr></table></figure>\n<p>å¦‚æœè¯´è¿™é‡Œè¦å†™ä¸Šä¸€æ®µæ³¨é‡Šä¿¡æ¯çš„è¯ï¼Œé‚£ä¹ˆå°±æ˜¯ï¼šæŒ‡å®šå½“å‰å‘½åç©ºé—´ä¿å­˜çš„æ•°æ®ã€‚</p>\n<blockquote>\n<p>å¤„ç†æ•°æ®</p>\n</blockquote>\n<p>ä¿å­˜å®Œæ¯•æ•°æ®ä¹‹åæˆ‘ä»¬è¿˜è¦å¹²å˜›ï¼Ÿæ˜¯ä¸æ˜¯è¦å¤„ç†æ•°æ®ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡ reducer æ¥å¤„ç†ï¼Œæ‰€ä»¥è¯´è¿™é‡Œæˆ‘å°±è¦ç»™å½“å‰çš„ model å®šä¹‰ä¸€ä¸ª reducerï¼Œé‚£ä¹ˆå¦‚ä½•å®šä¹‰å‘¢ï¼Ÿåœ¨è¿™ä¸ªç‰¹æ®Šçš„å¯¹è±¡ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ keyï¼Œå«åš reducersï¼Œé€šè¿‡è¿™ä¸ª keyï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å¯¹åº” model çš„ reducerï¼Œä¾‹å¦‚æˆ‘åœ¨ homeModel ä¸­å®šä¹‰ä¸€ä¸ª reducerï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br> let homeModel = &#123;<br>     namespace: &#x27;home&#x27;,<br>     state: &#123;<br>         count: 0<br>     &#125;,<br><span class=\"hljs-addition\">+    reducers: &#123;</span><br><span class=\"hljs-addition\">+    &#125;</span><br> &#125;<br></code></pre></td></tr></table></figure>\n<p>reducers å®šä¹‰å¥½äº†ï¼Œé‚£ä¹ˆ reducers ä¸­æ˜¯ä¸æ˜¯è¦å®šä¹‰ä¸€äº›å¤„ç†æ–¹æ³•ï¼Œæ¯”å¦‚è¯´æˆ‘åœ¨è¿™é‡Œå®šä¹‰ä¸€ä¸ªå«åš add çš„å¤„ç†æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯¹åº”ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ stateï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ actionï¼Œstate æ˜¯è¿‡å»çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¿‡å»çš„å€¼ï¼Œaction æ˜¯å½“å‰çš„åŠ¨ä½œï¼Œä¹Ÿå°±æ˜¯å½“å‰æ´¾å‘çš„åŠ¨ä½œï¼Œå’Œè¿‡å»ä¸­çš„ reducer æ˜¯ä¸€æ ·çš„ã€‚</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br> let homeModel = &#123;<br>     namespace: &#x27;home&#x27;,<br>     state: &#123;<br>         count: 0<br>     &#125;,<br>     reducers: &#123;<br><span class=\"hljs-addition\">+        add(state, action) &#123;</span><br><span class=\"hljs-addition\">+        &#125;</span><br>     &#125;<br> &#125;<br></code></pre></td></tr></table></figure>\n<p>é‚£ä¹ˆ reducer ä¸­çš„ key æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿreducer ä¸­ key çš„ä½œç”¨ï¼Œå…¶å®æ˜¯ç”¨æ¥æŒ‡å®šå½“å‰ reducer çš„å¤„ç†æ–¹æ³•çš„ï¼Œä¹Ÿå°±æ˜¯ç±»å‹ï¼Œä¾‹å¦‚æˆ‘ä¸Šé¢å®šä¹‰çš„ä¸€ä¸ª key å«åš addï¼Œä»£è¡¨ç€å°†æ¥åˆ«äººæ´¾å‘ type æ˜¯ add playload æ˜¯ä»€ä¹ˆ xx çš„æ—¶å€™ <code>&#123;type: add, playload: xxx&#125;</code>ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå» reducers ä¸­æ‰¾åˆ° key æ˜¯ add çš„è¿™ä¸ªå“¥ä»¬æ¥å»æ‰§è¡Œã€‚</p>\n<p>å†æ¯”å¦‚è¯´ï¼Œåˆ«äººæ´¾å‘ä¸€ä¸ª subï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå» reducers ä¸­æ‰¾åˆ° key æ˜¯ sub çš„è¿™ä¸ªå“¥ä»¬æ¥å»æ‰§è¡Œï¼Œå‘ç°æ²¡æœ‰ï¼Œé‚£ä¹ˆå°±ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå¦‚æœè¯´æœ‰ï¼Œå®ƒå°±ä¼šæ‰§è¡Œå¯¹åº”çš„æ“ä½œï¼Œæ‰€ä»¥è¯´ reducers ä¸­çš„ key çš„ä½œç”¨ï¼Œå…¶å®æ˜¯ç”¨æ¥æŒ‡å®šå½“å‰ reducer çš„å¤„ç†æ–¹æ³•çš„ï¼Œä¹Ÿå°±æ˜¯ç±»å‹ã€‚</p>\n<p>å¥½ä»‹ç»æ¸…æ¥šäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™ä¸ª add æ–¹æ³•ä¸­å¤„ç†æ•°æ®äº†ï¼Œåœ¨ add ä¸­éœ€è¦å¹²ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘è¿™é‡Œå°±ç®€å•çš„å°† count åŠ  1ï¼Œç„¶åå°†è¿™ä¸ª count è¿”å›å‡ºå»ï¼Œä»£ç çš„å†™æ³•å°±æ˜¯ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>let homeModel = &#123;<br>    namespace: &#x27;home&#x27;,<br>    state: &#123;<br>        count: 0<br>    &#125;,<br>    reducers: &#123;<br>        add: (state, action) =&gt; &#123;<br><span class=\"hljs-addition\">+           return &#123;</span><br><span class=\"hljs-addition\">+               count: state.count + action.count</span><br><span class=\"hljs-addition\">+           &#125;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>æˆ‘å°±æ·»åŠ äº†ä¸‰è¡Œä»£ç ï¼Œè¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡ä¸­æœ‰ä¸€ä¸ª countï¼Œè¿™ä¸ª count çš„å€¼æ˜¯ä¸Šä¸€æ¬¡çš„ count åŠ ä¸Šè¿™ä¸€æ¬¡ action å½“ä¸­ä½ å¸¦è¿‡æ¥ä½ è®©ä»–é€’å¢çš„æ•°ï¼Œè¿™æ ·å°±å¯ä»¥äº†ã€‚</p>\n<p>ç´§æ¥ç€å†æ·»åŠ ä¸€ä¸ª sub æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯å°† count å‡ 1ï¼Œç„¶åå°†è¿™ä¸ª count è¿”å›å‡ºå»ï¼Œä»£ç çš„å†™æ³•å°±æ˜¯ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>let homeModel = &#123;<br>    namespace: &#x27;home&#x27;,<br>    state: &#123;<br>        count: 0<br>    &#125;,<br>    reducers: &#123;<br>        add: (state, action) =&gt; &#123;<br>            return &#123;<br>                count: state.count + action.count<br>            &#125;<br>        &#125;,<br><span class=\"hljs-addition\">+       sub: (state, action) =&gt; &#123;</span><br><span class=\"hljs-addition\">+           return &#123;</span><br><span class=\"hljs-addition\">+               count: state.count - action.count</span><br><span class=\"hljs-addition\">+           &#125;</span><br><span class=\"hljs-addition\">+       &#125;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>åªéœ€è¦å°†åŠ æ³•æ”¹æˆå‡æ³•å°±å¯ä»¥äº†ï¼Œåˆ°æ­¤ä¸ºæ­¢å…³äº model çš„å®šä¹‰å°±ç»“æŸäº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ª model äº†ã€‚</p>\n<h2 id=\"2.æ³¨å†Œ-model\">2.æ³¨å†Œ Model<a title=\"#2.æ³¨å†Œ-model\" href=\"#2.æ³¨å†Œ-model\"></a></h2>\n<p>å®šä¹‰å¥½äº†ä¹‹åæˆ‘ä»¬è¦åœ¨å“ªé‡Œä½¿ç”¨è¿™ä¸ª model å‘¢ï¼Ÿæ˜¯ä¸æ˜¯è¦åœ¨ dva ä¸­è¿›è¡Œä½¿ç”¨ï¼Œé‚£æ€ä¹ˆå‘Šè¯‰ dva æˆ‘ä»¬è¦ä½¿ç”¨è¿™ä¸ª model å‘¢ï¼Ÿ</p>\n<p>å¾ˆç®€å•ï¼Œé€šè¿‡ dva åˆ›å»ºå‡ºæ¥çš„å®ä¾‹å½“ä¸­æœ‰ä¸€ä¸ª model æ–¹æ³•ï¼Œè¿™ä¸€æ­¥æˆ‘ç§°ä¹‹ä¸ºå‘Šè¯‰ dva éœ€è¦ä½¿ç”¨å“ªä¸ª modelï¼Œé‚£ä¹ˆå¦‚ä½•å‘Šè¯‰å‘¢ï¼Ÿå°±æ˜¯é€šè¿‡ dva åˆ›å»ºå‡ºæ¥çš„å®ä¾‹å½“ä¸­çš„ model æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯æˆ‘ä»¬å®šä¹‰çš„ modelï¼Œä¾‹å¦‚æˆ‘åœ¨è¿™é‡Œå‘Šè¯‰ dva æˆ‘è¦ä½¿ç”¨ homeModelï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ app.model(homeModel)</span><br></code></pre></td></tr></table></figure>\n<p><code>app.model</code> æ˜¯å¯ä»¥å¤šæ¬¡è°ƒç”¨çš„ï¼Œä¾‹å¦‚æˆ‘åœ¨è¿™é‡Œå†è°ƒç”¨ä¸€æ¬¡ï¼Œå‘Šè¯‰ dva æˆ‘æ—¢è¦ä½¿ç”¨ homeModelï¼Œä¹Ÿè¦ä½¿ç”¨ aboutModelï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ app.model(aboutModel)</span><br></code></pre></td></tr></table></figure>\n<h2 id=\"3.è¿æ¥-model\">3.è¿æ¥ Model<a title=\"#3.è¿æ¥-model\" href=\"#3.è¿æ¥-model\"></a></h2>\n<p>æœ¬æ–‡ç®€å•ç‚¹åªæ¥ä¸€ä¸ªï¼Œé€šè¿‡å¦‚ä¸Šçš„ä»‹ç»æˆ‘æ˜¯ä¸æ˜¯å·²ç»å‘Šè¯‰ dva æˆ‘è¦åœ¨ dva ä¸­ä½¿ç”¨ homeModel äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥åœ¨ dva ä¸­ä½¿ç”¨ homeModel äº†ã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘åˆè¦è¯´åˆ° dva çš„æœ¬è´¨äº†ï¼Œdva çš„æœ¬è´¨æ˜¯å¯¹ reduxã€redux-saga è¿›è¡Œå°è£…ï¼Œé‚£æ—¢ç„¶æ˜¯å¯¹ redux è¿›è¡Œå°è£…ï¼Œè¿™ä¸ªæ—¶å€™åœ¨ saga ä¸­æƒ³è¦ä½¿ç”¨ä¿å­˜åœ¨ homeModel ä¸­çš„æ•°æ®ï¼Œæƒ³è¦ä½¿ç”¨ homeModel ä¸­çš„ reducerï¼Œæ˜¯ä¸æ˜¯è¦é€šè¿‡ connect è¿æ¥èµ·æ¥ï¼Œåœ¨å›åˆ°æˆ‘å‰é¢ä»‹ç»çš„é‚£å¼ å›¾ï¼š</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202401/2105804-20240121141605216-820840215.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>å†æ¬¡è§‚å¯Ÿä¸Šå›¾ï¼Œæˆ‘ä»¬çš„ model å·²ç»å®šä¹‰å¥½äº†ï¼Œåœ¨ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°æ˜¯ä¸æ˜¯è¿˜è¦é€šè¿‡ saga çš„ connect æŠŠ model å’Œç»„ä»¶è¿æ¥èµ·æ¥ï¼Œè¿™ä¸ªæ—¶å€™æ‰èƒ½åœ¨ç»„ä»¶é‡Œé¢ä½¿ç”¨ Model å½“ä¸­ä¿å­˜çš„æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™æ‰èƒ½åœ¨ç»„ä»¶å½“ä¸­æ´¾å‘ä»»åŠ¡ï¼Œæ´¾å‘ actionï¼Œå»ä¿®æ”¹ Model å½“ä¸­ä¿å­˜çš„æ•°æ®ã€‚</p>\n<p>æ‰€ä»¥æ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡ connect æŠŠ homeModel å’Œ Home ç»„ä»¶å…³è”èµ·æ¥ï¼Œè¿‡å»è®²è§£ saga çš„æ—¶å€™å·²ç»ä»‹ç»è¿‡äº†ï¼Œæ˜¯ä¸æ˜¯éœ€è¦åˆ†åˆ«å®šä¹‰ mapStateToProps å’Œ mapDispatchToPropsï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">  /* index.js */<br><span class=\"hljs-addition\">+ // åœ¨mapStateToPropsæ–¹æ³•ä¸­å‘Šè¯‰React-Redux, éœ€è¦å°†storeä¸­ä¿å­˜çš„å“ªäº›æ•°æ®æ˜ å°„åˆ°å½“å‰ç»„ä»¶çš„propsä¸Š</span><br><span class=\"hljs-addition\">+ const mapStateToProps = (state) =&gt; &#123;</span><br><span class=\"hljs-addition\">+     return &#123;</span><br><span class=\"hljs-addition\">+     &#125;</span><br><span class=\"hljs-addition\">+ &#125;;</span><br><span class=\"hljs-addition\">+ // åœ¨mapDispatchToPropsæ–¹æ³•ä¸­å‘Šè¯‰React-Redux, éœ€è¦å°†å“ªäº›æ´¾å‘çš„ä»»åŠ¡æ˜ å°„åˆ°å½“å‰ç»„ä»¶çš„propsä¸Š</span><br><span class=\"hljs-addition\">+ const mapDispatchToProps = (dispatch) =&gt; &#123;</span><br><span class=\"hljs-addition\">+     return &#123;</span><br><span class=\"hljs-addition\">+     &#125;</span><br><span class=\"hljs-addition\">+ &#125;;</span><br></code></pre></td></tr></table></figure>\n<p>ç„¶åé€šè¿‡ connect æŠŠ mapStateToProps å’Œ mapDispatchToProps å’Œ Home ç»„ä»¶å…³è”èµ·æ¥ï¼Œè¦ä½¿ç”¨ connect é¦–å…ˆéœ€è¦å¯¼å…¥ connectï¼Œå‰é¢è¯´äº† dva æ˜¯å¯¹ reduxã€redux-saga è¿›è¡Œå°è£…ï¼Œæ‰€ä»¥è¯´ connect æ˜¯ä» redux ä¸­å¯¼å…¥çš„ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥ä» dva ä¸­å¯¼å…¥ connectï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ import &#123;connect&#125; from &#x27;dva&#x27;;</span><br></code></pre></td></tr></table></figure>\n<p>ç„¶åé€šè¿‡ connect æŠŠ mapStateToProps å’Œ mapDispatchToProps å’Œ Home ç»„ä»¶å…³è”èµ·æ¥ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ st AdvHome = connect(mapStateToProps, mapDispatchToProps)(Home);</span><br></code></pre></td></tr></table></figure>\n<p>connect éœ€è¦è°ƒç”¨ä¸¤æ¬¡ï¼Œåé¢ä¸€æ¬¡æ˜¯è¦è¿æ¥çš„é‚£ä¸ªç»„ä»¶ï¼Œå‰é¢ä¸€æ¬¡è¦æŠŠ mapStateToProps å’Œ mapDispatchToProps ä¼ ç»™ä»–ï¼Œä¼ ç»™ä»–ä¹‹åï¼Œä»–å°±ä¼šæŠŠ mapStateToProps å’Œ mapDispatchToProps ä¼ ç»™ä½ ã€‚</p>\n<p>ç„¶åä½ å°±å¯ä»¥ä» state é‡Œé¢è·å– countï¼Œåœ¨è¿™é‡Œæœ‰ä¸€ä¸ªæ³¨æ„ç‚¹ï¼Œåœ¨å‰é¢æˆ‘è¯´è¿‡å°†æ¥æˆ‘ä»¬æ˜¯æœ‰å¯èƒ½å®šä¹‰å¤šä¸ª modelï¼Œå¤šä¸ª model ä¸­ï¼Œæ˜¯ä¸æ˜¯éƒ½æœ‰å¯èƒ½ä¿å­˜æ•°æ®ï¼Œä¾‹å¦‚ï¼Œæˆ‘åœ¨é¡¹ç›®ä¸­åœ¨åŠ ä¸€ä¸ª aboutModelï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-keyword\">let</span> aboutModel = &#123;<br>    <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">&#x27;about&#x27;</span>,<br>    <span class=\"hljs-attr\">state</span>: &#123;<br>        <span class=\"hljs-attr\">num</span>: <span class=\"hljs-number\">0</span><br>    &#125;,<br>    <span class=\"hljs-attr\">reducers</span>: &#123;<br>        <span class=\"hljs-attr\">add</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">num</span>: state.<span class=\"hljs-property\">num</span> + action.<span class=\"hljs-property\">num</span><br>            &#125;<br>        &#125;,<br>        <span class=\"hljs-attr\">sub</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">num</span>: state.<span class=\"hljs-property\">num</span> - action.<span class=\"hljs-property\">num</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>æˆ‘åœ¨ model ä¸­å®šä¹‰äº†ä¸€ä¸ª numï¼Œå¹¶ä¸”å®šä¹‰äº†å¯¹åº”çš„ reducersï¼Œç„¶ååœ¨ dva ä¸­æ³¨å†Œä¸€ä¸‹ modelï¼Œå‘Šè¯‰ dva æˆ‘è¦ä½¿ç”¨ aboutModelï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ app.model(aboutModel)</span><br></code></pre></td></tr></table></figure>\n<p>ç°åœ¨æˆ‘ä»¬æ˜¯ä¸æ˜¯åœ¨ dva ä¸­å¼„äº†å¤šä¸ª modelï¼Œé‚£ä¹ˆåœ¨ mapStateToProps ä¸­æ˜ å°„æ•°æ®ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“å½“å‰æ˜ å°„çš„è¿™ä¸ªæ•°æ®æ˜¯ homeModel çš„è¿˜æ˜¯ aboutModel å½“ä¸­çš„å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåœ¨ homeModel ä¸ aboutModel ä¸­æ˜¯ä¸æ˜¯éƒ½æœ‰ä¸€ä¸ª namespaceï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è·å–çš„æ—¶å€™è¯¥å¦‚ä½•è·å–å‘¢ï¼Ÿ</p>\n<h2 id=\"4.ä½¿ç”¨-model\">4.ä½¿ç”¨ Model<a title=\"#4.ä½¿ç”¨-model\" href=\"#4.ä½¿ç”¨-model\"></a></h2>\n<p>åœ¨ mapStateToProps ä¸­ä¼šç»™æˆ‘ä¸€ä¸ª stateï¼Œè¦ä» state ä¸­çš„ namespace ä¸­æ‹¿åˆ°æˆ‘ä»¬çš„æ•°æ®æ‰€ä»¥ mapStateToProps çš„å†™æ³•å°±æ˜¯ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>  const mapStateToProps = (state) =&gt; &#123;<br><span class=\"hljs-addition\">+     return &#123;</span><br><span class=\"hljs-addition\">+         count: state.home.count</span><br><span class=\"hljs-addition\">+     &#125;</span><br>  &#125;;<br></code></pre></td></tr></table></figure>\n<p>æ”¹é€ ä¸ºå¦‚ä¸Šçš„å†™æ³•ï¼Œè¿™ä¸ªæ­¥éª¤æ€»ç»“ä¸‹æ¥å°±æ˜¯éœ€è¦ä»ä¼ å…¥çš„ state å‘½åç©ºé—´ä¸­æ‹¿åˆ°å¯¹åº” Model ä¿å­˜çš„æ•°æ®ã€‚<code>state.home.count</code> å°±ä»£è¡¨ç€æˆ‘ç°åœ¨è¦æ‹¿åˆ°çš„æ˜¯å‘½åç©ºé—´æ˜¯ home çš„è¿™ä¸ª model å½“ä¸­ä¿å­˜çš„ count è¿™ä¸ªæ•°æ®ã€‚</p>\n<p>ç»è¿‡äº†è¿™ä¸€æ­¥æˆ‘ä»¬çš„æ•°æ®å°±å·²ç»æœ‰äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯å®Œå–„ä¸€ä¸‹æ´¾å‘çš„æ–¹æ³•äº†ï¼Œæ›´æ”¹ mapDispatchToPropsï¼Œåœ¨å½“ä¸­å®šä¹‰ä¸€ä¸ª increment æ–¹æ³•ï¼ŒmapDispatchToProps ä¸­é»˜è®¤ä¼šä¼ é€’ä¸€ä¸ª dispatchï¼Œè¿™ä¸ª dispatch å°±æ˜¯ç”¨æ¥æ´¾å‘ä»»åŠ¡çš„ï¼Œç„¶ååœ¨ increment æ–¹æ³•ä¸­åˆ©ç”¨ dispatch æ´¾å‘ä¸€ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡çš„ type æ˜¯ addï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>const mapDispatchToProps = (dispatch) =&gt; &#123;<br>    return &#123;<br><span class=\"hljs-addition\">+        increment() &#123;</span><br><span class=\"hljs-addition\">+            dispatch(&#123;type: &#x27;add&#x27;&#125;);</span><br><span class=\"hljs-addition\">+        &#125;</span><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>\n<p>å°†æ¥åœ¨ç»„ä»¶ä¸­è°ƒç”¨ increment æ–¹æ³•çš„æ—¶å€™ï¼Œå°±ä¼šæ´¾å‘ä¸€ä¸ª type æ˜¯ add çš„ä»»åŠ¡ï¼Œç„¶åæ‰¾åˆ° homeModel å½“ä¸­çš„ reducersï¼Œåœ¨ reducers ä¸­æ‰¾åˆ° key æ˜¯ add çš„è¿™ä¸ªå“¥ä»¬æ¥å»æ‰§è¡Œï¼Œç„¶ååœ¨è¿™ä¸ªå“¥ä»¬ä¸­å°±å¯ä»¥ä¿®æ”¹ count äº†ï¼Œå½“ç„¶è¿˜è¦ç»™è¿™ä¸ªæ´¾å‘çš„ä»»åŠ¡ä¼ é€’ä¸€äº›æ•°æ®è¿˜è¦æ”¹é€ ä¸€ä¸‹ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>const mapDispatchToProps = (dispatch) =&gt; &#123;<br>    return &#123;<br>        increment() &#123;<br><span class=\"hljs-addition\">+            dispatch(&#123;type: &#x27;add&#x27;, count: 1&#125;);</span><br>        &#125;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>\n<p>å¥½äº†é™¤äº†æœ‰ increment æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª decrement æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯æ´¾å‘ä¸€ä¸ª type æ˜¯ sub çš„ä»»åŠ¡ï¼Œç„¶ååœ¨ reducers ä¸­æ‰¾åˆ° key æ˜¯ sub çš„è¿™ä¸ªå“¥ä»¬æ¥å»æ‰§è¡Œï¼Œç„¶ååœ¨è¿™ä¸ªå“¥ä»¬ä¸­å°±å¯ä»¥ä¿®æ”¹ count äº†ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>const mapDispatchToProps = (dispatch) =&gt; &#123;<br>    return &#123;<br>        increment() &#123;<br>            dispatch(&#123;type: &#x27;add&#x27;, count: 1&#125;);<br>        &#125;,<br><span class=\"hljs-addition\">+        decrement() &#123;</span><br><span class=\"hljs-addition\">+            dispatch(&#123;type: &#x27;sub&#x27;, count: 1&#125;);</span><br><span class=\"hljs-addition\">+        &#125;</span><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>\n<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ˜¯ä¸æ˜¯å°±å·²ç»å°† model æ˜ å°„åˆ° Home ç»„ä»¶äº†ï¼Œæ˜ å°„åˆ°äº† Home ç»„ä»¶ï¼Œä»–æ˜¯ä¸æ˜¯å°±å¯ä»¥ä¼ é€’ç»™ Home çš„ props äº†ï¼Œç„¶ååœ¨ Home ç»„ä»¶ä¸­å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œä¾‹å¦‚åœ¨ Home ç»„ä»¶ä¸­æˆ‘æƒ³è¦ä½¿ç”¨ countï¼Œé‚£ä¹ˆæˆ‘å°±å¯ä»¥é€šè¿‡ this.props.count æ¥è·å–ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br><span class=\"hljs-addition\">+ function Home(props) &#123;</span><br>    return (<br>        &lt;div&gt;<br><span class=\"hljs-addition\">+            &lt;p&gt;&#123;props.count&#125;&lt;/p&gt;</span><br>        &lt;/div&gt;<br>    )<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>æˆ‘æ˜¯ä¸æ˜¯å°±å¯ä»¥ç¼–å†™ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªæŒ‰é’®æ˜¯åŠ ï¼Œä¸€ä¸ªæŒ‰é’®æ˜¯å‡ï¼Œç„¶ååœ¨ç‚¹å‡»çš„æ—¶å€™è°ƒç”¨ increment å’Œ decrement æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä¿®æ”¹ count äº†ï¼Œä¾‹å¦‚æˆ‘åœ¨è¿™é‡Œç¼–å†™ä¸€ä¸ªæŒ‰é’®ï¼ŒæŒ‰é’®çš„å†…å®¹æ˜¯ +ï¼Œç„¶ååœ¨ç‚¹å‡»çš„æ—¶å€™è°ƒç”¨ increment æ–¹æ³•ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>function Home(props) &#123;<br>    return (<br>        &lt;div&gt;<br>            &lt;p&gt;&#123;props.count&#125;&lt;/p&gt;<br><span class=\"hljs-addition\">+            &lt;button onClick=&#123;props.increment()&#125;&gt;+&lt;/button&gt;</span><br>        &lt;/div&gt;<br>    )<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>ç„¶åå†ç¼–å†™ä¸€ä¸ªæŒ‰é’®ï¼ŒæŒ‰é’®çš„å†…å®¹æ˜¯ -ï¼Œç„¶ååœ¨ç‚¹å‡»çš„æ—¶å€™è°ƒç”¨ decrement æ–¹æ³•ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>function Home(props) &#123;<br>    return (<br>        &lt;div&gt;<br>            &lt;p&gt;&#123;props.count&#125;&lt;/p&gt;<br>            &lt;button onClick=&#123;props.increment()&#125;&gt;+&lt;/button&gt;<br><span class=\"hljs-addition\">+            &lt;button onClick=&#123;props.decrement()&#125;&gt;-&lt;/button&gt;</span><br>        &lt;/div&gt;<br>    )<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>ç°åœ¨çš„è¿™ä¸ªä»£ç æ˜¯ä¸æ˜¯å°±ä¼šè¿‡å»çš„ä»£ç ä¸€æ ·ï¼Œè¿‡å»ä½¿ç”¨ reduxSage çš„æ—¶å€™æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯è¿™æ ·çš„ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬ä½¿ç”¨ dva çš„æ—¶å€™æ˜¯ä¸æ˜¯å°±å¯ä»¥è¿™æ ·ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹ï¼Œåœ¨å›é¡¾ä¹‹å‰è¿˜éœ€è¦å®Œå–„ä¸€ä¸‹ä»£ç ï¼Œé€šè¿‡ connect è¿æ¥å¥½äº†å¯¹åº”çš„ç»„ä»¶ä¹‹åè¿”å›äº†ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶å°±æ˜¯ AdvHomeï¼Œéœ€è¦ä½¿ç”¨ AdvHome ç»„ä»¶ï¼Œæ‰€ä»¥è¯´åœ¨ App ç»„ä»¶ä¸­ä½¿ç”¨ AdvHome ç»„ä»¶ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">function App() &#123;<br>    return (<br>        &lt;div&gt;<br><span class=\"hljs-addition\">+            &lt;AdvHome/&gt;</span><br>        &lt;/div&gt;<br>    );<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>æœ€ç»ˆçš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-keyword\">import</span> dva, &#123;connect&#125; <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;dva&#x27;</span>;<br><br><span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">dva</span>();<br><br><span class=\"hljs-keyword\">let</span> homeModel = &#123;<br>    <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">&#x27;home&#x27;</span>,<br>    <span class=\"hljs-attr\">state</span>: &#123;<br>        <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">666</span><br>    &#125;,<br>    <span class=\"hljs-attr\">reducers</span>: &#123;<br>        <span class=\"hljs-attr\">add</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">count</span>: state.<span class=\"hljs-property\">count</span> + action.<span class=\"hljs-property\">count</span><br>            &#125;<br>        &#125;,<br>        <span class=\"hljs-attr\">sub</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">count</span>: state.<span class=\"hljs-property\">count</span> - action.<span class=\"hljs-property\">count</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class=\"hljs-keyword\">let</span> aboutModel = &#123;<br>    <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">&#x27;about&#x27;</span>,<br>    <span class=\"hljs-attr\">state</span>: &#123;<br>        <span class=\"hljs-attr\">num</span>: <span class=\"hljs-number\">0</span><br>    &#125;,<br>    <span class=\"hljs-attr\">reducers</span>: &#123;<br>        <span class=\"hljs-attr\">add</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">num</span>: state.<span class=\"hljs-property\">num</span> + action.<span class=\"hljs-property\">num</span><br>            &#125;<br>        &#125;,<br>        <span class=\"hljs-attr\">sub</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">num</span>: state.<span class=\"hljs-property\">num</span> - action.<span class=\"hljs-property\">num</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br>app.<span class=\"hljs-title function_\">model</span>(homeModel);<br>app.<span class=\"hljs-title function_\">model</span>(aboutModel);<br><br><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">mapStateToProps</span> = (<span class=\"hljs-params\">state</span>) =&gt; &#123;<br>    <span class=\"hljs-keyword\">return</span> &#123;<br>        <span class=\"hljs-attr\">count</span>: state.<span class=\"hljs-property\">home</span>.<span class=\"hljs-property\">count</span><br>    &#125;<br>&#125;;<br><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">mapDispatchToProps</span> = (<span class=\"hljs-params\">dispatch</span>) =&gt; &#123;<br>    <span class=\"hljs-keyword\">return</span> &#123;<br>        <span class=\"hljs-title function_\">increment</span>(<span class=\"hljs-params\"></span>) &#123;<br>            <span class=\"hljs-title function_\">dispatch</span>(&#123;<span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&#x27;add&#x27;</span>, <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">1</span>&#125;);<br>        &#125;,<br>        <span class=\"hljs-title function_\">decrement</span>(<span class=\"hljs-params\"></span>) &#123;<br>            <span class=\"hljs-title function_\">dispatch</span>(&#123;<span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&#x27;sub&#x27;</span>, <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">1</span>&#125;);<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">Home</span>(<span class=\"hljs-params\">props</span>) &#123;<br>    <span class=\"hljs-keyword\">return</span> (<br>        <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>&#123;props.count&#125;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">&#123;()</span> =&gt;</span> &#123;</span><br><span class=\"language-xml\">                props.increment()</span><br><span class=\"language-xml\">            &#125;&#125;&gt;+</span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">&#123;()</span> =&gt;</span> &#123;</span><br><span class=\"language-xml\">                props.decrement()</span><br><span class=\"language-xml\">            &#125;&#125;&gt;-</span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span></span><br><span class=\"language-xml\">        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span><br>    )<br>&#125;<br><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">AdvHome</span> = <span class=\"hljs-title function_\">connect</span>(mapStateToProps, mapDispatchToProps)(<span class=\"hljs-title class_\">Home</span>);<br><br><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">App</span>(<span class=\"hljs-params\"></span>) &#123;<br>    <span class=\"hljs-keyword\">return</span> (<br>        <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">AdvHome</span>/&gt;</span></span><br><span class=\"language-xml\">        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span><br>    );<br>&#125;<br><br>app.<span class=\"hljs-title function_\">router</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">App</span>/&gt;</span></span>);<br>app.<span class=\"hljs-title function_\">start</span>(<span class=\"hljs-string\">&#x27;#root&#x27;</span>);<br></code></pre></td></tr></table></figure>\n<p>è¿è¡Œé¡¹ç›®ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼š</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202401/2105804-20240121171545619-872611029.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n<h2 id=\"5.å›é¡¾\">5.å›é¡¾<a title=\"#5.å›é¡¾\" href=\"#5.å›é¡¾\"></a></h2>\n<p>å°†ä¸Šé¢çš„å†…å®¹ç®€å•çš„å›é¡¾ä¸€ä¸‹ï¼š</p>\n<ol>\n<li>é¦–å…ˆå®šä¹‰ Modelï¼ŒæŒ‡å®šäº† Model å¯¹åº”çš„å‘½åç©ºé—´ï¼ŒæŒ‡å®šäº† Model ä¿å­˜çš„æ•°æ®ï¼ŒæŒ‡å®šäº† Model çš„ reducer</li>\n<li>åœ¨ Model çš„ reducer ä¸­å®šä¹‰äº† add ä¸ sub æ–¹æ³•å°†æ¥åªè¦æ´¾å‘äº† add ä¸ sub è¿™ä¸¤ä¸ªä»»åŠ¡ï¼Œå°±ä¼šå»æ‰§è¡Œå¯¹åº”çš„æ–¹æ³•</li>\n<li>åœ¨ dva ä¸­æ³¨å†Œ Modelï¼Œå‘Šè¯‰ dva æˆ‘è¦ä½¿ç”¨å“ªä¸ª Modelï¼Œé€šè¿‡ dva å®ä¾‹ <code>.</code>model æ–¹æ³•æ¥æ³¨å†Œ Model</li>\n<li>åœ¨ dva ä¸­è¿æ¥ Modelï¼Œé€šè¿‡ connect æ–¹æ³•å°† Model ä¸ç»„ä»¶è¿æ¥èµ·æ¥ï¼Œç„¶ååœ¨ç»„ä»¶ä¸­å°±å¯ä»¥ä½¿ç”¨ Model ä¸­ä¿å­˜çš„æ•°æ®äº†ï¼Œåœ¨ connect ä¸­å°†ä¿å­˜çš„æ•°æ®ä¸ä¿å­˜çš„æ–¹æ³•æ˜ å°„åˆ°äº† Home ä¸­å°±æ˜¯ <code>const AdvHome = connect(mapStateToProps, mapDispatchToProps)(Home);</code> è¿™è¡Œä»£ç </li>\n<li>å®šä¹‰äº†ä¸€ä¸ª mapStateToProps æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯å°† Model ä¸­ä¿å­˜çš„æ•°æ®æ˜ å°„åˆ°å½“å‰ç»„ä»¶çš„ props ä¸Šï¼Œç„¶ååœ¨ç»„ä»¶ä¸­å°±å¯ä»¥é€šè¿‡ this.props.count æ¥è·å–åˆ° Model ä¸­ä¿å­˜çš„æ•°æ®äº†</li>\n<li>å®šä¹‰äº†ä¸€ä¸ª mapDispatchToProps æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯å°† Model ä¸­ä¿å­˜çš„æ–¹æ³•æ˜ å°„åˆ°å½“å‰ç»„ä»¶çš„ props ä¸Šï¼Œç„¶ååœ¨ç»„ä»¶ä¸­å°±å¯ä»¥é€šè¿‡ this.props.increment() æ¥è°ƒç”¨ Model ä¸­ä¿å­˜çš„æ–¹æ³•äº†</li>\n</ol>\n<p>å¥½äº†å›é¡¾å®Œæ¯•ä¹‹åå†ç»§ç»­å¾€ä¸‹çœ‹ï¼Œæˆ‘ä»¬è¿è¡Œé¡¹ç›®ä¹‹åé¡µé¢æ˜¾ç¤ºçš„æ˜¯ 666ï¼ŒåŸå› å¾ˆç®€å•å°±æ˜¯æˆ‘ homeModel ä¸­çš„ count æˆ‘ä¿®æ”¹ä¸ºäº† 666ï¼Œä¸ºä»€ä¹ˆä¼šæ˜¾ç¤º 666 å‘¢ï¼Œå°±æ˜¯å› ä¸ºæˆ‘åœ¨ mapStateToProps ä¸­æ˜ç¡®çš„æŒ‡å®šäº†æˆ‘è¦æ‹¿åˆ°çš„æ˜¯ homeModel ä¸­çš„ countï¼Œæ‰€ä»¥è¯´è¿™é‡Œæ˜¯ä¸æ˜¯å°±æ˜¯ homeModel ä¸­çš„ countï¼Œé‚£ä¹ˆå¦‚æœè¯´æˆ‘æƒ³è¦æ‹¿åˆ° aboutModel ä¸­çš„ numï¼Œé‚£ä¹ˆæˆ‘æ˜¯ä¸æ˜¯å°±å¯ä»¥åœ¨ mapStateToProps ä¸­ä¿®æ”¹ä¸ºï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>const mapStateToProps = (state) =&gt; &#123;<br>    return &#123;<br><span class=\"hljs-addition\">+        count: state.about.num</span><br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>\n<p>å›åˆ°æµè§ˆå™¨åˆ·æ–°é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°é¡µé¢æ˜¾ç¤ºçš„æ˜¯ 0ï¼š</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202401/2105804-20240121172337313-1699711609.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>æ˜¾ç¤ºæ²¡é—®é¢˜äº†ï¼Œå†åˆ†åˆ«ç‚¹å‡» + å’Œ - æŒ‰é’®ï¼Œå‘ç°ä¸è¡Œï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸è¡Œå‘¢ï¼ŸåŸå› å¾ˆç®€å•ï¼Œè·å–æ•°æ®çš„æ—¶å€™, æˆ‘ä»¬éœ€è¦æŒ‡å®šä»å“ªä¸€ä¸ªå‘½åç©ºé—´çš„ Model ä¸­è·å–, ä½†æ˜¯åœ¨æ´¾å‘ä»»åŠ¡çš„æ—¶å€™, æˆ‘ä»¬æ²¡æœ‰æŒ‡å®šæ´¾å‘åˆ°å“ªä¸€ä¸ªå‘½åç©ºé—´çš„ Model ä¸­, æ‰€ä»¥è¯´é—®é¢˜å°±å‡ºç°åœ¨è¿™é‡Œï¼ŒåŒç†åœ¨æ´¾å‘ä»»åŠ¡çš„æ—¶å€™, æˆ‘ä»¬ä¹Ÿéœ€è¦æŒ‡å®šè¦æ´¾å‘ç»™å“ªä¸€ä¸ªå‘½åç©ºé—´çš„ Modelã€‚</p>\n<p>å°±ä»¥æˆ‘ä»¬ç°åœ¨çš„ä»£ç æ¥çœ‹ï¼Œä»–æ€ä¹ˆçŸ¥é“ add ä¸ sub è¿™ä¸¤ä¸ªä»»åŠ¡æ˜¯æ´¾å‘åˆ° Model ä¸­çš„å‘¢ï¼Ÿæ‰€ä»¥è¯´åœ¨æ´¾å‘ä»»åŠ¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦æŒ‡å®šè¦æ´¾å‘ç»™å“ªä¸€ä¸ªå‘½åç©ºé—´çš„ Modelï¼Œé‚£ä¹ˆå¦‚ä½•æŒ‡å®šå‘¢ï¼Ÿå¾ˆç®€å•ï¼Œåœ¨ type å–å€¼å‰é¢åŠ ä¸Šå‘½åç©ºé—´å°±å¯ä»¥äº†ï¼Œä¾‹å¦‚æˆ‘åœ¨è¿™é‡ŒæŒ‡å®š type ä¸º <code>home/add</code>ï¼š</p>\n<figure class=\"highlight diff\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs diff\">/* index.js */<br>const mapDispatchToProps = (dispatch) =&gt; &#123;<br>    return &#123;<br>        increment() &#123;<br><span class=\"hljs-deletion\">-            dispatch(&#123;type: &#x27;add&#x27;, count: 1&#125;);</span><br><span class=\"hljs-addition\">+            dispatch(&#123;type: &#x27;home/add&#x27;, count: 1&#125;);</span><br>        &#125;,<br>        decrement() &#123;<br><span class=\"hljs-deletion\">-            dispatch(&#123;type: &#x27;sub&#x27;, count: 1&#125;);</span><br><span class=\"hljs-addition\">+            dispatch(&#123;type: &#x27;home/sub&#x27;, count: 1&#125;);</span><br>        &#125;<br>    &#125;<br>&#125;;<br></code></pre></td></tr></table></figure>\n<p>è®°å¾—å°† mapStateToProps ä¸­ä»£ç æ”¹ä¸º homeModelï¼Œæœ¬æ–‡åŸºäº homeModel è¿›è¡Œæ•ˆæœæµ‹è¯•æ¼”ç¤ºï¼Œè¿è¡Œé¡¹ç›®ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„æ•ˆæœï¼š</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202401/2105804-20240121173506413-257080539.gif\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n<p>æœ€åé™„ä¸Šå®Œæ•´ä»£ç ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-keyword\">import</span> dva, &#123;connect&#125; <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&#x27;dva&#x27;</span>;<br><br><span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">dva</span>();<br><br><span class=\"hljs-keyword\">let</span> homeModel = &#123;<br>    <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">&#x27;home&#x27;</span>,<br>    <span class=\"hljs-attr\">state</span>: &#123;<br>        <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">666</span><br>    &#125;,<br>    <span class=\"hljs-attr\">reducers</span>: &#123;<br>        <span class=\"hljs-attr\">add</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">count</span>: state.<span class=\"hljs-property\">count</span> + action.<span class=\"hljs-property\">count</span><br>            &#125;<br>        &#125;,<br>        <span class=\"hljs-attr\">sub</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">count</span>: state.<span class=\"hljs-property\">count</span> - action.<span class=\"hljs-property\">count</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><span class=\"hljs-keyword\">let</span> aboutModel = &#123;<br>    <span class=\"hljs-attr\">namespace</span>: <span class=\"hljs-string\">&#x27;about&#x27;</span>,<br>    <span class=\"hljs-attr\">state</span>: &#123;<br>        <span class=\"hljs-attr\">num</span>: <span class=\"hljs-number\">0</span><br>    &#125;,<br>    <span class=\"hljs-attr\">reducers</span>: &#123;<br>        <span class=\"hljs-attr\">add</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">num</span>: state.<span class=\"hljs-property\">num</span> + action.<span class=\"hljs-property\">num</span><br>            &#125;<br>        &#125;,<br>        <span class=\"hljs-attr\">sub</span>: <span class=\"hljs-function\">(<span class=\"hljs-params\">state, action</span>) =&gt;</span> &#123;<br>            <span class=\"hljs-keyword\">return</span> &#123;<br>                <span class=\"hljs-attr\">num</span>: state.<span class=\"hljs-property\">num</span> - action.<span class=\"hljs-property\">num</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br>app.<span class=\"hljs-title function_\">model</span>(homeModel);<br>app.<span class=\"hljs-title function_\">model</span>(aboutModel);<br><br><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">mapStateToProps</span> = (<span class=\"hljs-params\">state</span>) =&gt; &#123;<br>    <span class=\"hljs-keyword\">return</span> &#123;<br>        <span class=\"hljs-attr\">count</span>: state.<span class=\"hljs-property\">home</span>.<span class=\"hljs-property\">count</span><br>    &#125;<br>&#125;;<br><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">mapDispatchToProps</span> = (<span class=\"hljs-params\">dispatch</span>) =&gt; &#123;<br>    <span class=\"hljs-keyword\">return</span> &#123;<br>        <span class=\"hljs-title function_\">increment</span>(<span class=\"hljs-params\"></span>) &#123;<br>            <span class=\"hljs-title function_\">dispatch</span>(&#123;<span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&#x27;home/add&#x27;</span>, <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">1</span>&#125;);<br>        &#125;,<br>        <span class=\"hljs-title function_\">decrement</span>(<span class=\"hljs-params\"></span>) &#123;<br>            <span class=\"hljs-title function_\">dispatch</span>(&#123;<span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&#x27;home/sub&#x27;</span>, <span class=\"hljs-attr\">count</span>: <span class=\"hljs-number\">1</span>&#125;);<br>        &#125;<br>    &#125;<br>&#125;;<br><br><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">Home</span>(<span class=\"hljs-params\">props</span>) &#123;<br>    <span class=\"hljs-keyword\">return</span> (<br>        <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>&#123;props.count&#125;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">&#123;()</span> =&gt;</span> &#123;</span><br><span class=\"language-xml\">                props.increment()</span><br><span class=\"language-xml\">            &#125;&#125;&gt;+</span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">onClick</span>=<span class=\"hljs-string\">&#123;()</span> =&gt;</span> &#123;</span><br><span class=\"language-xml\">                props.decrement()</span><br><span class=\"language-xml\">            &#125;&#125;&gt;-</span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span></span><br><span class=\"language-xml\">        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span><br>    )<br>&#125;<br><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">AdvHome</span> = <span class=\"hljs-title function_\">connect</span>(mapStateToProps, mapDispatchToProps)(<span class=\"hljs-title class_\">Home</span>);<br><br><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">App</span>(<span class=\"hljs-params\"></span>) &#123;<br>    <span class=\"hljs-keyword\">return</span> (<br>        <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span></span><br><span class=\"language-xml\">            <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">AdvHome</span>/&gt;</span></span><br><span class=\"language-xml\">        <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span></span><br>    );<br>&#125;<br><br>app.<span class=\"hljs-title function_\">router</span>(<span class=\"hljs-function\">() =&gt;</span> <span class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">App</span>/&gt;</span></span>);<br>app.<span class=\"hljs-title function_\">start</span>(<span class=\"hljs-string\">&#x27;#root&#x27;</span>);<br></code></pre></td></tr></table></figure>\n<h1 id=\"ä¸‰ã€æ€»ç»“\">ä¸‰ã€æ€»ç»“<a title=\"#ä¸‰ã€æ€»ç»“\" href=\"#ä¸‰ã€æ€»ç»“\"></a></h1>\n<p>é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œæ‚¨å¯ä»¥æŒæ¡ä»¥ä¸‹çŸ¥è¯†ç‚¹ï¼š</p>\n<ul>\n<li>\n<ol>\n<li>äº†è§£ã€Dvaã€çš„æ ¸å¿ƒ</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>äº†è§£å¦‚ä½•å®šä¹‰ Model</li>\n</ol>\n</li>\n<li>\n<ol start=\"3\">\n<li>äº†è§£å¦‚ä½•æ³¨å†Œ Model</li>\n</ol>\n</li>\n<li>\n<ol start=\"4\">\n<li>äº†è§£å¦‚ä½•è¿æ¥ Model</li>\n</ol>\n</li>\n<li>\n<ol start=\"5\">\n<li>äº†è§£å¦‚ä½•ä½¿ç”¨ Model</li>\n</ol>\n</li>\n</ul>\n<blockquote>\n<p>ğŸ¤å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹èµã€æ”¶è—æˆ–åˆ†äº«ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘åˆ›ä½œçš„æœ€å¤§åŠ¨åŠ›ï¼</p>\n</blockquote>\n<p>è¿™ç¯‡æ–‡ç« çš„å†…å®¹å°±ä»‹ç»åˆ°è¿™é‡Œï¼ŒæœŸå¾…æˆ‘ä»¬ä¸‹æ¬¡çš„ç›¸é‡ã€‚æ„Ÿè°¢æ‚¨èŠ±æ—¶é—´é˜…è¯»ï¼Œå¦‚æœæœ‰ä»»ä½•é—®é¢˜æˆ–æƒ³æ³•ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231211215004818-977875224.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n","prev":{"title":"ã€Echartsã€ç®€ä»‹","link":"2024/01/24/Web/ECharts/01-ã€Echartsã€ç®€ä»‹"},"next":{"title":"ã€Dvaã€ä½¿ç”¨","link":"2024/01/20/Project/ä»é›¶ç©è½¬ TS + React é¡¹ç›®å®æˆ˜/Ant Design/03-ã€Dvaã€ä½¿ç”¨"},"plink":"http://example.com/2024/01/21/Project/ä»é›¶ç©è½¬ TS + React é¡¹ç›®å®æˆ˜/Ant Design/04-ã€Dvaã€ç®¡ç†æ•°æ®/","toc":[{"id":"ä¸€ã€å‰è¨€","title":"ä¸€ã€å‰è¨€","index":"1"},{"id":"äºŒã€ç®¡ç†æ•°æ®","title":"äºŒã€ç®¡ç†æ•°æ®","index":"2","children":[{"id":"1.å®šä¹‰-model","title":"1.å®šä¹‰ Model","index":"2.1"},{"id":"2.æ³¨å†Œ-model","title":"2.æ³¨å†Œ Model","index":"2.2"},{"id":"3.è¿æ¥-model","title":"3.è¿æ¥ Model","index":"2.3"},{"id":"4.ä½¿ç”¨-model","title":"4.ä½¿ç”¨ Model","index":"2.4"},{"id":"5.å›é¡¾","title":"5.å›é¡¾","index":"2.5"}]},{"id":"ä¸‰ã€æ€»ç»“","title":"ä¸‰ã€æ€»ç»“","index":"3"}]}