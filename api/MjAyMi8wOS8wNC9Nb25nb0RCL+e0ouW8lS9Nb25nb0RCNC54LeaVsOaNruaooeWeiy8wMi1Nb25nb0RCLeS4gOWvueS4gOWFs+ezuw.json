{"title":"MongoDB-一对一关系","date":"2022-09-04T05:42:23.000Z","date_formatted":{"ll":"Sep 4, 2022","L":"09/04/2022","MM-DD":"09-04"},"link":"2022/09/04/MongoDB/索引/MongoDB4.x-数据模型/02-MongoDB-一对一关系","tags":["MongoDB"],"updated":"2022-09-04T05:50:18.570Z","content":"<h1 id=\"文档一对一关系\">文档一对一关系<a title=\"#文档一对一关系\" href=\"#文档一对一关系\"></a></h1>\n<p>一个人有一张身份证。</p>\n<p>内嵌式结构：</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs json\">db.person.insert(<span class=\"hljs-punctuation\">&#123;</span><br>    name<span class=\"hljs-punctuation\">:</span>&#x27;zs&#x27;<span class=\"hljs-punctuation\">,</span><br>    age<span class=\"hljs-punctuation\">:</span>&#x27;<span class=\"hljs-number\">18</span>&#x27;<span class=\"hljs-punctuation\">,</span><br>    card<span class=\"hljs-punctuation\">:</span><span class=\"hljs-punctuation\">&#123;</span><br>        num<span class=\"hljs-punctuation\">:</span>&#x27;<span class=\"hljs-number\">420626200002023556</span>&#x27;<span class=\"hljs-punctuation\">,</span><br>        date<span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">88</span><br>    <span class=\"hljs-punctuation\">&#125;</span><br><span class=\"hljs-punctuation\">&#125;</span>)<br><br>db.person.find(<span class=\"hljs-punctuation\">&#123;</span>name<span class=\"hljs-punctuation\">:</span>&#x27;zs&#x27;<span class=\"hljs-punctuation\">&#125;</span>)<br></code></pre></td></tr></table></figure>\n<h2 id=\"优势\">优势<a title=\"#优势\" href=\"#优势\"></a></h2>\n<p>一次查询就能得到所有数据</p>\n<h2 id=\"劣势\">劣势<a title=\"#劣势\" href=\"#劣势\"></a></h2>\n<p>如果数据比较复杂, 不方便管理和更新</p>\n<h2 id=\"应用场景\">应用场景<a title=\"#应用场景\" href=\"#应用场景\"></a></h2>\n<p>数据不复杂 / 查询频率较高数据</p>\n<h1 id=\"规范式结构\">规范式结构<a title=\"#规范式结构\" href=\"#规范式结构\"></a></h1>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs json\">db.card.insert(<span class=\"hljs-punctuation\">&#123;</span><br>    _id<span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">123</span><span class=\"hljs-punctuation\">,</span><br>    num<span class=\"hljs-punctuation\">:</span>&#x27;<span class=\"hljs-number\">420626200002023556</span>&#x27;<span class=\"hljs-punctuation\">,</span><br>    date<span class=\"hljs-punctuation\">:</span> &#x27;<span class=\"hljs-number\">2022</span><span class=\"hljs-number\">-12</span><span class=\"hljs-number\">-08</span>&#x27;<span class=\"hljs-punctuation\">,</span><br>    userId<span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">456</span><br><span class=\"hljs-punctuation\">&#125;</span>)<br>db.person.insert(<span class=\"hljs-punctuation\">&#123;</span><br>    _id<span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">456</span><span class=\"hljs-punctuation\">,</span><br>    name<span class=\"hljs-punctuation\">:</span>&#x27;zs&#x27;<span class=\"hljs-punctuation\">,</span><br>    age<span class=\"hljs-punctuation\">:</span>&#x27;<span class=\"hljs-number\">18</span>&#x27;<span class=\"hljs-punctuation\">,</span><br>    cardId<span class=\"hljs-punctuation\">:</span> <span class=\"hljs-number\">123</span><br><span class=\"hljs-punctuation\">&#125;</span>)<br>db.person.aggregate(<span class=\"hljs-punctuation\">[</span><br>    <span class=\"hljs-punctuation\">&#123;</span>$lookup<span class=\"hljs-punctuation\">:</span><span class=\"hljs-punctuation\">&#123;</span><br>        from<span class=\"hljs-punctuation\">:</span> &#x27;card&#x27;<span class=\"hljs-punctuation\">,</span><br>        localField<span class=\"hljs-punctuation\">:</span> &#x27;cardId&#x27;<span class=\"hljs-punctuation\">,</span><br>        foreignField<span class=\"hljs-punctuation\">:</span> &#x27;_id&#x27;<span class=\"hljs-punctuation\">,</span><br>        as<span class=\"hljs-punctuation\">:</span> &#x27;card&#x27;<br>    <span class=\"hljs-punctuation\">&#125;</span><span class=\"hljs-punctuation\">&#125;</span><br><span class=\"hljs-punctuation\">]</span>)<br></code></pre></td></tr></table></figure>\n<h2 id=\"优势-1\">优势<a title=\"#优势-1\" href=\"#优势-1\"></a></h2>\n<p>如果数据比较复杂, 也方便管理和更新</p>\n<h2 id=\"劣势-1\">劣势<a title=\"#劣势-1\" href=\"#劣势-1\"></a></h2>\n<p>查询数据相对内嵌结果稍微有点复杂</p>\n<h2 id=\"应用场景-1\">应用场景<a title=\"#应用场景-1\" href=\"#应用场景-1\"></a></h2>\n<p>数据比较复杂 / 更新频率较高数据</p>\n","prev":{"title":"MongoDB-文档之间关系","link":"2022/09/04/MongoDB/索引/MongoDB4.x-数据模型/01-MongoDB-文档之间关系"},"next":{"title":"MongoDB-删除索引","link":"2022/08/28/MongoDB/索引/08-MongoDB-删除索引"},"plink":"http://example.com/2022/09/04/MongoDB/索引/MongoDB4.x-数据模型/02-MongoDB-一对一关系/","toc":[{"id":"文档一对一关系","title":"文档一对一关系","index":"1","children":[{"id":"优势","title":"优势","index":"1.1"},{"id":"劣势","title":"劣势","index":"1.2"},{"id":"应用场景","title":"应用场景","index":"1.3"}]},{"id":"规范式结构","title":"规范式结构","index":"2","children":[{"id":"优势-1","title":"优势","index":"2.1"},{"id":"劣势-1","title":"劣势","index":"2.2"},{"id":"应用场景-1","title":"应用场景","index":"2.3"}]}],"reading_time":"212 words in 1 min"}