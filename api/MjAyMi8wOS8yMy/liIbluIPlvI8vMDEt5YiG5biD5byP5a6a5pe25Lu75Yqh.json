{"title":"分布式定时任务","date":"2022-09-23T05:37:03.000Z","date_formatted":{"ll":"Sep 23, 2022","L":"09/23/2022","MM-DD":"09-23"},"link":"2022/09/23/分布式/01-分布式定时任务","tags":["分布式"],"updated":"2022-09-24T00:36:11.086Z","content":"<h1 id=\"任务调度场景\">任务调度场景<a title=\"#任务调度场景\" href=\"#任务调度场景\"></a></h1>\n<h2 id=\"概述\">概述<a title=\"#概述\" href=\"#概述\"></a></h2>\n<p>在平时的业务场景中，经常有一些场景需要使用定时任务。</p>\n<h2 id=\"时间驱动的场景\">时间驱动的场景<a title=\"#时间驱动的场景\" href=\"#时间驱动的场景\"></a></h2>\n<ul>\n<li>某个时间点发送优惠券，发送短信等等</li>\n<li>生成报表</li>\n<li>爬虫(定点爬取某排行榜信息)</li>\n</ul>\n<h2 id=\"批量处理数据\">批量处理数据<a title=\"#批量处理数据\" href=\"#批量处理数据\"></a></h2>\n<p>批量统计上个月的账单，统计上个月销售数据等等。</p>\n<h2 id=\"固定频率的场景\">固定频率的场景<a title=\"#固定频率的场景\" href=\"#固定频率的场景\"></a></h2>\n<p>每隔 5 分钟需要执行一次。</p>\n<h1 id=\"为什么需要任务调度平台\">为什么需要任务调度平台<a title=\"#为什么需要任务调度平台\" href=\"#为什么需要任务调度平台\"></a></h1>\n<p>在 Java 中，传统的定时任务实现方案，比如 Timer，Quartz 等，<strong>缺点</strong><br>\n：不支持集群、不支持统计、没有管理平台、没有失败报警、没有监控等等，分布式的架构中，有一些场景需要分布式任务调度，同一个服务多个实例的任务存在互斥时，需要统一的调度，任务调度需要支持高可用、监控、故障告警。需要统一管理和追踪各个服务节点任务调度的结果，需要记录保存任务属性信息等。</p>\n<h1 id=\"什么是分布式任务调度\">什么是分布式任务调度<a title=\"#什么是分布式任务调度\" href=\"#什么是分布式任务调度\"></a></h1>\n<p>任务调度是指基于给定的时间点，给定的时间间隔或者给定执行次数自动的执行任务。任务调度是是操作系统的重要组成部分，而对于实时的操作系统，任务调度直接影响着操作系统的实时性能。任务调度涉及到多线程并发、运行时间规则定制及解析、线程池的维护等诸多方面的工作。</p>\n<h1 id=\"任务调度框架\">任务调度框架<a title=\"#任务调度框架\" href=\"#任务调度框架\"></a></h1>\n<h2 id=\"非分布式\">非分布式<a title=\"#非分布式\" href=\"#非分布式\"></a></h2>\n<p>在单一服务器当中，创建定时任务，<code>@Scheduled</code>。</p>\n<h2 id=\"分布式\">分布式<a title=\"#分布式\" href=\"#分布式\"></a></h2>\n<blockquote>\n<p>把分散的，可靠性差的计划任务纳入统一的平台，并实现集群管理调度和分布式部署的一种定时任务的管理方式，叫做分布式定时任务</p>\n</blockquote>\n<h3 id=\"quartz\">Quartz<a title=\"#quartz\" href=\"#quartz\"></a></h3>\n<ul>\n<li>先驱者</li>\n<li>无图形化界面</li>\n<li>接口不人性化</li>\n</ul>\n<h3 id=\"elasticjob\">Elasticjob<a title=\"#elasticjob\" href=\"#elasticjob\"></a></h3>\n<ul>\n<li>基于 Quartz</li>\n<li>elastic-job 是由当当网基于 Quartz 二次开发之后的分布式调度解决方案</li>\n<li>依赖很多中间件 zk</li>\n</ul>\n<h3 id=\"xxl-job\">xxl-job<a title=\"#xxl-job\" href=\"#xxl-job\"></a></h3>\n<ul>\n<li>美团点评里面开发者开发出来的</li>\n</ul>\n<h3 id=\"schedulerx\">SchedulerX<a title=\"#schedulerx\" href=\"#schedulerx\"></a></h3>\n<ul>\n<li>阿里云出的一个框架</li>\n<li>商用产品</li>\n</ul>\n<h3 id=\"powerjob\">PowerJob<a title=\"#powerjob\" href=\"#powerjob\"></a></h3>\n<ul>\n<li>个人</li>\n</ul>\n<p>对比：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211005103649017-1519454990.png\" alt=\"image-20211005103645171\" loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"@scheduled\">@Scheduled<a title=\"#@scheduled\" href=\"#@scheduled\"></a></h1>\n<p>创建工程：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211005215757972-1621196026.png\" alt=\"image-20211005215756861\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211005215832273-1721745666.png\" alt=\"image-20211005215830979\" loading=\"lazy\" class=\"φbp\"></p>\n<p>使用 @Scheduled 添加注解创建 JobTest.java：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> distributed-TimedTask</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/5 005 22:00</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@EnableScheduling</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JobTest</span> &#123;<br>    <span class=\"hljs-meta\">@Scheduled(fixedDelayString = &quot;3000&quot;, initialDelay = 5000)</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">work</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> InterruptedException &#123;<br>        log.info(<span class=\"hljs-string\">&quot;work任务开始！&quot;</span>);<br>        Thread.sleep(<span class=\"hljs-number\">5000</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>启动之后运行效果如下图所示：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211005221058564-386036324.png\" alt=\"image-20211005221057668\" loading=\"lazy\" class=\"φbp\"></p>\n<ul>\n<li>@EnableScheduling：是否要开启 Scheduled 也可以加在启动类上，整个项目生效，@Scheduled<br>\n注解中属性的取值的含义，fixedDelayString、fixedDelay 代表固定延时，要等上一次任务结束时，下一次才开始计时，initialDelay<br>\n代表延迟启动。</li>\n</ul>\n<p>修改一下 JobTest.java 的内容这里还需要在介绍一个 @Scheduled 注解当中的另外一个属性代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> distributed-TimedTask</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/5 005 22:00</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@EnableScheduling</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JobTest</span> &#123;<br>    <span class=\"hljs-meta\">@Scheduled(fixedRateString = &quot;3000&quot;, initialDelay = 5000)</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">show</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> InterruptedException &#123;<br>        log.info(<span class=\"hljs-string\">&quot;show任务开始！&quot;</span>);<br>        Thread.sleep(<span class=\"hljs-number\">5000</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>启动之后运行效果如下图所示：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211005221526257-474338518.png\" alt=\"image-20211005221525367\" loading=\"lazy\" class=\"φbp\"></p>\n<ul>\n<li>fixedRateString 代表的是等上一个任务结束之后，立马执行下一个任务，不会在等 3 秒，每隔 3 秒执行一次，程序耗时是 5<br>\n秒，由于是单线程，要等上一次方法执行完后，立马执行下一次。</li>\n</ul>\n<h2 id=\"异步任务调度\">异步任务调度<a title=\"#异步任务调度\" href=\"#异步任务调度\"></a></h2>\n<h3 id=\"开启异步调度\">开启异步调度<a title=\"#开启异步调度\" href=\"#开启异步调度\"></a></h3>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211005221917771-1493543239.png\" alt=\"image-20211005221916955\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"创建异步任务\">创建异步任务<a title=\"#创建异步任务\" href=\"#创建异步任务\"></a></h3>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006100503842-1341233498.png\" alt=\"image-20211006100458713\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> distributed-TimedTask</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/5 005 22:20</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyTask</span> &#123;<br>    <span class=\"hljs-meta\">@Async</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">doTask</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> InterruptedException &#123;<br>        log.info(<span class=\"hljs-string\">&quot;doTask任务开始！&quot;</span>);<br>        Thread.sleep(<span class=\"hljs-number\">5000</span>);<br>        log.info(<span class=\"hljs-string\">&quot;doTask任务结束！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<h3 id=\"调用异步任务\">调用异步任务<a title=\"#调用异步任务\" href=\"#调用异步任务\"></a></h3>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006100813267-788551156.png\" alt=\"image-20211006100811088\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> distributed-TimedTask</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/5 005 22:00</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@EnableScheduling</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JobTest</span> &#123;<br><br>    <span class=\"hljs-meta\">@Resource</span><br>    <span class=\"hljs-keyword\">private</span> MyTask myTask;<br><br>    <span class=\"hljs-meta\">@Scheduled(fixedRateString = &quot;3000&quot;, initialDelay = 5000)</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">show</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> InterruptedException &#123;<br>        log.info(<span class=\"hljs-string\">&quot;show任务开始！&quot;</span>);<br>        <span class=\"hljs-built_in\">this</span>.myTask.doTask();<br>        log.info(<span class=\"hljs-string\">&quot;show任务结束！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>启动之后运行效果如下图所示：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006100912446-534072984.png\" alt=\"image-20211006100910131\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"开启多线程执行\">开启多线程执行<a title=\"#开启多线程执行\" href=\"#开启多线程执行\"></a></h2>\n<p>修改 JobTest.java：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> distributed-TimedTask</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/5 005 22:00</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@EnableScheduling</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JobTest</span> &#123;<br><br>    <span class=\"hljs-meta\">@Scheduled(fixedRateString = &quot;3000&quot;)</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">work</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> InterruptedException &#123;<br>        log.info(<span class=\"hljs-string\">&quot;work任务开始！&quot;</span>);<br>        Thread.sleep(<span class=\"hljs-number\">5000</span>);<br>        log.info(<span class=\"hljs-string\">&quot;work任务结束！&quot;</span>);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Scheduled(fixedRateString = &quot;3000&quot;)</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">show</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> InterruptedException &#123;<br>        log.info(<span class=\"hljs-string\">&quot;show任务开始！&quot;</span>);<br>        Thread.sleep(<span class=\"hljs-number\">5000</span>);<br>        log.info(<span class=\"hljs-string\">&quot;show任务结束！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>修改启动类 DistributedTimedTaskApplication.java：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006102421576-353861805.png\" alt=\"image-20211006102416938\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 分布式定时任务应用程序</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@date</span> 2021/10/05</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@EnableAsync</span><br><span class=\"hljs-meta\">@SpringBootApplication</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DistributedTimedTaskApplication</span> &#123;<br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> &#123;<br>        SpringApplication.run(DistributedTimedTaskApplication.class, args);<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-keyword\">public</span> TaskScheduler <span class=\"hljs-title function_\">taskScheduler</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-type\">ThreadPoolTaskScheduler</span> <span class=\"hljs-variable\">threadPoolTaskScheduler</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ThreadPoolTaskScheduler</span>();<br>        threadPoolTaskScheduler.setPoolSize(<span class=\"hljs-number\">10</span>);<br>        <span class=\"hljs-keyword\">return</span> threadPoolTaskScheduler;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>再次启动工程运行效果图如下图所示：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006102538612-370811990.png\" alt=\"image-20211006102536400\" loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"cron-表达式\">Cron 表达式<a title=\"#cron-表达式\" href=\"#cron-表达式\"></a></h1>\n<ul>\n<li><a href=\"https://qqe2.com/cron\" target=\"_blank\">https://qqe2.com/cron</a></li>\n<li><a href=\"https://cron.qqe2.com\" target=\"_blank\">https://cron.qqe2.com</a></li>\n</ul>\n<p>什么是 cron 表达式，一个 cron 表达式，最少有 5 个空格，来分割时间元素，Seconds Minutes Hours DayofMonth Month DayofWeek<br>\nYear，<code>Day-of-Month</code> 和 <code>Day-of-Week</code> 不可同时为 <code>*</code>。</p>\n<h2 id=\"组成\">组成<a title=\"#组成\" href=\"#组成\"></a></h2>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006103225757-965558881.png\" alt=\"image-20211006103223606\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"通配符\">通配符<a title=\"#通配符\" href=\"#通配符\"></a></h2>\n<ul>\n<li>,</li>\n</ul>\n<p>表示列出枚举值。例如：在 Minutes 域使用 5,20，则意味着在 5 和 20 分每分钟触发一次。</p>\n<ul>\n<li>*</li>\n</ul>\n<p>字符代表所有可能的值。* 在子表达式（月）里表示每个月的含义，* 在子表达式（日）表示每一天，在表达式（周）里表示星期的每一天，Day-of-Month<br>\n和 Day-of-Week 不可同时为 *。</p>\n<ul>\n<li>?</li>\n</ul>\n<p>表示不指定值。使用的场景为不需要关心当前设置这个字段的值，仅被用于（日）和（周）两个子表达式，表示不指定值当 2<br>\n个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为 “?”。</p>\n<ul>\n<li>/</li>\n</ul>\n<p>“/” 字符用来指定数值的增量，在子表达式（分钟）里的 “0/15” 表示从第 0 分钟开始，每 15 分钟，在子表达式（分钟）里的 “3/20” 表示从第<br>\n3 分钟开始，每 20 分钟，例如在周字段上设置 “MON,WED,FRI” 表示周一，周三和周五触发。</p>\n<ul>\n<li>-</li>\n</ul>\n<p>表示范围，例如在 Minutes 域使用 5-20，表示从 5 分到 20 分钟每分钟触发一次。</p>\n<ul>\n<li>L</li>\n</ul>\n<p>表示最后的意思，仅被用于（日）和（周）两个子表达式，它是单词 “last” 的缩写。在天（月）子表达式中，“L” 表示一个月的最后一天，在天（星期）自表达式中，“L”<br>\n表示一个星期的最后一天，如果在 “L” 前有具体的内容，表示这个月的倒数第几天，6L，最后一个星期五。</p>\n<ul>\n<li>W</li>\n</ul>\n<p>表示离指定日期的最近那个工作日(周一至周五)，例如在日字段上设置 “15W”，表示离每月 15 号最近的那个工作日触发。如果 15<br>\n号正好是周六，则找最近的周五，如果指定格式为 “1W”，它则表示每月 1 号往后最近的工作日触发。</p>\n<ul>\n<li>LW</li>\n</ul>\n<p>这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。</p>\n<ul>\n<li>#</li>\n</ul>\n<p>用于确定每个月第几个星期几，只能出现在 DayofMonth 域。例如 ”2#3” 表示在每月的第三个周二。</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006124848047-1144010330.png\" alt=\"image-20211006124843353\" loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"quartz-1\">QuartZ<a title=\"#quartz-1\" href=\"#quartz-1\"></a></h1>\n<p>官网：<a href=\"http://www.quartz-scheduler.org\" target=\"_blank\">http://www.quartz-scheduler.org</a></p>\n<p>引入依赖：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006140139830-256296137.png\" alt=\"image-20211006140137003\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-quartz<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<p>创建执行任务：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006135125775-351261616.png\" alt=\"image-20211006135125262\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> distributed-TimedTask</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/6 006 13:39</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyQuartzJob</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">QuartzJobBean</span> &#123;<br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">executeInternal</span><span class=\"hljs-params\">(JobExecutionContext context)</span> &#123;<br>        log.info(<span class=\"hljs-string\">&quot;MyQuartzJob任务执行！&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>添加配置：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006140938321-1333153964.png\" alt=\"image-20211006140935372\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> distributed-TimedTask</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/6 006 13:41</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Configuration</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyQuartJobConfig</span> &#123;<br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 可以持久化到数据库当中</span><br><span class=\"hljs-comment\">     * 多个实例共享一个数据时，就可以做到分布式</span><br><span class=\"hljs-comment\">     * 实例化自己定义的Job</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span> &#123;<span class=\"hljs-doctag\">@link</span> JobDetail&#125;</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-keyword\">public</span> JobDetail <span class=\"hljs-title function_\">jobDetail</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> JobBuilder.newJob(MyQuartzJob.class)<br>                .withIdentity(<span class=\"hljs-string\">&quot;job1&quot;</span>, <span class=\"hljs-string\">&quot;group1&quot;</span>)<br>                <span class=\"hljs-comment\">// 设置持久化</span><br>                .storeDurably()<br>                .build();<br>    &#125;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 创建触发器，触发实例</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span> &#123;<span class=\"hljs-doctag\">@link</span> Trigger&#125;</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-keyword\">public</span> Trigger <span class=\"hljs-title function_\">trigger</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> TriggerBuilder.newTrigger()<br>                .forJob(jobDetail())<br>                .withIdentity(<span class=\"hljs-string\">&quot;trigger1&quot;</span>, <span class=\"hljs-string\">&quot;group1&quot;</span>)<br>                <span class=\"hljs-comment\">// 立马启动</span><br>                .startNow()<br>                .withSchedule(CronScheduleBuilder.cronSchedule(<span class=\"hljs-string\">&quot;0,2 * * * * ?&quot;</span>))<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>再次启动工程运行效果图如下图所示：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006141031856-1412096563.png\" alt=\"image-20211006141031281\" loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"xxl-job-1\">xxl-job<a title=\"#xxl-job-1\" href=\"#xxl-job-1\"></a></h1>\n<h2 id=\"官网\">官网<a title=\"#官网\" href=\"#官网\"></a></h2>\n<ul>\n<li><a href=\"https://www.xuxueli.com/xxl-job\" target=\"_blank\">https://www.xuxueli.com/xxl-job</a></li>\n<li><a href=\"https://gitee.com/xuxueli0323/xxl-job\" target=\"_blank\">https://gitee.com/xuxueli0323/xxl-job</a></li>\n</ul>\n<h2 id=\"概述-1\">概述<a title=\"#概述-1\" href=\"#概述-1\"></a></h2>\n<p>xxl-job 是出自大众点评许雪里(xxl 就是作者名字的拼音首字母)，的开源项目，官网上介绍这是一个轻量级分布式任务调度框架，其核心设计目标是开发迅速、学习简单、轻量级、易扩展。跟<br>\nelasticjob 不同，xxl-job 环境依赖于 mysql，不用 ZooKeeper，这也是最大的不同。xxl-job 中心式的调度平台轻量级，开箱即用，操作简易，上手快，与<br>\nSpringBoot 有非常好的集成，而且监控界面就集成在调度中心，界面又简洁。对于企业维护起来成本不高，还有失败的邮件告警等等。这就使很多企业选择<br>\nxxl-job 做调度平台。</p>\n<h2 id=\"系统组成\">系统组成<a title=\"#系统组成\" href=\"#系统组成\"></a></h2>\n<h3 id=\"调度模块(调度中心)\">调度模块(调度中心)<a title=\"#调度模块(调度中心)\" href=\"#调度模块(调度中心)\"></a></h3>\n<p>负责管理调度信息，按照调度配置发出调度请求，自身不承担业务代码。调度系统与任务解耦，提高了系统可用性和稳定性，同时调度系统性能不再受限于任务模块。支持可视化、简单且动态的管理调度信息，包括任务新建，更新，删除，任务报警等，所有上述操作都会实时生效，同时支持监控调度结果以及执行日志，支持执行器<br>\nFailover。</p>\n<h3 id=\"执行模块(执行器)\">执行模块(执行器)<a title=\"#执行模块(执行器)\" href=\"#执行模块(执行器)\"></a></h3>\n<p>负责接收调度请求并执行任务逻辑。任务模块专注于任务的执行等操作，开发和维护更加简单和高效。接收 “调度中心” 的执行请求、终止请求和日志请求等。</p>\n<h2 id=\"功能架构图\">功能架构图<a title=\"#功能架构图\" href=\"#功能架构图\"></a></h2>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006143154948-48447780.png\" alt=\"image-20211006143151507\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"2-个角色\">2 个角色<a title=\"#2-个角色\" href=\"#2-个角色\"></a></h2>\n<p>调度任务管理系统，xxl-job-admin，创建任务、设置时间、集群，使用的策略、创建任务时会指定任务名称，地址。xxl-job-excutor，通常是我们业务系统，配置上调度系统的地址，创建任务，在任务上指定任务名称。</p>\n<h2 id=\"搭建调度中心\">搭建调度中心<a title=\"#搭建调度中心\" href=\"#搭建调度中心\"></a></h2>\n<p>下载源码：<a href=\"https://github.com/xuxueli/xxl-job/releases/tag/2.3.0\" target=\"_blank\">https://github.com/xuxueli/xxl-job/releases/tag/2.3.0</a></p>\n<p>执行 SQL，在下载源码当中的 <code>doc\\db\\tables_xxl_job.sql</code> 当然我也直接贴在了下方：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\">#<br># XXL<span class=\"hljs-operator\">-</span>JOB v2<span class=\"hljs-number\">.3</span><span class=\"hljs-number\">.0</span><br># Copyright (c) <span class=\"hljs-number\">2015</span><span class=\"hljs-operator\">-</span>present, xuxueli.<br><br><span class=\"hljs-keyword\">CREATE</span> database if <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">EXISTS</span> `xxl_job` <span class=\"hljs-keyword\">default</span> <span class=\"hljs-type\">character</span> <span class=\"hljs-keyword\">set</span> utf8mb4 <span class=\"hljs-keyword\">collate</span> utf8mb4_unicode_ci;<br>use `xxl_job`;<br><br><span class=\"hljs-keyword\">SET</span> NAMES utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_info`<br>(<br>    `id`                        <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)      <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT,<br>    `job_group`                 <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)      <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器主键ID&#x27;</span>,<br>    `job_desc`                  <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    `add_time`                  datetime              <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    `update_time`               datetime              <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    `author`                    <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">64</span>)           <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;作者&#x27;</span>,<br>    `alarm_email`               <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>)          <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;报警邮件&#x27;</span>,<br>    `schedule_type`             <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>)  <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;NONE&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;调度类型&#x27;</span>,<br>    `schedule_conf`             <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">128</span>)          <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;调度配置，值含义取决于调度类型&#x27;</span>,<br>    `misfire_strategy`          <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>)  <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;DO_NOTHING&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;调度过期策略&#x27;</span>,<br>    `executor_route_strategy`   <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>)           <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器路由策略&#x27;</span>,<br>    `executor_handler`          <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>)          <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器任务handler&#x27;</span>,<br>    `executor_param`            <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">512</span>)          <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器任务参数&#x27;</span>,<br>    `executor_block_strategy`   <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>)           <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;阻塞处理策略&#x27;</span>,<br>    `executor_timeout`          <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)      <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;任务执行超时时间，单位秒&#x27;</span>,<br>    `executor_fail_retry_count` <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)      <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;失败重试次数&#x27;</span>,<br>    `glue_type`                 <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>)  <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;GLUE类型&#x27;</span>,<br>    `glue_source`               mediumtext COMMENT <span class=\"hljs-string\">&#x27;GLUE源代码&#x27;</span>,<br>    `glue_remark`               <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">128</span>)          <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;GLUE备注&#x27;</span>,<br>    `glue_updatetime`           datetime              <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;GLUE更新时间&#x27;</span>,<br>    `child_jobid`               <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>)          <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;子任务ID，多个逗号分隔&#x27;</span>,<br>    `trigger_status`            tinyint(<span class=\"hljs-number\">4</span>)   <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;调度状态：0-停止，1-运行&#x27;</span>,<br>    `trigger_last_time`         <span class=\"hljs-type\">bigint</span>(<span class=\"hljs-number\">13</span>)   <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;上次调度时间&#x27;</span>,<br>    `trigger_next_time`         <span class=\"hljs-type\">bigint</span>(<span class=\"hljs-number\">13</span>)   <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;下次调度时间&#x27;</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`id`)<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_log`<br>(<br>    `id`                        <span class=\"hljs-type\">bigint</span>(<span class=\"hljs-number\">20</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT,<br>    `job_group`                 <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)    <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器主键ID&#x27;</span>,<br>    `job_id`                    <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)    <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;任务，主键ID&#x27;</span>,<br>    `executor_address`          <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>)        <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器地址，本次执行的地址&#x27;</span>,<br>    `executor_handler`          <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>)        <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器任务handler&#x27;</span>,<br>    `executor_param`            <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">512</span>)        <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器任务参数&#x27;</span>,<br>    `executor_sharding_param`   <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">20</span>)         <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器任务分片参数，格式如 1/2&#x27;</span>,<br>    `executor_fail_retry_count` <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)    <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;失败重试次数&#x27;</span>,<br>    `trigger_time`              datetime            <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;调度-时间&#x27;</span>,<br>    `trigger_code`              <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)    <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;调度-结果&#x27;</span>,<br>    `trigger_msg`               text COMMENT <span class=\"hljs-string\">&#x27;调度-日志&#x27;</span>,<br>    `handle_time`               datetime            <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行-时间&#x27;</span>,<br>    `handle_code`               <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)    <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行-状态&#x27;</span>,<br>    `handle_msg`                text COMMENT <span class=\"hljs-string\">&#x27;执行-日志&#x27;</span>,<br>    `alarm_status`              tinyint(<span class=\"hljs-number\">4</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;告警状态：0-默认、1-无需告警、2-告警成功、3-告警失败&#x27;</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`id`),<br>    KEY `I_trigger_time` (`trigger_time`),<br>    KEY `I_handle_code` (`handle_code`)<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_log_report`<br>(<br>    `id`            <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT,<br>    `trigger_day`   datetime         <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;调度-时间&#x27;</span>,<br>    `running_count` <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;运行中-日志数量&#x27;</span>,<br>    `suc_count`     <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;执行成功-日志数量&#x27;</span>,<br>    `fail_count`    <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;执行失败-日志数量&#x27;</span>,<br>    `update_time`   datetime         <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`id`),<br>    <span class=\"hljs-keyword\">UNIQUE</span> KEY `i_trigger_day` (`trigger_day`) <span class=\"hljs-keyword\">USING</span> BTREE<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_logglue`<br>(<br>    `id`          <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)      <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT,<br>    `job_id`      <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)      <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;任务，主键ID&#x27;</span>,<br>    `glue_type`   <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>) <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;GLUE类型&#x27;</span>,<br>    `glue_source` mediumtext COMMENT <span class=\"hljs-string\">&#x27;GLUE源代码&#x27;</span>,<br>    `glue_remark` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">128</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;GLUE备注&#x27;</span>,<br>    `add_time`    datetime    <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    `update_time` datetime    <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`id`)<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_registry`<br>(<br>    `id`             <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)      <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT,<br>    `registry_group` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>)  <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    `registry_key`   <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    `registry_value` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    `update_time`    datetime <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`id`),<br>    KEY `i_g_k_v` (`registry_group`, `registry_key`, `registry_value`)<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_group`<br>(<br>    `id`           <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)     <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT,<br>    `app_name`     <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">64</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器AppName&#x27;</span>,<br>    `title`        <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">12</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;执行器名称&#x27;</span>,<br>    `address_type` tinyint(<span class=\"hljs-number\">4</span>)  <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&#x27;0&#x27;</span> COMMENT <span class=\"hljs-string\">&#x27;执行器地址类型：0=自动注册、1=手动录入&#x27;</span>,<br>    `address_list` text COMMENT <span class=\"hljs-string\">&#x27;执行器地址列表，多地址逗号分隔&#x27;</span>,<br>    `update_time`  datetime             <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`id`)<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_user`<br>(<br>    `id`         <span class=\"hljs-type\">int</span>(<span class=\"hljs-number\">11</span>)     <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> AUTO_INCREMENT,<br>    `username`   <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;账号&#x27;</span>,<br>    `password`   <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;密码&#x27;</span>,<br>    `role`       tinyint(<span class=\"hljs-number\">4</span>)  <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;角色：0-普通用户、1-管理员&#x27;</span>,<br>    `permission` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;权限：执行器ID列表，多个逗号分割&#x27;</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`id`),<br>    <span class=\"hljs-keyword\">UNIQUE</span> KEY `i_username` (`username`) <span class=\"hljs-keyword\">USING</span> BTREE<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> `xxl_job_lock`<br>(<br>    `lock_name` <span class=\"hljs-type\">varchar</span>(<span class=\"hljs-number\">50</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;锁名称&#x27;</span>,<br>    <span class=\"hljs-keyword\">PRIMARY</span> KEY (`lock_name`)<br>) ENGINE <span class=\"hljs-operator\">=</span> InnoDB<br>  <span class=\"hljs-keyword\">DEFAULT</span> CHARSET <span class=\"hljs-operator\">=</span> utf8mb4;<br><br><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> `xxl_job_group`(`id`, `app_name`, `title`, `address_type`, `address_list`, `update_time`)<br><span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;xxl-job-executor-sample&#x27;</span>, <span class=\"hljs-string\">&#x27;示例执行器&#x27;</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-keyword\">NULL</span>, <span class=\"hljs-string\">&#x27;2018-11-03 22:21:31&#x27;</span>);<br><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> `xxl_job_info`(`id`, `job_group`, `job_desc`, `add_time`, `update_time`, `author`, `alarm_email`,<br>                           `schedule_type`, `schedule_conf`, `misfire_strategy`, `executor_route_strategy`,<br>                           `executor_handler`, `executor_param`, `executor_block_strategy`, `executor_timeout`,<br>                           `executor_fail_retry_count`, `glue_type`, `glue_source`, `glue_remark`, `glue_updatetime`,<br>                           `child_jobid`)<br><span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;测试任务1&#x27;</span>, <span class=\"hljs-string\">&#x27;2018-11-03 22:21:31&#x27;</span>, <span class=\"hljs-string\">&#x27;2018-11-03 22:21:31&#x27;</span>, <span class=\"hljs-string\">&#x27;XXL&#x27;</span>, <span class=\"hljs-string\">&#x27;&#x27;</span>, <span class=\"hljs-string\">&#x27;CRON&#x27;</span>, <span class=\"hljs-string\">&#x27;0 0 0 * * ? *&#x27;</span>,<br>        <span class=\"hljs-string\">&#x27;DO_NOTHING&#x27;</span>, <span class=\"hljs-string\">&#x27;FIRST&#x27;</span>, <span class=\"hljs-string\">&#x27;demoJobHandler&#x27;</span>, <span class=\"hljs-string\">&#x27;&#x27;</span>, <span class=\"hljs-string\">&#x27;SERIAL_EXECUTION&#x27;</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-string\">&#x27;BEAN&#x27;</span>, <span class=\"hljs-string\">&#x27;&#x27;</span>, <span class=\"hljs-string\">&#x27;GLUE代码初始化&#x27;</span>,<br>        <span class=\"hljs-string\">&#x27;2018-11-03 22:21:31&#x27;</span>, <span class=\"hljs-string\">&#x27;&#x27;</span>);<br><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> `xxl_job_user`(`id`, `username`, `password`, `role`, `permission`)<br><span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;admin&#x27;</span>, <span class=\"hljs-string\">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-keyword\">NULL</span>);<br><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> `xxl_job_lock` (`lock_name`)<br><span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-string\">&#x27;schedule_lock&#x27;</span>);<br><br><span class=\"hljs-keyword\">commit</span>;<br></code></pre></td></tr></table></figure>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006144542748-604331317.png\" alt=\"image-20211006144542308\" loading=\"lazy\" class=\"φbp\"></p>\n<p>修改 xxl-job-admin 项目当中的 <code>appication.properties</code> 配置把当中的数据库信息改为自己的数据库信息即可如下：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006143955758-408465482.png\" alt=\"image-20211006143952874\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006144027063-747248944.png\" alt=\"image-20211006144026467\" loading=\"lazy\" class=\"φbp\"></p>\n<p>切换到 xxl-job-admin 目录当中打包，打包命令如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">mvn clean -U package -Dmaven.test.skip=<span class=\"hljs-literal\">true</span><br></code></pre></td></tr></table></figure>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006144233487-1893497166.png\" alt=\"image-20211006144232995\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006144312227-331571218.png\" alt=\"image-20211006144311803\" loading=\"lazy\" class=\"φbp\"></p>\n<p>切换到 target 目录当中启动：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs bash\">java -jar xxl-job-admin-2.3.0.jar --server.port=8088<br></code></pre></td></tr></table></figure>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006144411151-1370693423.png\" alt=\"image-20211006144410658\" loading=\"lazy\" class=\"φbp\"></p>\n<p>启动之后再浏览器当中访问：<a href=\"http://localhost:8088/xxl-job-admin/toLogin\" target=\"_blank\">http://localhost:8088/xxl-job-admin/toLogin</a> 默认的用户名密码为：admin/123456。</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006145005789-1027611149.png\" alt=\"image-20211006145004871\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"调度任务执行流程\">调度任务执行流程<a title=\"#调度任务执行流程\" href=\"#调度任务执行流程\"></a></h2>\n<p>启动 xxl-job-admin 调度模块，直接运行，xxl-job-excuotr 需要配置 xxl-job-admin 的地址，主动向 xxl-job-admin 注册。</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006145222818-374297575.png\" alt=\"image-20211006145222225\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"执行器操作\">执行器操作<a title=\"#执行器操作\" href=\"#执行器操作\"></a></h2>\n<p>创建 SpringBoot 工程，利用初始化器创建不贴图。</p>\n<p>导入依赖：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">parent</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.5.5<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">relativePath</span>/&gt;</span> <span class=\"hljs-comment\">&lt;!-- lookup parent from repository --&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">parent</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.projectlombok<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>lombok<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">optional</span>&gt;</span>true<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">optional</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.xuxueli<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>xxl-job-core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.3.0<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<p>修改配置文件添加 xxl-job 相关配置：</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs yaml\"><span class=\"hljs-attr\">server:</span><br>  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">8080</span><br><span class=\"hljs-attr\">xxl:</span><br>  <span class=\"hljs-attr\">job:</span><br>    <span class=\"hljs-attr\">admin:</span><br>      <span class=\"hljs-attr\">addresses:</span> <span class=\"hljs-string\">http://localhost:8088/xxl-job-admin/</span><br>    <span class=\"hljs-attr\">executor:</span><br>      <span class=\"hljs-attr\">appName:</span> <span class=\"hljs-string\">xxl-job</span><br>      <span class=\"hljs-attr\">logPath:</span> <span class=\"hljs-string\">D:\\Log</span><br></code></pre></td></tr></table></figure>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006161427851-526718480.png\" alt=\"image-20211006161424855\" loading=\"lazy\" class=\"φbp\"></p>\n<p>创建配置类 XxlJobConfig.java：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * xxl-job配置</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> 30315</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@date</span> 2021/10/04</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">XxlJobConfig</span> &#123;<br>    <span class=\"hljs-meta\">@Value(&quot;$&#123;xxl.job.admin.addresses&#125;&quot;)</span><br>    <span class=\"hljs-keyword\">private</span> String adminAddresses;<br>    <span class=\"hljs-meta\">@Value(&quot;$&#123;xxl.job.executor.appName&#125;&quot;)</span><br>    <span class=\"hljs-keyword\">private</span> String appName;<br>    <span class=\"hljs-meta\">@Value(&quot;$&#123;xxl.job.executor.logPath&#125;&quot;)</span><br>    <span class=\"hljs-keyword\">private</span> String logPath;<br><br>    <span class=\"hljs-meta\">@Bean</span><br>    <span class=\"hljs-keyword\">public</span> XxlJobSpringExecutor <span class=\"hljs-title function_\">xxlJobExecutor</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-type\">XxlJobSpringExecutor</span> <span class=\"hljs-variable\">xxlJobSpringExecutor</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">XxlJobSpringExecutor</span>();<br>        xxlJobSpringExecutor.setAdminAddresses(adminAddresses);<br>        xxlJobSpringExecutor.setAppname(appName);<br>        xxlJobSpringExecutor.setLogPath(logPath);<br>        <span class=\"hljs-keyword\">return</span> xxlJobSpringExecutor;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>在调度中心创建执行器与任务，在执行器管理当中创建执行器：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006170004690-1343398907.png\" alt=\"image-20211006170000209\" loading=\"lazy\" class=\"φbp\"></p>\n<p>执行器的名称要和配置文件当中的 appName 名称一样：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006170108364-175124203.png\" alt=\"image-20211006170107778\" loading=\"lazy\" class=\"φbp\"></p>\n<p>然后在切换到任务管理，创建任务：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006170259509-1366300403.png\" alt=\"image-20211006170258729\" loading=\"lazy\" class=\"φbp\"></p>\n<p>在程序当中创建任务：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006170753725-856405920.png\" alt=\"image-20211006170753107\" loading=\"lazy\" class=\"φbp\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@project</span> xxl-job-project</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span></span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> Created in 2021/10/4 004 20:52</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyJob</span> &#123;<br>    <span class=\"hljs-meta\">@XxlJob(&quot;myJobHandler&quot;)</span><br>    <span class=\"hljs-keyword\">public</span> ReturnT&lt;String&gt; <span class=\"hljs-title function_\">execute</span><span class=\"hljs-params\">()</span> &#123;<br>        log.info(<span class=\"hljs-string\">&quot;myJobHandler execute!&quot;</span>);<br>        XxlJobHelper.log(<span class=\"hljs-string\">&quot;myJobHandler execute!&quot;</span>);<br>        <span class=\"hljs-keyword\">return</span> ReturnT.SUCCESS;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>启动任务，当然在启动任务的同时程序也要启动起来：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006171103949-114225542.png\" alt=\"image-20211006171103290\" loading=\"lazy\" class=\"φbp\"></p>\n<p>运行效果需要根据你任务的 Cron 表达式的时间来定啦，我这里不贴图你自行测试。</p>\n<h2 id=\"路径策略\">路径策略<a title=\"#路径策略\" href=\"#路径策略\"></a></h2>\n<p>就是一个负载均衡，当只有一个任务调度中心，有多个执行器的时候，任务调度中心要选择一个或多个执行器来执行任务。</p>\n<p>对项目进行集群部署：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006171422536-258984853.png\" alt=\"image-20211006171421827\" loading=\"lazy\" class=\"φbp\"></p>\n<p>修改配置文件当中的端口号然后在启动一个项目即可搭建多个服务的集群，效果如下：</p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006171615627-334063012.png\" alt=\"image-20211006171614932\" loading=\"lazy\" class=\"φbp\"></p>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006171656727-671567187.png\" alt=\"image-20211006171656096\" loading=\"lazy\" class=\"φbp\"></p>\n<h3 id=\"策略详解\">策略详解<a title=\"#策略详解\" href=\"#策略详解\"></a></h3>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006171820676-2115511159.png\" alt=\"image-20211006171820017\" loading=\"lazy\" class=\"φbp\"></p>\n<p>一般使用 <code>故障转移</code>，当一台机器出现故障时，转移到另一台机器上，这个故障转移的效果需要自己搭建一个集群的服务，然后，你把集群当中正在运行任务的服务关闭之后<br>\nxxl-job 会自行的进行转移到另外一台服务器上进行运行任务。</p>\n<p>分片策略：</p>\n<ul>\n<li>XxlJobHelper.getShardIndex(); 获取当前调度器的序号</li>\n<li>XxlJobHelper.getShardTotal(); 获取总机器数量</li>\n</ul>\n<p>修改 MyJob.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyJob</span> &#123;<br>    <span class=\"hljs-meta\">@XxlJob(&quot;myJobHandler&quot;)</span><br>    <span class=\"hljs-keyword\">public</span> ReturnT&lt;String&gt; <span class=\"hljs-title function_\">execute</span><span class=\"hljs-params\">()</span> &#123;<br>        List&lt;Integer&gt; users = Arrays.asList(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>, <span class=\"hljs-number\">4</span>, <span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">6</span>);<br>        users.forEach(u -&gt; &#123;<br>            <span class=\"hljs-keyword\">if</span> (u % XxlJobHelper.getShardTotal() == XxlJobHelper.getShardIndex()) &#123;<br>                log.info(<span class=\"hljs-string\">&quot;发短信操作 &gt;&gt;&gt; user=&#123;&#125;，index=&#123;&#125;，total=&#123;&#125;&quot;</span>,<br>                        u, XxlJobHelper.getShardIndex(), XxlJobHelper.getShardTotal());<br>            &#125;<br>        &#125;);<br>        <span class=\"hljs-keyword\">return</span> ReturnT.SUCCESS;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p><img src=\"https://img2020.cnblogs.com/blog/2105804/202110/2105804-20211006200936989-543006492.png\" alt=\"image-20211006200933004\" loading=\"lazy\" class=\"φbp\"></p>\n<h2 id=\"阻塞处理策略\">阻塞处理策略<a title=\"#阻塞处理策略\" href=\"#阻塞处理策略\"></a></h2>\n<ul>\n<li>单机串行</li>\n<li>丢弃后续调度</li>\n<li>覆盖之前调度</li>\n</ul>\n<p>获取任务传递的，<strong>任务参数</strong>，代码如下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Component</span><br><span class=\"hljs-meta\">@Slf4j</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyJob</span> &#123;<br>    <span class=\"hljs-meta\">@XxlJob(&quot;myJobHandler&quot;)</span><br>    <span class=\"hljs-keyword\">public</span> ReturnT&lt;String&gt; <span class=\"hljs-title function_\">execute</span><span class=\"hljs-params\">()</span> &#123;<br>        log.info(<span class=\"hljs-string\">&quot;myJobHandler execute...&quot;</span>);<br>        log.info(<span class=\"hljs-string\">&quot;参数=&#123;&#125;&quot;</span>, XxlJobHelper.getJobParam());<br>        <span class=\"hljs-keyword\">try</span> &#123;<br>            Thread.sleep(<span class=\"hljs-number\">5000</span>);<br>        &#125; <span class=\"hljs-keyword\">catch</span> (InterruptedException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        XxlJobHelper.log(<span class=\"hljs-string\">&quot;myJobHandler execute...&quot;</span>);<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ReturnT</span>&lt;&gt;(<span class=\"hljs-number\">200</span>, <span class=\"hljs-string\">&quot;【执行成功】&quot;</span> + <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Date</span>());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>","prev":{"title":"Java","link":"2022/09/24/代码习惯/01-Java"},"next":{"title":"账号","link":"2022/09/23/JetBrains/03-账号"},"plink":"http://example.com/2022/09/23/分布式/01-分布式定时任务/","toc":[{"id":"任务调度场景","title":"任务调度场景","index":"1","children":[{"id":"概述","title":"概述","index":"1.1"},{"id":"时间驱动的场景","title":"时间驱动的场景","index":"1.2"},{"id":"批量处理数据","title":"批量处理数据","index":"1.3"},{"id":"固定频率的场景","title":"固定频率的场景","index":"1.4"}]},{"id":"为什么需要任务调度平台","title":"为什么需要任务调度平台","index":"2"},{"id":"什么是分布式任务调度","title":"什么是分布式任务调度","index":"3"},{"id":"任务调度框架","title":"任务调度框架","index":"4","children":[{"id":"非分布式","title":"非分布式","index":"4.1"},{"id":"分布式","title":"分布式","index":"4.2","children":[{"id":"quartz","title":"Quartz","index":"4.2.1"},{"id":"elasticjob","title":"Elasticjob","index":"4.2.2"},{"id":"xxl-job","title":"xxl-job","index":"4.2.3"},{"id":"schedulerx","title":"SchedulerX","index":"4.2.4"},{"id":"powerjob","title":"PowerJob","index":"4.2.5"}]}]},{"id":"@scheduled","title":"@Scheduled","index":"5","children":[{"id":"异步任务调度","title":"异步任务调度","index":"5.1","children":[{"id":"开启异步调度","title":"开启异步调度","index":"5.1.1"},{"id":"创建异步任务","title":"创建异步任务","index":"5.1.2"},{"id":"调用异步任务","title":"调用异步任务","index":"5.1.3"}]},{"id":"开启多线程执行","title":"开启多线程执行","index":"5.2"}]},{"id":"cron-表达式","title":"Cron 表达式","index":"6","children":[{"id":"组成","title":"组成","index":"6.1"},{"id":"通配符","title":"通配符","index":"6.2"}]},{"id":"quartz-1","title":"QuartZ","index":"7"},{"id":"xxl-job-1","title":"xxl-job","index":"8","children":[{"id":"官网","title":"官网","index":"8.1"},{"id":"概述-1","title":"概述","index":"8.2"},{"id":"系统组成","title":"系统组成","index":"8.3","children":[{"id":"调度模块(调度中心)","title":"调度模块(调度中心)","index":"8.3.1"},{"id":"执行模块(执行器)","title":"执行模块(执行器)","index":"8.3.2"}]},{"id":"功能架构图","title":"功能架构图","index":"8.4"},{"id":"2-个角色","title":"2 个角色","index":"8.5"},{"id":"搭建调度中心","title":"搭建调度中心","index":"8.6"},{"id":"调度任务执行流程","title":"调度任务执行流程","index":"8.7"},{"id":"执行器操作","title":"执行器操作","index":"8.8"},{"id":"路径策略","title":"路径策略","index":"8.9","children":[{"id":"策略详解","title":"策略详解","index":"8.9.1"}]},{"id":"阻塞处理策略","title":"阻塞处理策略","index":"8.10"}]}],"reading_time":"5325 words in 36 min"}