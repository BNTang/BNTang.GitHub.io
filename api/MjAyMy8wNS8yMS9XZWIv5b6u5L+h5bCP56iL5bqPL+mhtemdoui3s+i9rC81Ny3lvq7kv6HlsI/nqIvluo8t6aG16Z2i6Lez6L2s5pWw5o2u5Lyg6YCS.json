{"title":"微信小程序-页面跳转数据传递","date":"2023-05-21T07:40:53.000Z","date_formatted":{"ll":"May 21, 2023","L":"05/21/2023","MM-DD":"05-21"},"link":"2023/05/21/Web/微信小程序/页面跳转/57-微信小程序-页面跳转数据传递","tags":["微信小程序"],"updated":"2023-05-21T15:22:35.397Z","content":"<p>在之前的文章当中我们都实现了一个功能就是可以从上一个页面传递数据给下一个页面，那么我们能不能从下一个页面传递数据给上一个页面呢，答案是可以的。</p>\n<p>所以说本文这次主要介绍的内容就是返回上一个页面时传递参数给上一个页面的两种方式。</p>\n<h1 id=\"方式一\">方式一<a title=\"#方式一\" href=\"#方式一\"></a></h1>\n<p>本质是拿到上一个页面对象，直接修改了上一个页面对象 data 中数据, 更改日志页面的逻辑文件然后，获取到所有的页面从中获取到需要返回的页面，得到对象实例之后通过实例对象更改数据：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-comment\">// logs.js</span><br><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onLoad</span>(<span class=\"hljs-params\">options</span>) &#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(options);<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(options.<span class=\"hljs-property\">name</span>);<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(options.<span class=\"hljs-property\">age</span>);<br>  &#125;,<br>  <span class=\"hljs-title function_\">myNavigatorBack</span>(<span class=\"hljs-params\"></span>) &#123;<br>    wx.<span class=\"hljs-title function_\">navigateBack</span>(&#123;&#125;)<br><br>    <span class=\"hljs-keyword\">let</span> pages = <span class=\"hljs-title function_\">getCurrentPages</span>();<br>    <span class=\"hljs-keyword\">let</span> backPage = pages[pages.<span class=\"hljs-property\">length</span> -<span class=\"hljs-number\">2</span>];<br>    backPage.<span class=\"hljs-title function_\">setData</span>(&#123;<span class=\"hljs-attr\">message</span>: <span class=\"hljs-string\">&quot;我是BNTang&quot;</span>&#125;);<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>\n<p>首页的 WXML：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs wxml\">&lt;!--index.wxml--&gt;<br>&lt;text&gt;首页&lt;/text&gt;<br>&lt;text&gt;&#123;&#123;message&#125;&#125;&lt;/text&gt;<br>&lt;button bindtap=&quot;toLog&quot;&gt;跳转到日志页面&lt;/button&gt;<br></code></pre></td></tr></table></figure>\n<h1 id=\"方式二\">方式二<a title=\"#方式二\" href=\"#方式二\"></a></h1>\n<p>?&gt; 本质就是触发自定义事件，通过事件参数传递数据</p>\n<p>跳转到下一个页面的时候，传递一个自定义事件给下一个页面：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-comment\">// index.js</span><br><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-attr\">data</span>: &#123;<br>    <span class=\"hljs-attr\">message</span>: <span class=\"hljs-string\">&quot;BNTang&quot;</span><br>  &#125;,<br>  <span class=\"hljs-title function_\">toLog</span>(<span class=\"hljs-params\"></span>) &#123;<br>    wx.<span class=\"hljs-title function_\">navigateTo</span>(&#123;<br>      <span class=\"hljs-attr\">url</span>: <span class=\"hljs-string\">&#x27;/pages/logs/logs?name=BNTang&amp;age=18&#x27;</span>,<br><br>      <span class=\"hljs-attr\">events</span>: &#123;<br>        <span class=\"hljs-title function_\">abc</span>(<span class=\"hljs-params\">data</span>) &#123;<br>          <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;自定义事件中：&quot;</span> + data);<br>        &#125;<br>      &#125;<br>    &#125;)<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>\n<p>日志页面的 js 文件内容：</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-comment\">// logs.js</span><br><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-title function_\">onLoad</span>(<span class=\"hljs-params\">options</span>) &#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(options);<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(options.<span class=\"hljs-property\">name</span>);<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(options.<span class=\"hljs-property\">age</span>);<br>  &#125;,<br>  <span class=\"hljs-title function_\">myNavigatorBack</span>(<span class=\"hljs-params\"></span>) &#123;<br>    wx.<span class=\"hljs-title function_\">navigateBack</span>(&#123;&#125;)<br>      <br>    <span class=\"hljs-keyword\">let</span> eventChannel = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">getOpenerEventChannel</span>();<br>    eventChannel.<span class=\"hljs-title function_\">emit</span>(<span class=\"hljs-string\">&quot;abc&quot;</span>, &#123;<span class=\"hljs-attr\">msg</span>: <span class=\"hljs-string\">&quot;我是BNTang&quot;</span>&#125;);<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>","prev":{"title":"微信小程序-常用弹窗","link":"2023/05/21/Web/微信小程序/微信小程序api/界面/交互/58-微信小程序-常用弹窗"},"next":{"title":"微信小程序-页面跳转wxAPI","link":"2023/05/21/Web/微信小程序/页面跳转/56-微信小程序-页面跳转wxAPI"},"plink":"http://example.com/2023/05/21/Web/微信小程序/页面跳转/57-微信小程序-页面跳转数据传递/","toc":[{"id":"方式一","title":"方式一","index":"1"},{"id":"方式二","title":"方式二","index":"2"}],"reading_time":"416 words in 3 min"}