{"title":"ã€ŒDartã€å¼‚æ­¥ç¼–ç¨‹","date":"2023-12-28T16:30:25.000Z","date_formatted":{"ll":"Dec 29, 2023","L":"12/29/2023","MM-DD":"12-29"},"link":"2023/12/29/Flutter/13-ã€ŒDartã€å¼‚æ­¥ç¼–ç¨‹","tags":["Dart"],"updated":"2024-01-09T05:51:10.857Z","content":"<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231229003124246-216433052.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n<h1 id=\"å‰è¨€\">å‰è¨€<a title=\"#å‰è¨€\" href=\"#å‰è¨€\"></a></h1>\n<ul>\n<li>åœ¨ JavaScript å’Œ Dart ä¸­ï¼Œå¼‚æ­¥ç¼–ç¨‹æ˜¯ä¸€ä¸ª <code>éå¸¸é‡è¦</code> çš„æ¦‚å¿µ</li>\n<li>æˆ‘å°†é€šè¿‡ä¸€äº›åŸºæœ¬çš„å¼‚æ­¥ç¼–ç¨‹ç¤ºä¾‹æ¥å±•ç¤ºä¸¤ç§è¯­è¨€çš„å¼‚åŒ</li>\n</ul>\n<h1 id=\"å¼‚æ­¥å‡½æ•°ï¼ˆasync-functionsï¼‰\">å¼‚æ­¥å‡½æ•°ï¼ˆAsync Functionsï¼‰<a title=\"#å¼‚æ­¥å‡½æ•°ï¼ˆasync-functionsï¼‰\" href=\"#å¼‚æ­¥å‡½æ•°ï¼ˆasync-functionsï¼‰\"></a></h1>\n<h2 id=\"javascript\">JavaScript<a title=\"#javascript\" href=\"#javascript\"></a></h2>\n<p>åœ¨ JavaScript ä¸­ï¼Œå¼‚æ­¥å‡½æ•°é€šå¸¸é€šè¿‡ <code>async</code> å…³é”®å­—å’Œ <code>await</code> è¡¨è¾¾å¼æ¥å®ç°ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fetchData</span>(<span class=\"hljs-params\"></span>) &#123;<br>    <span class=\"hljs-keyword\">let</span> response = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">fetch</span>(<span class=\"hljs-string\">&#x27;https://api.example.com/data&#x27;</span>);<br>    <span class=\"hljs-keyword\">let</span> data = <span class=\"hljs-keyword\">await</span> response.<span class=\"hljs-title function_\">json</span>();<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(data);<br>&#125;<br><br><span class=\"hljs-title function_\">fetchData</span>();<br></code></pre></td></tr></table></figure>\n<h2 id=\"dart\">Dart<a title=\"#dart\" href=\"#dart\"></a></h2>\n<p>Dart ä¹Ÿä½¿ç”¨ <code>async</code> å’Œ <code>await</code> å…³é”®å­—æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚</p>\n<figure class=\"highlight dart\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs dart\">Future&lt;<span class=\"hljs-keyword\">void</span>&gt; fetchData() <span class=\"hljs-keyword\">async</span> &#123;<br>    <span class=\"hljs-keyword\">var</span> response = <span class=\"hljs-keyword\">await</span> http.<span class=\"hljs-keyword\">get</span>(<span class=\"hljs-built_in\">Uri</span>.parse(<span class=\"hljs-string\">&#x27;https://api.example.com/data&#x27;</span>));<br>    <span class=\"hljs-keyword\">var</span> data = jsonDecode(response.body);<br>    <span class=\"hljs-built_in\">print</span>(data);<br>&#125;<br><br><span class=\"hljs-keyword\">void</span> main() &#123;<br>    fetchData();<br>&#125;<br></code></pre></td></tr></table></figure>\n<h2 id=\"å¼‚åŒç‚¹\">å¼‚åŒç‚¹<a title=\"#å¼‚åŒç‚¹\" href=\"#å¼‚åŒç‚¹\"></a></h2>\n<ul>\n<li>ä¸¤ç§è¯­è¨€éƒ½ä½¿ç”¨ <code>async</code> å’Œ <code>await</code> å…³é”®å­—ã€‚</li>\n<li>Dart éœ€è¦ä½¿ç”¨ <code>Future</code> ç±»å‹æ¥è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ç»“æœã€‚</li>\n</ul>\n<h1 id=\"äº‹ä»¶å¾ªç¯å’Œå¼‚æ­¥å›è°ƒ\">äº‹ä»¶å¾ªç¯å’Œå¼‚æ­¥å›è°ƒ<a title=\"#äº‹ä»¶å¾ªç¯å’Œå¼‚æ­¥å›è°ƒ\" href=\"#äº‹ä»¶å¾ªç¯å’Œå¼‚æ­¥å›è°ƒ\"></a></h1>\n<h2 id=\"javascript-1\">JavaScript<a title=\"#javascript-1\" href=\"#javascript-1\"></a></h2>\n<p>JavaScript ä¾èµ–äºäº‹ä»¶å¾ªç¯å’Œå›è°ƒå‡½æ•°æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;Start&#x27;</span>);<br><br><span class=\"hljs-built_in\">setTimeout</span>(<span class=\"hljs-function\">() =&gt;</span> &#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;Inside timeout&#x27;</span>);<br>&#125;, <span class=\"hljs-number\">1000</span>);<br><br><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;End&#x27;</span>);<br></code></pre></td></tr></table></figure>\n<h2 id=\"dart-1\">Dart<a title=\"#dart-1\" href=\"#dart-1\"></a></h2>\n<p>Dart åŒæ ·æœ‰äº‹ä»¶å¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œã€‚</p>\n<figure class=\"highlight dart\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs dart\"><span class=\"hljs-keyword\">void</span> main() &#123;<br>    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&#x27;Start&#x27;</span>);<br><br>    Future.delayed(<span class=\"hljs-built_in\">Duration</span>(seconds: <span class=\"hljs-number\">1</span>), () &#123;<br>        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&#x27;Inside timeout&#x27;</span>);<br>    &#125;);<br><br>    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&#x27;End&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>\n<h2 id=\"å¼‚åŒç‚¹-1\">å¼‚åŒç‚¹<a title=\"#å¼‚åŒç‚¹-1\" href=\"#å¼‚åŒç‚¹-1\"></a></h2>\n<ul>\n<li>ä¸¤ç§è¯­è¨€éƒ½æœ‰äº‹ä»¶å¾ªç¯çš„æ¦‚å¿µã€‚</li>\n<li>JavaScript ä½¿ç”¨ <code>setTimeout</code>ï¼ŒDart ä½¿ç”¨ <code>Future.delayed</code>ã€‚</li>\n<li>ä¸¤è€…åœ¨è¯­æ³•ä¸Šç•¥æœ‰å·®å¼‚ï¼Œä½†æ¦‚å¿µç›¸ä¼¼ã€‚</li>\n</ul>\n<h1 id=\"future\">Future<a title=\"#future\" href=\"#future\"></a></h1>\n<p>åœ¨ Dart ä¸­ï¼Œ<code>Future</code> æ˜¯ä¸€ä¸ªæ ¸å¿ƒç±»ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœã€‚å®ƒä¸ JavaScript ä¸­çš„ <code>Promise</code> ç›¸ä¼¼ï¼Œä»£è¡¨ä¸€ä¸ªå¯èƒ½åœ¨æœªæ¥æŸä¸ªæ—¶åˆ»æ‰ä¼šå®Œæˆçš„è®¡ç®—ã€‚å½“å¼‚æ­¥æ“ä½œå®Œæˆæ—¶ï¼Œ<code>Future</code> è¦ä¹ˆæˆåŠŸè¿”å›ä¸€ä¸ªå€¼ï¼Œè¦ä¹ˆæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>\n<h2 id=\"åŸºæœ¬æ¦‚å¿µ\">åŸºæœ¬æ¦‚å¿µ<a title=\"#åŸºæœ¬æ¦‚å¿µ\" href=\"#åŸºæœ¬æ¦‚å¿µ\"></a></h2>\n<ul>\n<li><strong>Future</strong>: ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªå€¼æˆ–é”™è¯¯ã€‚</li>\n<li><strong>then()</strong>: å½“ <code>Future</code> å®Œæˆæ—¶ï¼Œ<code>then()</code> æ–¹æ³•è¢«è°ƒç”¨ï¼Œç”¨äºå¤„ç†è¿”å›çš„å€¼ã€‚</li>\n<li><strong>catchError()</strong>: ç”¨äºå¤„ç† <code>Future</code> æŠ›å‡ºçš„é”™è¯¯ã€‚</li>\n<li><strong>await</strong>: åœ¨ <code>async</code> å‡½æ•°ä¸­ä½¿ç”¨ï¼Œç­‰å¾… <code>Future</code> å®Œæˆå¹¶è·å–å…¶ç»“æœã€‚</li>\n<li><strong>async</strong>: æ ‡è®°ä¸€ä¸ªå‡½æ•°ä¸ºå¼‚æ­¥å‡½æ•°ï¼Œå…è®¸åœ¨å‡½æ•°å†…ä½¿ç”¨ <code>await</code>ã€‚</li>\n</ul>\n<h2 id=\"ç¤ºä¾‹ä»£ç \">ç¤ºä¾‹ä»£ç <a title=\"#ç¤ºä¾‹ä»£ç \" href=\"#ç¤ºä¾‹ä»£ç \"></a></h2>\n<p>åˆ›å»ºå’Œä½¿ç”¨ Futureï¼š</p>\n<figure class=\"highlight dart\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs dart\">Future&lt;<span class=\"hljs-built_in\">String</span>&gt; fetchUserData() &#123;<br>    <span class=\"hljs-comment\">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œï¼Œä¾‹å¦‚ä»æœåŠ¡å™¨è·å–æ•°æ®</span><br>    <span class=\"hljs-keyword\">return</span> Future.delayed(<span class=\"hljs-built_in\">Duration</span>(seconds: <span class=\"hljs-number\">2</span>), () &#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;User data&quot;</span>;<br>    &#125;);<br>&#125;<br><br><span class=\"hljs-keyword\">void</span> main() &#123;<br>    fetchUserData().then((data) &#123;<br>        <span class=\"hljs-built_in\">print</span>(data); <span class=\"hljs-comment\">// æ‰“å°è¿”å›çš„æ•°æ®</span><br>    &#125;).catchError((error) &#123;<br>        <span class=\"hljs-built_in\">print</span>(error); <span class=\"hljs-comment\">// å¤„ç†å¯èƒ½å‘ç”Ÿçš„é”™è¯¯</span><br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>ä½¿ç”¨ async å’Œ awaitï¼š</p>\n<p>async å’Œ await å…³é”®å­—æä¾›äº†ä¸€ç§æ›´ç›´è§‚çš„æ–¹å¼æ¥å¤„ç†å¼‚æ­¥æ“ä½œã€‚</p>\n<figure class=\"highlight dart\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs dart\">Future&lt;<span class=\"hljs-built_in\">String</span>&gt; fetchUserData() &#123;<br>    <span class=\"hljs-keyword\">return</span> Future.delayed(<span class=\"hljs-built_in\">Duration</span>(seconds: <span class=\"hljs-number\">2</span>), () &#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;User data&quot;</span>;<br>    &#125;);<br>&#125;<br><br>Future&lt;<span class=\"hljs-keyword\">void</span>&gt; printUserData() <span class=\"hljs-keyword\">async</span> &#123;<br>    <span class=\"hljs-keyword\">try</span> &#123;<br>        <span class=\"hljs-keyword\">var</span> userData = <span class=\"hljs-keyword\">await</span> fetchUserData();<br>        <span class=\"hljs-built_in\">print</span>(userData);<br>    &#125; <span class=\"hljs-keyword\">catch</span> (e) &#123;<br>        <span class=\"hljs-built_in\">print</span>(e);<br>    &#125;<br>&#125;<br><br><span class=\"hljs-keyword\">void</span> main() &#123;<br>    printUserData();<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>fetchUserData()</code> è¿”å›ä¸€ä¸ª <code>Future&lt;String&gt;</code>ï¼Œè¡¨ç¤ºå¼‚æ­¥è·å–ç”¨æˆ·æ•°æ®çš„è¿‡ç¨‹ã€‚åœ¨ <code>printUserData()</code> å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>await</code> å…³é”®å­—ç­‰å¾… <code>Future</code> å®Œæˆï¼Œç„¶åæ‰“å°ç»“æœæˆ–æ•è·å¹¶å¤„ç†é”™è¯¯ã€‚</p>\n<p>é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒDart ä½¿å¼‚æ­¥ç¼–ç¨‹æ›´åŠ ç›´è§‚å’Œæ˜“äºç®¡ç†ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤æ‚çš„å¼‚æ­¥æ“ä½œå’Œå¤šä¸ª <code>Future</code> æ—¶ã€‚</p>\n<blockquote>\n<p>åœ¨Dartè¯­è¨€ä¸­ï¼Œâ€œFutureâ€æ˜¯ä¸€ç§ç”¨äºè¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„å¯¹è±¡ã€‚å½“ä½ éœ€è¦æ‰§è¡Œä¸€ä¸ªè€—æ—¶æ“ä½œï¼Œæ¯”å¦‚ä»ç½‘ç»œè·å–æ•°æ®ã€è¯»å–æ–‡ä»¶ç­‰ï¼Œè¿™äº›æ“ä½œé€šå¸¸ä¸ä¼šç«‹å³å®Œæˆï¼Œâ€œFutureâ€™å°±æ˜¯ç”¨æ¥å¤„ç†è¿™ç§æƒ…å†µçš„ã€‚ä½¿ç”¨â€œFuture å¯ä»¥è®©ä½ çš„ç¨‹åºç»§ç»­æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œè€Œä¸å¿…ç­‰å¾…è¿™ä¸ªè€—æ—¶æ“ä½œå®Œæˆã€‚</p>\n</blockquote>\n<h1 id=\"end\">End<a title=\"#end\" href=\"#end\"></a></h1>\n<ul>\n<li>ğŸ¤å¦‚æœæ‚¨å¯¹æœ¬æ–‡æœ‰ä»»ä½•ç–‘é—®æˆ–æƒ³æ³•ï¼Œè¯·åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘å°†å¾ˆä¹æ„ä¸æ‚¨äº¤æµã€‚</li>\n<li>ğŸ°æ‚¨çš„æ¯ä¸€æ¡è¯„è®ºå¯¹æˆ‘éƒ½è‡³å…³é‡è¦ï¼Œæˆ‘ä¼šå°½å¿«ç»™äºˆå›å¤ã€‚</li>\n<li>ğŸˆå¦‚æœæ‚¨è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¯å‘æˆ–å¸®åŠ©ï¼Œè¯·ä¸åèµèµã€æ”¶è—æˆ–åˆ†äº«ã€‚</li>\n<li>ğŸæ‚¨çš„æ¯ä¸€ä¸ªåŠ¨ä½œéƒ½æ˜¯å¯¹æˆ‘åˆ›ä½œçš„æœ€å¤§é¼“åŠ±å’Œæ”¯æŒã€‚</li>\n<li>ğŸ‘è°¢è°¢æ‚¨çš„é˜…è¯»å’Œé™ªä¼´ï¼</li>\n</ul>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202312/2105804-20231211215004818-977875224.png\" alt loading=\"lazy\" class=\"Ï†bp\"></p>\n","prev":{"title":"ã€Flutterã€å¼€å‘ç¯å¢ƒæ­å»º","link":"2023/12/30/Flutter/14-ã€ŒFlutterã€å¼€å‘ç¯å¢ƒæ­å»º"},"next":{"title":"ã€ŒDartã€åº“","link":"2023/12/27/Flutter/12-ã€ŒDartã€åº“"},"plink":"http://example.com/2023/12/29/Flutter/13-ã€ŒDartã€å¼‚æ­¥ç¼–ç¨‹/","toc":[{"id":"å‰è¨€","title":"å‰è¨€","index":"1"},{"id":"å¼‚æ­¥å‡½æ•°ï¼ˆasync-functionsï¼‰","title":"å¼‚æ­¥å‡½æ•°ï¼ˆAsync Functionsï¼‰","index":"2","children":[{"id":"javascript","title":"JavaScript","index":"2.1"},{"id":"dart","title":"Dart","index":"2.2"},{"id":"å¼‚åŒç‚¹","title":"å¼‚åŒç‚¹","index":"2.3"}]},{"id":"äº‹ä»¶å¾ªç¯å’Œå¼‚æ­¥å›è°ƒ","title":"äº‹ä»¶å¾ªç¯å’Œå¼‚æ­¥å›è°ƒ","index":"3","children":[{"id":"javascript-1","title":"JavaScript","index":"3.1"},{"id":"dart-1","title":"Dart","index":"3.2"},{"id":"å¼‚åŒç‚¹-1","title":"å¼‚åŒç‚¹","index":"3.3"}]},{"id":"future","title":"Future","index":"4","children":[{"id":"åŸºæœ¬æ¦‚å¿µ","title":"åŸºæœ¬æ¦‚å¿µ","index":"4.1"},{"id":"ç¤ºä¾‹ä»£ç ","title":"ç¤ºä¾‹ä»£ç ","index":"4.2"}]},{"id":"end","title":"End","index":"5"}]}