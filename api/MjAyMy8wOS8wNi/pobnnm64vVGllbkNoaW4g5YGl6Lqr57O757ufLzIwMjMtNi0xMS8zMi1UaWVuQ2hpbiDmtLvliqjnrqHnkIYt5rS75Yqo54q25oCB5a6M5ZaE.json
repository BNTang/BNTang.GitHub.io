{"title":"TienChin 活动管理-活动状态完善","date":"2023-09-06T15:37:50.000Z","date_formatted":{"ll":"Sep 6, 2023","L":"09/06/2023","MM-DD":"09-06"},"link":"2023/09/06/项目/TienChin 健身系统/2023-6-11/32-TienChin 活动管理-活动状态完善","tags":["项目"],"updated":"2023-09-21T17:02:56.758Z","content":"<h1 id=\"修改字典\">修改字典<a title=\"#修改字典\" href=\"#修改字典\"></a></h1>\n<p>修改活动状态字典，将之前的数据键值为 0 的数据标签内容改为 <code>过期</code>：</p>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202309/2105804-20230906234525916-2060686441.png\" alt=\"image-20230906234524368\" loading=\"lazy\" class=\"φbp\"></p>\n<p>更改下数据库的描述，禁用改为过期：</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">ALTER</span> <span class=\"hljs-keyword\">TABLE</span> `tienchin_activity` <br>MODIFY <span class=\"hljs-keyword\">COLUMN</span> `activity_status` <span class=\"hljs-type\">int</span> <span class=\"hljs-keyword\">NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-keyword\">NULL</span> COMMENT <span class=\"hljs-string\">&#x27;活动状态，0.表示过期、1.表示正常&#x27;</span> AFTER `activity_type`;<br></code></pre></td></tr></table></figure>\n<h1 id=\"activity\">Activity<a title=\"#activity\" href=\"#activity\"></a></h1>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 活动状态，0.表示过期、1.表示正常</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">private</span> Integer activityStatus;<br></code></pre></td></tr></table></figure>\n<h1 id=\"activityserviceimpl\">ActivityServiceImpl<a title=\"#activityserviceimpl\" href=\"#activityserviceimpl\"></a></h1>\n<p>编写一个将超过当前时间的活动状态设置为禁用，在列表查询的时候进行更改一下调用一下方法。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Override</span><br><span class=\"hljs-keyword\">public</span> List&lt;ActivityVO&gt; <span class=\"hljs-title function_\">selectActivityList</span><span class=\"hljs-params\">()</span> &#123;<br>    <span class=\"hljs-comment\">// 将超过当前时间的活动状态设置为禁用</span><br>    expireActivity();<br><br>    <span class=\"hljs-keyword\">return</span> activityMapper.selectActivityList();<br>&#125;<br></code></pre></td></tr></table></figure>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 将超过当前时间的活动状态设置为禁用</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">expireActivity</span><span class=\"hljs-params\">()</span> &#123;<br>    UpdateWrapper&lt;Activity&gt; uw = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UpdateWrapper</span>&lt;&gt;();<br><br>    <span class=\"hljs-comment\">// 将原本状态为正常的活动状态为1，并且 endTime 小于当前时间的活动状态设置为过期</span><br>    uw.lambda()<br>            .set(Activity::getActivityStatus, <span class=\"hljs-number\">0</span>)<br>            .eq(Activity::getActivityStatus, <span class=\"hljs-number\">1</span>)<br>            .lt(Activity::getEndTime, LocalDateTime.now());<br><br>    update(uw);<br>&#125;<br></code></pre></td></tr></table></figure>","prev":{"title":"TienChin 活动管理-设置活动的默认状态","link":"2023/09/09/项目/TienChin 健身系统/2023-6-11/34-TienChin 活动管理-设置活动的默认状态"},"next":{"title":"TienChin 活动管理-添加活动接口","link":"2023/09/06/项目/TienChin 健身系统/2023-6-11/33-TienChin 活动管理-添加活动接口"},"plink":"http://example.com/2023/09/06/项目/TienChin 健身系统/2023-6-11/32-TienChin 活动管理-活动状态完善/","toc":[{"id":"修改字典","title":"修改字典","index":"1"},{"id":"activity","title":"Activity","index":"2"},{"id":"activityserviceimpl","title":"ActivityServiceImpl","index":"3"}],"reading_time":"277 words in 2 min"}