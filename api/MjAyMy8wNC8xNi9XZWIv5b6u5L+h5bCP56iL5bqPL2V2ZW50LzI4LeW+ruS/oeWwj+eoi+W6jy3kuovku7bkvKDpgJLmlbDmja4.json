{"title":"微信小程序-事件传递数据","date":"2023-04-16T04:21:22.000Z","date_formatted":{"ll":"Apr 16, 2023","L":"04/16/2023","MM-DD":"04-16"},"link":"2023/04/16/Web/微信小程序/event/28-微信小程序-事件传递数据","tags":["微信小程序"],"updated":"2023-04-16T04:55:32.350Z","content":"<h1 id=\"事件对象\">事件对象<a title=\"#事件对象\" href=\"#事件对象\"></a></h1>\n<p>小程序在触发事件监听方法的时候会自动传递一个事件对象给我们，通过这个事件对象我们可以拿到页面传递过来的一些数据。</p>\n<h1 id=\"事件对象的作用\">事件对象的作用<a title=\"#事件对象的作用\" href=\"#事件对象的作用\"></a></h1>\n<ul>\n<li>拿到触发事件的元素: currentTarget</li>\n<li>拿到触发事件的位置: detail</li>\n<li>拿到从页面传递过来的数据: dataset/mark</li>\n</ul>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202304/2105804-20230416123707011-1126843295.png\" alt=\"image-20230416123706781\" loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"页面传递数据的方法\">页面传递数据的方法<a title=\"#页面传递数据的方法\" href=\"#页面传递数据的方法\"></a></h1>\n<ul>\n<li>dataset</li>\n<li>mark</li>\n</ul>\n<p>通过 dataset 传递数据：</p>\n<p>官方文档：<a href=\"https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#dataset\" target=\"_blank\">https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#dataset</a></p>\n<p>在 WXML 中，这些自定义数据以 <code>data-</code> 开头，多个单词由连字符 <code>-</code> 连接。这种写法中，连字符写法会转换成驼峰写法，而大写字符会自动转成小写字符。如：</p>\n<ul>\n<li><code>data-element-type</code> ，最终会呈现为 <code>event.currentTarget.dataset.elementType</code> ；</li>\n<li><code>data-elementType</code> ，最终会呈现为 <code>event.currentTarget.dataset.elementtype</code> 。</li>\n</ul>\n<p>dataset 示例：</p>\n<p>index.wxml:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">view</span> <span class=\"hljs-attr\">data-name</span>=<span class=\"hljs-string\">&quot;BNTang&quot;</span> <span class=\"hljs-attr\">bind:tap</span>=<span class=\"hljs-string\">&quot;oneTap&quot;</span>&gt;</span>我是view<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">view</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<p>index.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-attr\">oneTap</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)&#123;<br>  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;oneTap&#x27;</span>, event);<br>  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(event.<span class=\"hljs-property\">currentTarget</span>.<span class=\"hljs-property\">dataset</span>.<span class=\"hljs-property\">name</span>);<br>&#125;,<br></code></pre></td></tr></table></figure>\n<p>小程序会自动将页面中data-xxx的数据放到事件对象的currentTarget的dataset中。</p>\n<p>mark 示例：</p>\n<p>index.wxml:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">view</span> <span class=\"hljs-attr\">mark:name</span>=<span class=\"hljs-string\">&quot;BNTang&quot;</span> <span class=\"hljs-attr\">bind:tap</span>=<span class=\"hljs-string\">&quot;oneTap&quot;</span>&gt;</span>我是view<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">view</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<p>index.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-attr\">oneTap</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)&#123;<br>  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&#x27;oneTap&#x27;</span>, event);<br>  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(event.<span class=\"hljs-property\">mark</span>.<span class=\"hljs-property\">name</span>);<br>&#125;,<br></code></pre></td></tr></table></figure>\n<p>小程序会自动将页面中mark:xxx的数据放到事件对象的mark属性中。</p>\n<p>遗留问题：为什么要有两种传递数据的方式？</p>\n<p>!&gt; 涉及到事件冒泡和捕获/涉及到嵌套结构/涉及到currentTarget</p>\n","prev":{"title":"微信小程序-data和mark","link":"2023/04/19/Web/微信小程序/event/29-微信小程序-data和mark"},"next":{"title":"微信小程序-小程序事件冒泡和事件捕获","link":"2023/04/16/Web/微信小程序/event/27-微信小程序-小程序事件冒泡和事件捕获"},"plink":"http://example.com/2023/04/16/Web/微信小程序/event/28-微信小程序-事件传递数据/","toc":[{"id":"事件对象","title":"事件对象","index":"1"},{"id":"事件对象的作用","title":"事件对象的作用","index":"2"},{"id":"页面传递数据的方法","title":"页面传递数据的方法","index":"3"}],"reading_time":"391 words in 3 min"}