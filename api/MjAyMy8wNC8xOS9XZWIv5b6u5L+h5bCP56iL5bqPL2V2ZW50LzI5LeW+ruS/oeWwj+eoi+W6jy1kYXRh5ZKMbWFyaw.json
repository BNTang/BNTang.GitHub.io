{"title":"微信小程序-data和mark","date":"2023-04-18T16:47:55.000Z","date_formatted":{"ll":"Apr 19, 2023","L":"04/19/2023","MM-DD":"04-19"},"link":"2023/04/19/Web/微信小程序/event/29-微信小程序-data和mark","tags":["微信小程序"],"updated":"2023-04-19T16:41:37.985Z","content":"<p>经过之前的文章介绍，我们已经知道了，在事件当中如何进行数据的传递，那么在介绍当中有两种传递方式，那么这两种方式分别有什么区别呢，我们一起来看看吧~</p>\n<p>我们先来看一个情况，就是看一下在元素结构有嵌套与无嵌套情况下我们拿到的currentTatget与target分别拿到的是那个元素信息。</p>\n<p>如果不存在嵌套的情况，那么无论currentTatget还是target拿到的都是触发事件的那个元素。</p>\n<p>index.wxml:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">view</span> <span class=\"hljs-attr\">bind:tap</span>=<span class=\"hljs-string\">&quot;oneTap&quot;</span>&gt;</span>我是view<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">view</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<p>index.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-attr\">oneTap</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(event);<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>\n<p>好了，这个是没有嵌套结构关系时的情况，接下来我模拟一个嵌套关系的场景，代码如下：</p>\n<p>index.wxml:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">view</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;father&quot;</span> <span class=\"hljs-attr\">capture-bind:tap</span>=<span class=\"hljs-string\">&quot;onCaptureFatherTap&quot;</span> <span class=\"hljs-attr\">bind:tap</span>=<span class=\"hljs-string\">&quot;onFatherTap&quot;</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">view</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;son&quot;</span> <span class=\"hljs-attr\">capture-bind:tap</span>=<span class=\"hljs-string\">&quot;onCaptureSonTap&quot;</span> <span class=\"hljs-attr\">bind:tap</span>=<span class=\"hljs-string\">&quot;onSonTap&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">view</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">view</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<p>index.wxss:</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs css\"><span class=\"hljs-comment\">/* pages/index/index.wxss */</span><br><span class=\"hljs-selector-id\">#father</span> &#123;<br>    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">400px</span>;<br>    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">400px</span>;<br>    <span class=\"hljs-attribute\">background</span>: <span class=\"hljs-number\">#0099FF</span>;<br>&#125;<br><br><span class=\"hljs-selector-id\">#son</span> &#123;<br>    <span class=\"hljs-attribute\">width</span>: <span class=\"hljs-number\">320px</span>;<br>    <span class=\"hljs-attribute\">height</span>: <span class=\"hljs-number\">320px</span>;<br>    <span class=\"hljs-attribute\">background</span>: forestgreen;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>index.js:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-title class_\">Page</span>(&#123;<br>  <span class=\"hljs-attr\">onCaptureFatherTap</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;father捕获：&quot;</span>, event);<br>  &#125;,<br>  <span class=\"hljs-attr\">onFatherTap</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;father冒泡：&quot;</span>, event);<br>  &#125;,<br>  <span class=\"hljs-attr\">onCaptureSonTap</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;son捕获：&quot;</span>, event);<br>  &#125;,<br>  <span class=\"hljs-attr\">onSonTap</span>: <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">event</span>)&#123;<br>    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;son冒泡：&quot;</span>, event);<br>  &#125;,<br>&#125;)<br></code></pre></td></tr></table></figure>\n<p>然后我们在微信小程序开发工具当中运行这个代码，点击 son，运行代码得到了每个捕获和冒泡方法当中的currentTatget与target信息分别是什么元素：</p>\n<p>onCaptureFatherTap：</p>\n<ul>\n<li>currentTatget：father</li>\n<li>target：son</li>\n</ul>\n<p>onFatherTap：</p>\n<ul>\n<li>currentTatget：father</li>\n<li>target：son</li>\n</ul>\n<p>onCaptureSonTap：</p>\n<ul>\n<li>currentTatget：son</li>\n<li>target：son</li>\n</ul>\n<p>onSonTap：</p>\n<ul>\n<li>currentTatget：son</li>\n<li>target：son</li>\n</ul>\n<p>好了看了下运行结果之后，这里我来做一个小小的总结：</p>\n<p>!&gt; 无论是捕获还是冒泡</p>\n<ul>\n<li>currentTatget：拿到的都是<code>绑定</code>这个事件的那个元素</li>\n<li>target：拿到的都是<code>触发</code>事件的那个元素</li>\n</ul>\n<p>好了，看了这个内容之后我现在来进行使用data或者mark来传递数据了。首先我使用data来进行传递，这个传递是数据我写在father组件当中，这个时候我如果想要在son当中拿到father当中的数据该如何获取这个是我的一个需求：</p>\n<p>!&gt; 好了这里我也不卖关子了，其实通过data-xxx绑定的数据，那么在son的监听方法中是拿不到father当中绑定数据的。</p>\n<p>!&gt; 但是呢，我们可以通过 mark，如果是通过mark:xxx绑定的数据，那么在son的监听方法中是可以拿到father数据的</p>\n<p>!&gt; mark:xxx 绑定的数据会将所有祖先元素子元素的数据都融合在一起</p>\n<p>我们在father通过mark绑定一个数据然后在son当中也使用mark绑定一下数据就可以证明我说的这一点代码和效果如下图所示：</p>\n<p>index.wxml:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">view</span> <span class=\"hljs-attr\">mark:name</span>=<span class=\"hljs-string\">&quot;BNTang&quot;</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;father&quot;</span> <span class=\"hljs-attr\">capture-bind:tap</span>=<span class=\"hljs-string\">&quot;onCaptureFatherTap&quot;</span> <span class=\"hljs-attr\">bind:tap</span>=<span class=\"hljs-string\">&quot;onFatherTap&quot;</span>&gt;</span><br>  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">view</span> <span class=\"hljs-attr\">mark:age</span>=<span class=\"hljs-string\">&quot;18&quot;</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;son&quot;</span> <span class=\"hljs-attr\">capture-bind:tap</span>=<span class=\"hljs-string\">&quot;onCaptureSonTap&quot;</span> <span class=\"hljs-attr\">bind:tap</span>=<span class=\"hljs-string\">&quot;onSonTap&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">view</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">view</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202304/2105804-20230420004134460-810346798.png\" alt=\"image-20230420004134042\" loading=\"lazy\" class=\"φbp\"></p>\n","prev":{"title":"微信小程序-touches和changedTouches","link":"2023/04/20/Web/微信小程序/event/30-微信小程序-touches和changedTouches"},"next":{"title":"微信小程序-事件传递数据","link":"2023/04/16/Web/微信小程序/event/28-微信小程序-事件传递数据"},"plink":"http://example.com/2023/04/19/Web/微信小程序/event/29-微信小程序-data和mark/","reading_time":"758 words in 5 min"}