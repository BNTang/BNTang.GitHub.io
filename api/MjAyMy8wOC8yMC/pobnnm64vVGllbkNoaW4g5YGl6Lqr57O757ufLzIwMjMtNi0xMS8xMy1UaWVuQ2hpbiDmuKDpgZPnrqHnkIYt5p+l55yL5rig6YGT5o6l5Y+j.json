{"title":"TienChin 渠道管理-查看渠道接口","date":"2023-08-20T03:12:21.000Z","date_formatted":{"ll":"Aug 20, 2023","L":"08/20/2023","MM-DD":"08-20"},"link":"2023/08/20/项目/TienChin 健身系统/2023-6-11/13-TienChin 渠道管理-查看渠道接口","tags":["项目"],"updated":"2023-09-02T02:23:21.880Z","content":"<h1 id=\"自定义-haspermission-校验规则\">自定义 hasPermission 校验规则<a title=\"#自定义-haspermission-校验规则\" href=\"#自定义-haspermission-校验规则\"></a></h1>\n<p>自定义一个 Spring Security hasPermission 校验规则：</p>\n<p>在 tienchin-framework 模块当中进行自定义，新建 CustomSecurityExpressionRoot.java 自定义 hasPermission 判断逻辑类：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span> 自定义 hasPermission 判断逻辑</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023-08-26</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CustomSecurityExpressionRoot</span><br>        <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">SecurityExpressionRoot</span><br>        <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">MethodSecurityExpressionOperations</span> &#123;<br><br>    <span class=\"hljs-keyword\">private</span> Object filterObject;<br>    <span class=\"hljs-keyword\">private</span> Object returnObject;<br>    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">AntPathMatcher</span> <span class=\"hljs-variable\">antPathMatcher</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">AntPathMatcher</span>();<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * Creates a new instance</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> authentication the &#123;<span class=\"hljs-doctag\">@link</span> Authentication&#125; to use. Cannot be null.</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-title function_\">CustomSecurityExpressionRoot</span><span class=\"hljs-params\">(Authentication authentication)</span> &#123;<br>        <span class=\"hljs-built_in\">super</span>(authentication);<br>    &#125;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 判断当前对象是否具备某一个权限</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> permission 权限</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span> boolean</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@since</span> 2023/08/26 08:43:56</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">hasPermission</span><span class=\"hljs-params\">(String permission)</span> &#123;<br>        <span class=\"hljs-comment\">// 获取当前登录用户所具有的权限</span><br>        <span class=\"hljs-comment\">// 这里实际上调用到的是 top.it6666.common.core.domain.model.LoginUser.getAuthorities 方法的返回值</span><br>        Collection&lt;? <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">GrantedAuthority</span>&gt; authorities = authentication.getAuthorities();<br>        <span class=\"hljs-keyword\">for</span> (GrantedAuthority authority : authorities) &#123;<br>            <span class=\"hljs-keyword\">if</span> (antPathMatcher.match(authority.getAuthority(), permission)) &#123;<br>                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>            &#125;<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>    &#125;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 是否具备多个权限中的任意一个权限</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> permissions 权限</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span> boolean</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@since</span> 2023/08/26 08:44:52</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">hasAnyPermissions</span><span class=\"hljs-params\">(String... permissions)</span> &#123;<br>        <span class=\"hljs-keyword\">if</span> (permissions == <span class=\"hljs-literal\">null</span> || permissions.length == <span class=\"hljs-number\">0</span>) &#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>        &#125;<br>        Collection&lt;? <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">GrantedAuthority</span>&gt; authorities = authentication.getAuthorities();<br>        <span class=\"hljs-keyword\">for</span> (GrantedAuthority authority : authorities) &#123;<br>            <span class=\"hljs-keyword\">for</span> (String permission : permissions) &#123;<br>                <span class=\"hljs-keyword\">if</span> (antPathMatcher.match(authority.getAuthority(), permission)) &#123;<br>                    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>    &#125;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 是否具备拥有所有权限</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@param</span> permissions 权限</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span> boolean</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@since</span> 2023/08/26 08:44:26</span><br><span class=\"hljs-comment\">     */</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">hasAllPermissions</span><span class=\"hljs-params\">(String... permissions)</span> &#123;<br>        Collection&lt;? <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">GrantedAuthority</span>&gt; authorities = authentication.getAuthorities();<br>        <span class=\"hljs-keyword\">if</span> (permissions == <span class=\"hljs-literal\">null</span> || permissions.length == <span class=\"hljs-number\">0</span>) &#123;<br>            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>        &#125;<br>        <span class=\"hljs-keyword\">for</span> (String permission : permissions) &#123;<br>            <span class=\"hljs-type\">boolean</span> <span class=\"hljs-variable\">flag</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">false</span>;<br>            <span class=\"hljs-keyword\">for</span> (GrantedAuthority authority : authorities) &#123;<br>                <span class=\"hljs-keyword\">if</span> (antPathMatcher.match(authority.getAuthority(), permission)) &#123;<br>                    flag = <span class=\"hljs-literal\">true</span>;<br>                &#125;<br>            &#125;<br>            <span class=\"hljs-keyword\">if</span> (!flag) &#123;<br>                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;<br>            &#125;<br>        &#125;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setFilterObject</span><span class=\"hljs-params\">(Object filterObject)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.filterObject = filterObject;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title function_\">getFilterObject</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> filterObject;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setReturnObject</span><span class=\"hljs-params\">(Object returnObject)</span> &#123;<br>        <span class=\"hljs-built_in\">this</span>.returnObject = returnObject;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title function_\">getReturnObject</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> returnObject;<br>    &#125;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> Object <span class=\"hljs-title function_\">getThis</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">this</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>新建自定义 hasPermission 判断逻辑处理器类：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@version</span> 1.0</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@description</span> 自定义 hasPermission 判断逻辑处理器</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023-08-26</span><br><span class=\"hljs-comment\"> **/</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CustomMethodSecurityExpressionHandler</span><br>        <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">DefaultMethodSecurityExpressionHandler</span> &#123;<br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">protected</span> MethodSecurityExpressionOperations <span class=\"hljs-title function_\">createSecurityExpressionRoot</span><span class=\"hljs-params\">(Authentication authentication,</span><br><span class=\"hljs-params\">                                                                              MethodInvocation invocation)</span> &#123;<br><br>        <span class=\"hljs-type\">CustomSecurityExpressionRoot</span> <span class=\"hljs-variable\">root</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">CustomSecurityExpressionRoot</span>(authentication);<br><br>        root.setTrustResolver(getTrustResolver());<br>        root.setPermissionEvaluator(getPermissionEvaluator());<br>        root.setRoleHierarchy(getRoleHierarchy());<br><br>        <span class=\"hljs-keyword\">return</span> root;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>注册一下自定义 hasPermission 判断逻辑处理器，更改 ResourcesConfig：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 自定义 hasPermission 判断逻辑处理器</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@return</span> &#123;<span class=\"hljs-doctag\">@code</span> CustomMethodSecurityExpressionHandler &#125;</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023/08/26 08:57:19</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Bean</span><br>CustomMethodSecurityExpressionHandler <span class=\"hljs-title function_\">customMethodSecurityExpressionHandler</span><span class=\"hljs-params\">()</span> &#123;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">CustomMethodSecurityExpressionHandler</span>();<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>更改 LoginUser，完善一下 LoginUser 当中的 getAuthorities 方法：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Override</span><br><span class=\"hljs-keyword\">public</span> Collection&lt;? <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">GrantedAuthority</span>&gt; getAuthorities() &#123;<br>    <span class=\"hljs-keyword\">if</span> (permissions != <span class=\"hljs-literal\">null</span> &amp;&amp; !permissions.isEmpty()) &#123;<br>        <span class=\"hljs-keyword\">return</span> permissions.stream()<br>                .map(SimpleGrantedAuthority::<span class=\"hljs-keyword\">new</span>)<br>                .collect(Collectors.toList());<br>    &#125;<br>    <span class=\"hljs-keyword\">return</span> Collections.emptyList();<br>&#125;<br></code></pre></td></tr></table></figure>\n<h1 id=\"编写查询接口\">编写查询接口<a title=\"#编写查询接口\" href=\"#编写查询接口\"></a></h1>\n<p>更改 ChannelController：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * &lt;p&gt;</span><br><span class=\"hljs-comment\"> * 渠道管理表 前端控制器</span><br><span class=\"hljs-comment\"> * &lt;/p&gt;</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023-08-22</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@RestController</span><br><span class=\"hljs-meta\">@RequestMapping(&quot;/tienchin/channel&quot;)</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ChannelController</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">BaseController</span> &#123;<br><br>    <span class=\"hljs-meta\">@Resource</span><br>    <span class=\"hljs-keyword\">private</span> IChannelService iChannelService;<br><br>    <span class=\"hljs-meta\">@PreAuthorize(&quot;hasPermission(&#x27;tienchin:channel:list&#x27;)&quot;)</span><br>    <span class=\"hljs-meta\">@GetMapping(&quot;/list&quot;)</span><br>    TableDataInfo <span class=\"hljs-title function_\">list</span><span class=\"hljs-params\">()</span> &#123;<br>        startPage();<br>        <span class=\"hljs-keyword\">return</span> getDataTable(iChannelService.selectChannelList());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>更改 IChannelService：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * &lt;p&gt;</span><br><span class=\"hljs-comment\"> * 渠道管理表 服务类</span><br><span class=\"hljs-comment\"> * &lt;/p&gt;</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023-08-22</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">IChannelService</span><br>        <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">IService</span>&lt;Channel&gt; &#123;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 查询渠道列表</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span> &#123;<span class=\"hljs-doctag\">@code</span> List&lt;Channel&gt; &#125;</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@since</span> 2023/08/26 09:32:57</span><br><span class=\"hljs-comment\">     */</span><br>    List&lt;Channel&gt; <span class=\"hljs-title function_\">selectChannelList</span><span class=\"hljs-params\">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>更改 ChannelServiceImpl：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * &lt;p&gt;</span><br><span class=\"hljs-comment\"> * 渠道管理表 服务实现类</span><br><span class=\"hljs-comment\"> * &lt;/p&gt;</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023-08-22</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@Service</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ChannelServiceImpl</span><br>        <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">ServiceImpl</span>&lt;ChannelMapper, Channel&gt;<br>        <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">IChannelService</span> &#123;<br><br>    <span class=\"hljs-meta\">@Resource</span><br>    <span class=\"hljs-keyword\">private</span> ChannelMapper channelMapper;<br><br>    <span class=\"hljs-meta\">@Override</span><br>    <span class=\"hljs-keyword\">public</span> List&lt;Channel&gt; <span class=\"hljs-title function_\">selectChannelList</span><span class=\"hljs-params\">()</span> &#123;<br>        <span class=\"hljs-keyword\">return</span> channelMapper.selectChannelList();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>更改 ChannelMapper：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * &lt;p&gt;</span><br><span class=\"hljs-comment\"> * 渠道管理表 Mapper 接口</span><br><span class=\"hljs-comment\"> * &lt;/p&gt;</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@since</span> 2023-08-22</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">ChannelMapper</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">BaseMapper</span>&lt;Channel&gt; &#123;<br><br>    <span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\">     * 查询渠道列表</span><br><span class=\"hljs-comment\">     *</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@return</span> &#123;<span class=\"hljs-doctag\">@code</span> List&lt;Channel&gt; &#125;</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@author</span> BNTang</span><br><span class=\"hljs-comment\">     * <span class=\"hljs-doctag\">@since</span> 2023/08/26 09:33:46</span><br><span class=\"hljs-comment\">     */</span><br>    List&lt;Channel&gt; <span class=\"hljs-title function_\">selectChannelList</span><span class=\"hljs-params\">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure>\n<p>更改 ChannelMapper.xml：</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs xml\"><span class=\"hljs-meta\">&lt;?xml version=<span class=\"hljs-string\">&quot;1.0&quot;</span> encoding=<span class=\"hljs-string\">&quot;UTF-8&quot;</span>?&gt;</span><br><span class=\"hljs-meta\">&lt;!DOCTYPE <span class=\"hljs-keyword\">mapper</span> <span class=\"hljs-keyword\">PUBLIC</span> <span class=\"hljs-string\">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class=\"hljs-string\">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">mapper</span> <span class=\"hljs-attr\">namespace</span>=<span class=\"hljs-string\">&quot;top.it6666.channel.mapper.ChannelMapper&quot;</span>&gt;</span><br>    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">select</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;selectChannelList&quot;</span> <span class=\"hljs-attr\">resultType</span>=<span class=\"hljs-string\">&quot;top.it6666.channel.domain.Channel&quot;</span>&gt;</span><br>        SELECT channel_id,<br>               channel_name,<br>               status,<br>               remark,<br>               type,<br>               create_by,<br>               update_by,<br>               create_time,<br>               update_time,<br>               del_flag<br>        FROM tienchin_channel<br>        WHERE del_flag = 0<br>    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">select</span>&gt;</span><br><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure>\n<h1 id=\"全局将-@ss.haspermi-替换为-haspermission\">全局将 @ss.hasPermi 替换为 hasPermission<a title=\"#全局将-@ss.haspermi-替换为-haspermission\" href=\"#全局将-@ss.haspermi-替换为-haspermission\"></a></h1>\n<p><img src=\"https://img2023.cnblogs.com/blog/2105804/202308/2105804-20230829234308691-662414183.png\" alt=\"image-20230829234307171\" loading=\"lazy\" class=\"φbp\"></p>\n<h1 id=\"插入数据\">插入数据<a title=\"#插入数据\" href=\"#插入数据\"></a></h1>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs sql\"><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> TienChin.tienchin_channel (channel_id, channel_name, status, remark, type, create_by, update_by,<br>                                       create_time, update_time, del_flag)<br><span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;百度竞价&#x27;</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;百度竞价推广&#x27;</span>, <span class=\"hljs-number\">1</span>, <span class=\"hljs-keyword\">null</span>, <span class=\"hljs-keyword\">null</span>, <span class=\"hljs-keyword\">null</span>, <span class=\"hljs-string\">&#x27;2023-08-31 00:29:42&#x27;</span>, <span class=\"hljs-string\">&#x27;0&#x27;</span>);<br><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> TienChin.tienchin_channel (channel_id, channel_name, status, remark, type, create_by, update_by,<br>                                       create_time, update_time, del_flag)<br><span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">2</span>, <span class=\"hljs-string\">&#x27;地推&#x27;</span>, <span class=\"hljs-number\">0</span>, <span class=\"hljs-string\">&#x27;地推&#x27;</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-keyword\">null</span>, <span class=\"hljs-keyword\">null</span>, <span class=\"hljs-keyword\">null</span>, <span class=\"hljs-keyword\">null</span>, <span class=\"hljs-string\">&#x27;0&#x27;</span>);<br></code></pre></td></tr></table></figure>\n","prev":{"title":"TienChin 渠道管理-工程创建","link":"2023/08/20/项目/TienChin 健身系统/2023-6-11/12-TienChin 渠道管理-工程创建"},"next":{"title":"TienChin 渠道管理-渠道类型","link":"2023/08/19/项目/TienChin 健身系统/2023-6-11/11-TienChin 渠道管理-渠道类型"},"plink":"http://example.com/2023/08/20/项目/TienChin 健身系统/2023-6-11/13-TienChin 渠道管理-查看渠道接口/","toc":[{"id":"自定义-haspermission-校验规则","title":"自定义 hasPermission 校验规则","index":"1"},{"id":"编写查询接口","title":"编写查询接口","index":"2"},{"id":"全局将-@ss.haspermi-替换为-haspermission","title":"全局将 @ss.hasPermi 替换为 hasPermission","index":"3"},{"id":"插入数据","title":"插入数据","index":"4"}],"reading_time":"1126 words in 8 min"}