{"title":"TienChin 活动管理-添加活动页面","date":"2023-09-10T00:57:12.000Z","date_formatted":{"ll":"Sep 10, 2023","L":"09/10/2023","MM-DD":"09-10"},"link":"2023/09/10/项目/TienChin 健身系统/2023-6-11/35-TienChin 活动管理-添加活动页面","tags":["项目"],"updated":"2023-09-21T17:12:51.414Z","content":"<h1 id=\"后端\">后端<a title=\"#后端\" href=\"#后端\"></a></h1>\n<h2 id=\"activitycontroller.java\">ActivityController.java<a title=\"#activitycontroller.java\" href=\"#activitycontroller.java\"></a></h2>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs java\"><span class=\"hljs-meta\">@Resource</span><br><span class=\"hljs-keyword\">private</span> IChannelService iChannelService;<br><br><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 获取渠道列表</span><br><span class=\"hljs-comment\"> *</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@return</span> 渠道列表</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-meta\">@PreAuthorize(&quot;hasPermission(&#x27;tienchin:activity:create&#x27;)&quot;)</span><br><span class=\"hljs-meta\">@GetMapping(&quot;/channel/list&quot;)</span><br>AjaxResult <span class=\"hljs-title function_\">channelList</span><span class=\"hljs-params\">()</span> &#123;<br>    <span class=\"hljs-keyword\">return</span> AjaxResult.success(iChannelService.selectChannelList(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ChannelVO</span>()));<br>&#125;<br></code></pre></td></tr></table></figure>\n<h1 id=\"前端\">前端<a title=\"#前端\" href=\"#前端\"></a></h1>\n<h2 id=\"activity.js\">activity.js<a title=\"#activity.js\" href=\"#activity.js\"></a></h2>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs javascript\"><span class=\"hljs-comment\">/**</span><br><span class=\"hljs-comment\"> * 查询渠道列表</span><br><span class=\"hljs-comment\"> * <span class=\"hljs-doctag\">@returns</span> &#123;<span class=\"hljs-type\">*</span>&#125; 查询结果</span><br><span class=\"hljs-comment\"> */</span><br><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">listChannel</span>(<span class=\"hljs-params\"></span>) &#123;<br>    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">request</span>(&#123;<br>        <span class=\"hljs-attr\">url</span>: <span class=\"hljs-string\">&#x27;/tienchin/activity/channel/list&#x27;</span>,<br>        <span class=\"hljs-attr\">method</span>: <span class=\"hljs-string\">&#x27;get&#x27;</span><br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>\n<h2 id=\"index.vue\">index.vue<a title=\"#index.vue\" href=\"#index.vue\"></a></h2>\n<p>直接将原有的 index.vue 的全部内容替换成下面的，这里先替换，我只是补齐文档，后面新模块开发我会一步一步进行记录起来：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br><span class=\"line\">460</span><br><span class=\"line\">461</span><br><span class=\"line\">462</span><br><span class=\"line\">463</span><br><span class=\"line\">464</span><br><span class=\"line\">465</span><br><span class=\"line\">466</span><br><span class=\"line\">467</span><br><span class=\"line\">468</span><br><span class=\"line\">469</span><br><span class=\"line\">470</span><br><span class=\"line\">471</span><br><span class=\"line\">472</span><br><span class=\"line\">473</span><br><span class=\"line\">474</span><br><span class=\"line\">475</span><br><span class=\"line\">476</span><br><span class=\"line\">477</span><br><span class=\"line\">478</span><br><span class=\"line\">479</span><br><span class=\"line\">480</span><br></pre></td><td class=\"code\"><pre><code class=\"hljs vue\">&lt;template&gt;<br>  &lt;div class=&quot;app-container&quot;&gt;<br>    &lt;el-form :model=&quot;queryParams&quot; ref=&quot;queryRef&quot; :inline=&quot;true&quot; v-show=&quot;showSearch&quot; label-width=&quot;68px&quot;&gt;<br>      &lt;el-form-item label=&quot;活动名称&quot; prop=&quot;activityName&quot;&gt;<br>        &lt;el-input<br>            v-model=&quot;queryParams.activityName&quot;<br>            placeholder=&quot;请输入活动名称&quot;<br>            clearable<br>            @keyup.enter=&quot;handleQuery&quot;<br>        /&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;渠道名称&quot; prop=&quot;channelId&quot;&gt;<br>        &lt;el-select<br>            v-model=&quot;queryParams.channelId&quot;<br>            placeholder=&quot;请选择渠道名称&quot;<br>            clearable<br>        &gt;<br>          &lt;el-option<br>              v-for=&quot;channel in channelList&quot;<br>              :key=&quot;channel.channelId&quot;<br>              :label=&quot;channel.channelName&quot;<br>              :value=&quot;channel.channelId&quot;<br>          /&gt;<br>        &lt;/el-select&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;活动状态&quot; prop=&quot;activityStatus&quot;&gt;<br>        &lt;el-select<br>            v-model=&quot;queryParams.activityStatus&quot;<br>            placeholder=&quot;请选择活动状态&quot;<br>            clearable<br>        &gt;<br>          &lt;el-option<br>              v-for=&quot;dict in activity_status&quot;<br>              :key=&quot;dict.value&quot;<br>              :label=&quot;dict.label&quot;<br>              :value=&quot;dict.value&quot;<br>          /&gt;<br>        &lt;/el-select&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;活动类型&quot; prop=&quot;activityType&quot;&gt;<br>        &lt;el-select<br>            v-model=&quot;queryParams.activityType&quot;<br>            placeholder=&quot;请选择活动类型&quot;<br>            clearable<br>        &gt;<br>          &lt;el-option<br>              v-for=&quot;dict in activity_type&quot;<br>              :key=&quot;dict.value&quot;<br>              :label=&quot;dict.label&quot;<br>              :value=&quot;dict.value&quot;<br>          /&gt;<br>        &lt;/el-select&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item&gt;<br>        &lt;el-button type=&quot;primary&quot; icon=&quot;Search&quot; @click=&quot;handleQuery&quot;&gt;搜索&lt;/el-button&gt;<br>        &lt;el-button icon=&quot;Refresh&quot; @click=&quot;resetQuery&quot;&gt;重置&lt;/el-button&gt;<br>      &lt;/el-form-item&gt;<br>    &lt;/el-form&gt;<br><br>    &lt;el-row :gutter=&quot;10&quot; class=&quot;mb8&quot;&gt;<br>      &lt;el-col :span=&quot;1.5&quot;&gt;<br>        &lt;el-button<br>            type=&quot;primary&quot;<br>            plain<br>            icon=&quot;Plus&quot;<br>            @click=&quot;handleAdd&quot;<br>            v-hasPermi=&quot;[&#x27;tienchin:activity:create&#x27;]&quot;<br>        &gt;新增<br>        &lt;/el-button&gt;<br>      &lt;/el-col&gt;<br>      &lt;el-col :span=&quot;1.5&quot;&gt;<br>        &lt;el-button<br>            type=&quot;success&quot;<br>            plain<br>            icon=&quot;Edit&quot;<br>            :disabled=&quot;single&quot;<br>            @click=&quot;handleUpdate&quot;<br>            v-hasPermi=&quot;[&#x27;tienchin:activity:edit&#x27;]&quot;<br>        &gt;修改<br>        &lt;/el-button&gt;<br>      &lt;/el-col&gt;<br>      &lt;el-col :span=&quot;1.5&quot;&gt;<br>        &lt;el-button<br>            type=&quot;danger&quot;<br>            plain<br>            icon=&quot;Delete&quot;<br>            :disabled=&quot;multiple&quot;<br>            @click=&quot;handleDelete&quot;<br>            v-hasPermi=&quot;[&#x27;tienchin:activity:remove&#x27;]&quot;<br>        &gt;删除<br>        &lt;/el-button&gt;<br>      &lt;/el-col&gt;<br>      &lt;el-col :span=&quot;1.5&quot;&gt;<br>        &lt;el-button<br>            type=&quot;warning&quot;<br>            plain<br>            icon=&quot;Download&quot;<br>            @click=&quot;handleExport&quot;<br>            v-hasPermi=&quot;[&#x27;tienchin:activity:export&#x27;]&quot;<br>        &gt;导出<br>        &lt;/el-button&gt;<br>      &lt;/el-col&gt;<br>      &lt;right-toolbar v-model:showSearch=&quot;showSearch&quot; @queryTable=&quot;getList&quot;&gt;&lt;/right-toolbar&gt;<br>    &lt;/el-row&gt;<br><br>    &lt;el-table v-loading=&quot;loading&quot; :data=&quot;activityList&quot; @selection-change=&quot;handleSelectionChange&quot;&gt;<br>      &lt;el-table-column type=&quot;selection&quot; width=&quot;55&quot; align=&quot;center&quot;/&gt;<br>      &lt;el-table-column label=&quot;活动编号&quot; align=&quot;center&quot; prop=&quot;activityId&quot;/&gt;<br>      &lt;el-table-column label=&quot;活动名称&quot; align=&quot;center&quot; prop=&quot;activityName&quot;/&gt;<br>      &lt;el-table-column label=&quot;渠道名称&quot; align=&quot;center&quot; prop=&quot;channelName&quot;/&gt;<br>      &lt;el-table-column label=&quot;活动简介&quot; :show-overflow-tooltip=&quot;true&quot; align=&quot;center&quot; prop=&quot;activityInfo&quot;/&gt;<br>      &lt;el-table-column label=&quot;活动类型&quot; align=&quot;center&quot;&gt;<br>        &lt;template #default=&quot;scope&quot;&gt;<br>          &lt;dict-tag :options=&quot;activity_type&quot; :value=&quot;scope.row.activityType&quot;/&gt;<br>        &lt;/template&gt;<br>      &lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;活动明细&quot; align=&quot;center&quot;&gt;<br>        &lt;template #default=&quot;scope&quot;&gt;<br>          &lt;div v-if=&quot;scope.row.activityType === 1&quot;&gt;<br>            折扣券/&#123;&#123; scope.row.discount &#125;&#125;折<br>          &lt;/div&gt;<br>          &lt;div v-else&gt;<br>            代金券/&#123;&#123; scope.row.voucher &#125;&#125;元<br>          &lt;/div&gt;<br>        &lt;/template&gt;<br>      &lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;活动状态&quot; align=&quot;center&quot;&gt;<br>        &lt;template #default=&quot;scope&quot;&gt;<br>          &lt;dict-tag :options=&quot;activity_status&quot; :value=&quot;scope.row.activityStatus&quot;/&gt;<br>        &lt;/template&gt;<br>      &lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;活动起始时间&quot; align=&quot;center&quot; prop=&quot;beginTime&quot; width=&quot;180&quot;&gt;<br>        &lt;template #default=&quot;scope&quot;&gt;<br>          &lt;span&gt;&#123;&#123; parseTime(scope.row.beginTime) &#125;&#125;&lt;/span&gt;<br>        &lt;/template&gt;<br>      &lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;活动结束时间&quot; align=&quot;center&quot; prop=&quot;endTime&quot; width=&quot;180&quot;&gt;<br>        &lt;template #default=&quot;scope&quot;&gt;<br>          &lt;span&gt;&#123;&#123; parseTime(scope.row.endTime) &#125;&#125;&lt;/span&gt;<br>        &lt;/template&gt;<br>      &lt;/el-table-column&gt;<br>      &lt;el-table-column label=&quot;操作&quot; align=&quot;center&quot; class-name=&quot;small-padding fixed-width&quot; width=&quot;150&quot;&gt;<br>        &lt;template #default=&quot;scope&quot;&gt;<br>          &lt;el-button<br>              type=&quot;text&quot;<br>              icon=&quot;Edit&quot;<br>              @click=&quot;handleUpdate(scope.row)&quot;<br>              v-hasPermi=&quot;[&#x27;tienchin:activity:edit&#x27;]&quot;<br>          &gt;修改<br>          &lt;/el-button&gt;<br>          &lt;el-button<br>              type=&quot;text&quot;<br>              icon=&quot;Delete&quot;<br>              @click=&quot;handleDelete(scope.row)&quot;<br>              v-hasPermi=&quot;[&#x27;tienchin:activity:remove&#x27;]&quot;<br>          &gt;删除<br>          &lt;/el-button&gt;<br>        &lt;/template&gt;<br>      &lt;/el-table-column&gt;<br>    &lt;/el-table&gt;<br><br>    &lt;pagination<br>        v-show=&quot;total &gt; 0&quot;<br>        :total=&quot;total&quot;<br>        v-model:page=&quot;queryParams.pageNum&quot;<br>        v-model:limit=&quot;queryParams.pageSize&quot;<br>        @pagination=&quot;getList&quot;<br>    /&gt;<br><br>    &lt;!-- 添加或修改活动对话框 --&gt;<br>    &lt;el-dialog :title=&quot;title&quot; v-model=&quot;open&quot; width=&quot;500px&quot; append-to-body&gt;<br>      &lt;el-form ref=&quot;activityRef&quot; :model=&quot;form&quot; :rules=&quot;rules&quot; label-width=&quot;80px&quot;&gt;<br>        &lt;el-row&gt;<br>          &lt;el-col :span=&quot;12&quot;&gt;<br>            &lt;el-form-item label=&quot;渠道来源&quot; prop=&quot;channelId&quot;&gt;<br>              &lt;el-select<br>                  v-model=&quot;form.channelId&quot;<br>                  placeholder=&quot;请选择渠道来源&quot;<br>                  clearable<br>                  style=&quot;width: 240px;&quot;<br>              &gt;<br>                &lt;el-option<br>                    v-for=&quot;channel in channelList&quot;<br>                    :key=&quot;channel.channelId&quot;<br>                    :label=&quot;channel.channelName&quot;<br>                    :value=&quot;channel.channelId&quot;<br>                /&gt;<br>              &lt;/el-select&gt;<br>            &lt;/el-form-item&gt;<br>          &lt;/el-col&gt;<br>          &lt;el-col :span=&quot;12&quot;&gt;<br>            &lt;el-form-item label=&quot;活动名称&quot; prop=&quot;activityName&quot;&gt;<br>              &lt;el-input v-model=&quot;form.activityName&quot; placeholder=&quot;请输入活动名称&quot;/&gt;<br>            &lt;/el-form-item&gt;<br>          &lt;/el-col&gt;<br>        &lt;/el-row&gt;<br>        &lt;el-row&gt;<br>          &lt;el-col :span=&quot;24&quot;&gt;<br>            &lt;el-form-item label=&quot;活动时间&quot; style=&quot;width: 100%;&quot; prop=&quot;activityTime&quot;&gt;<br>              &lt;el-date-picker<br>                  style=&quot;width: 100%;&quot;<br>                  v-model=&quot;form.activityTime&quot;<br>                  format=&quot;YYYY-MM-DD HH:mm:ss&quot;<br>                  type=&quot;datetimerange&quot;<br>                  range-separator=&quot;-&quot;<br>                  start-placeholder=&quot;开始日期&quot;<br>                  end-placeholder=&quot;结束日期&quot;<br>              /&gt;<br>            &lt;/el-form-item&gt;<br>          &lt;/el-col&gt;<br>        &lt;/el-row&gt;<br>        &lt;el-row&gt;<br>          &lt;el-col :span=&quot;12&quot;&gt;<br>            &lt;el-form-item label=&quot;活动简介&quot; prop=&quot;activityInfo&quot;&gt;<br>              &lt;el-input v-model=&quot;form.activityInfo&quot; placeholder=&quot;请输入活动简介&quot;/&gt;<br>            &lt;/el-form-item&gt;<br>          &lt;/el-col&gt;<br>          &lt;el-col :span=&quot;12&quot;&gt;<br>            &lt;el-form-item label=&quot;活动类型&quot; prop=&quot;activityType&quot;&gt;<br>              &lt;el-select<br>                  v-model=&quot;form.activityType&quot;<br>                  placeholder=&quot;请选择活动类型&quot;<br>                  clearable<br>                  style=&quot;width: 240px;&quot;<br>              &gt;<br>                &lt;el-option<br>                    v-for=&quot;dict in activity_type&quot;<br>                    :key=&quot;dict.value&quot;<br>                    :label=&quot;dict.label&quot;<br>                    :value=&quot;parseInt(dict.value)&quot;<br>                /&gt;<br>              &lt;/el-select&gt;<br>            &lt;/el-form-item&gt;<br>          &lt;/el-col&gt;<br>        &lt;/el-row&gt;<br>        &lt;el-row&gt;<br>          &lt;el-col :span=&quot;15&quot;&gt;<br>            &lt;el-form-item label=&quot;折扣券&quot; prop=&quot;discount&quot; v-if=&quot;parseInt(form.activityType) === 1&quot;&gt;<br>              &lt;el-input-number<br>                  v-model=&quot;form.discount&quot;<br>                  placeholder=&quot;请输入折扣值&quot;<br>                  :precision=&quot;2&quot;<br>                  :step=&quot;0.1&quot;<br>                  :max=&quot;10&quot;<br>                  :min=&quot;0&quot;<br>                  style=&quot;width: 100%;&quot;<br>              /&gt;<br>            &lt;/el-form-item&gt;<br>            &lt;el-form-item label=&quot;代金券&quot; prop=&quot;voucher&quot; v-if=&quot;parseInt(form.activityType) === 2&quot;&gt;<br>              &lt;el-input-number<br>                  v-model=&quot;form.voucher&quot;<br>                  placeholder=&quot;请输入代金券面值&quot;<br>                  :precision=&quot;2&quot;<br>                  :step=&quot;100&quot;<br>                  :min=&quot;0&quot;<br>                  style=&quot;width: 100%;&quot;<br>              /&gt;<br>            &lt;/el-form-item&gt;<br>          &lt;/el-col&gt;<br>        &lt;/el-row&gt;<br>        &lt;el-form-item label=&quot;备注&quot; prop=&quot;remark&quot;&gt;<br>          &lt;el-input v-model=&quot;form.remark&quot; type=&quot;textarea&quot; placeholder=&quot;请输入内容&quot;/&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/el-form&gt;<br>      &lt;template #footer&gt;<br>        &lt;div class=&quot;dialog-footer&quot;&gt;<br>          &lt;el-button type=&quot;primary&quot; @click=&quot;submitForm&quot;&gt;确 定&lt;/el-button&gt;<br>          &lt;el-button @click=&quot;cancel&quot;&gt;取 消&lt;/el-button&gt;<br>        &lt;/div&gt;<br>      &lt;/template&gt;<br>    &lt;/el-dialog&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script setup name=&quot;Activity&quot;&gt;<br>import &#123;<br>  addActivity,<br>  listActivity,<br>  listChannel,<br>  getInfo,<br>  updateActivity,<br>  delActivity<br>&#125; from &quot;@/api/tienchin/activity&quot;;<br><br>const &#123;proxy&#125; = getCurrentInstance();<br>const &#123;<br>  sys_normal_disable,<br>  activity_type,<br>  activity_status<br>&#125; = proxy.useDict(&quot;sys_normal_disable&quot;, &#x27;activity_type&#x27;, &#x27;activity_status&#x27;);<br><br>const activityList = ref([]);<br>const channelList = ref([]);<br>const open = ref(false);<br>const loading = ref(true);<br>const showSearch = ref(true);<br>const ids = ref([]);<br>const single = ref(true);<br>const multiple = ref(true);<br>const total = ref(0);<br>const title = ref(&quot;&quot;);<br><br>const data = reactive(&#123;<br>  form: &#123;&#125;,<br>  queryParams: &#123;<br>    pageNum: 1,<br>    pageSize: 10,<br>    activityName: undefined,<br>    channelId: undefined,<br>    activityStatus: undefined,<br>    activityType: undefined<br>  &#125;,<br>  rules: &#123;<br>    channelId: [&#123;required: true, message: &quot;渠道来源不能为空&quot;, trigger: &quot;blur&quot;&#125;],<br>    activityName: [&#123;required: true, message: &quot;活动名称不能为空&quot;, trigger: &quot;blur&quot;&#125;],<br>    activityTime: [&#123;required: true, message: &quot;活动时间不能为空&quot;, trigger: &quot;blur&quot;&#125;],<br>    activityInfo: [&#123;required: true, message: &quot;活动简介不能为空&quot;, trigger: &quot;blur&quot;&#125;],<br>    activityType: [&#123;required: true, message: &quot;活动类型不能为空&quot;, trigger: &quot;blur&quot;&#125;],<br>    discount: [&#123;required: true, message: &quot;折扣值不能为空&quot;, trigger: &quot;blur&quot;&#125;],<br>    voucher: [&#123;required: true, message: &quot;代金券面值不能为空&quot;, trigger: &quot;blur&quot;&#125;]<br>  &#125;<br>&#125;);<br><br>const &#123;queryParams, form, rules&#125; = toRefs(data);<br><br>/** 查询活动列表 */<br>function getList() &#123;<br>  loading.value = true;<br>  listActivity(queryParams.value).then(response =&gt; &#123;<br>    activityList.value = response.rows;<br>    total.value = response.total;<br>    loading.value = false;<br>  &#125;);<br>&#125;<br><br>/** 取消按钮 */<br>function cancel() &#123;<br>  open.value = false;<br>  reset();<br>&#125;<br><br>/** 表单重置 */<br>function reset() &#123;<br>  form.value = &#123;<br>    channelId: undefined,<br>    activityName: undefined,<br>    activityTime: undefined,<br>    activityInfo: undefined,<br>    activityType: undefined,<br>    discount: undefined,<br>    voucher: undefined,<br>    remark: undefined<br>  &#125;;<br>  proxy.resetForm(&quot;activityRef&quot;);<br>&#125;<br><br>/** 搜索按钮操作 */<br>function handleQuery() &#123;<br>  queryParams.value.pageNum = 1;<br>  getList();<br>&#125;<br><br>/** 重置按钮操作 */<br>function resetQuery() &#123;<br>  proxy.resetForm(&quot;queryRef&quot;);<br>  handleQuery();<br>&#125;<br><br>/** 多选框选中数据 */<br>function handleSelectionChange(selection) &#123;<br>  ids.value = selection.map(item =&gt; item.activityId);<br>  single.value = selection.length !== 1;<br>  multiple.value = !selection.length;<br>&#125;<br><br>/** 新增按钮操作 */<br>function handleAdd() &#123;<br>  reset();<br>  // handelChannelList();<br>  open.value = true;<br>  title.value = &quot;添加活动&quot;;<br>&#125;<br><br>/** 修改按钮操作 */<br>function handleUpdate(row) &#123;<br>  reset();<br>  // 加载渠道列表<br>  // handelChannelList();<br><br>  const activityId = row.activityId || ids.value;<br>  getInfo(activityId).then(response =&gt; &#123;<br>    form.value = response.data;<br>    form.value.activityTime = [form.value.beginTime, form.value.endTime];<br><br>    open.value = true;<br>    title.value = &quot;修改活动&quot;;<br>  &#125;);<br>&#125;<br><br>/** 提交按钮 */<br>function submitForm() &#123;<br>  proxy.$refs[&quot;activityRef&quot;].validate(valid =&gt; &#123;<br>    if (valid) &#123;<br>      if (form.value.activityId !== undefined) &#123;<br>        form.value.beginTime = formatDate(form.value.activityTime[0]);<br>        form.value.endTime = formatDate(form.value.activityTime[1]);<br><br>        // 删除掉，form 中的 updateTime 字段<br>        // 删除掉，form 中的 createTime 字段<br>        delete form.value.updateTime;<br>        delete form.value.createTime;<br><br>        updateActivity(form.value).then(response =&gt; &#123;<br>          proxy.$modal.msgSuccess(&quot;修改成功&quot;);<br>          open.value = false;<br>          getList();<br>        &#125;);<br>      &#125; else &#123;<br>        form.value.beginTime = formatDate(form.value.activityTime[0]);<br>        form.value.endTime = formatDate(form.value.activityTime[1]);<br>        addActivity(form.value).then(response =&gt; &#123;<br>          proxy.$modal.msgSuccess(&quot;新增成功&quot;);<br>          open.value = false;<br>          getList();<br>        &#125;);<br>      &#125;<br>    &#125;<br>  &#125;);<br>&#125;<br><br>/** 删除按钮操作 */<br>function handleDelete(row) &#123;<br>  const activityIds = row.activityId || ids.value;<br>  proxy.$modal.confirm(&#x27;是否确认删除活动编号为&quot;&#x27; + activityIds + &#x27;&quot;的数据项？&#x27;).then(function () &#123;<br>    return delActivity(activityIds);<br>  &#125;).then(() =&gt; &#123;<br>    getList();<br>    proxy.$modal.msgSuccess(&quot;删除成功&quot;);<br>  &#125;).catch(() =&gt; &#123;<br>  &#125;);<br>&#125;<br><br>/** 导出按钮操作 */<br>function handleExport() &#123;<br>  proxy.download(&quot;tienchin/activity/export&quot;, &#123;<br>    ...queryParams.value<br>  &#125;, `activity_$&#123;new Date().getTime()&#125;.xlsx`);<br>&#125;<br><br>/**<br> * 获取渠道列表<br> */<br>function handelChannelList() &#123;<br>  listChannel().then(response =&gt; &#123;<br>    channelList.value = response.data;<br>  &#125;);<br>&#125;<br><br>function formatDate(isoDateString) &#123;<br>  // 创建一个新的日期对象<br>  var date = new Date(isoDateString);<br><br>  // 提取年、月、日、小时、分钟和秒<br>  var year = date.getFullYear();<br>  var month = (date.getMonth() + 1).toString().padStart(2, &quot;0&quot;);<br>  var day = date.getDate().toString().padStart(2, &quot;0&quot;);<br>  var hours = date.getHours().toString().padStart(2, &quot;0&quot;);<br>  var minutes = date.getMinutes().toString().padStart(2, &quot;0&quot;);<br>  var seconds = date.getSeconds().toString().padStart(2, &quot;0&quot;);<br><br>  // 构建格式化后的日期时间字符串<br>  var formattedDate = year + &quot;-&quot; + month + &quot;-&quot; + day + &quot; &quot; + hours + &quot;:&quot; + minutes + &quot;:&quot; + seconds;<br><br>  // 返回格式化后的日期时间字符串<br>  return formattedDate;<br>&#125;<br><br>handelChannelList();<br>getList();<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>","prev":{"title":"TienChin 活动管理-完成添加活动","link":"2023/09/10/项目/TienChin 健身系统/2023-6-11/36-TienChin 活动管理-完成添加活动"},"next":{"title":"TienChin 活动管理-设置活动的默认状态","link":"2023/09/09/项目/TienChin 健身系统/2023-6-11/34-TienChin 活动管理-设置活动的默认状态"},"plink":"http://example.com/2023/09/10/项目/TienChin 健身系统/2023-6-11/35-TienChin 活动管理-添加活动页面/","toc":[{"id":"后端","title":"后端","index":"1","children":[{"id":"activitycontroller.java","title":"ActivityController.java","index":"1.1"}]},{"id":"前端","title":"前端","index":"2","children":[{"id":"activity.js","title":"activity.js","index":"2.1"},{"id":"index.vue","title":"index.vue","index":"2.2"}]}],"reading_time":"2369 words in 16 min"}